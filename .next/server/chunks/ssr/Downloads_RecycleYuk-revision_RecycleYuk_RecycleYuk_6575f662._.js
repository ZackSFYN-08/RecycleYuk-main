module.exports=[28392,11323,a=>{"use strict";var b=a.i(27075);let c=(0,b.default)("menu",[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]]);a.s(["Menu",()=>c],28392);let d=(0,b.default)("navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]]);a.s(["Navigation",()=>d],11323)},16967,88174,25243,a=>{"use strict";var b=a.i(27075);let c=(0,b.default)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);a.s(["Calendar",()=>c],16967);let d=(0,b.default)("phone",[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]]);a.s(["Phone",()=>d],88174);let e=(0,b.default)("message-circle",[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]]);a.s(["MessageCircle",()=>e],25243)},55167,52883,51626,40874,35039,99869,19510,28681,35270,86760,2953,71313,10867,83394,38176,84802,a=>{"use strict";let b,c,d,e,f;var g,h,i=a.i(13755),j=a.i(36985),k=a.i(88691),l=a.i(22423),m=a.i(62320),n=a.i(25243);let o=(0,k.createClient)("https://bvigrmajwdfpavxmxefl.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJ2aWdybWFqd2RmcGF2eG14ZWZsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njc2NTE2MzAsImV4cCI6MjA4MzIyNzYzMH0.Qii8jaaMgtH5Sq-C7YfpQ26AmGnMmh3aEbsTX8Ciyg0");function p({isOpen:a,onClose:b,transactionId:c,currentUserId:d,currentUserName:e,otherUserName:f,isDriver:g=!1}){let[h,k]=(0,j.useState)([]),[p,q]=(0,j.useState)(""),[r,s]=(0,j.useState)(!1),t=(0,j.useRef)(null),u=async()=>{if(!c)return;let{data:a}=await o.from("chat_messages").select("*").eq("transaction_id",c).order("created_at",{ascending:!0});k(a||[])};(0,j.useEffect)(()=>{if(!a||!c)return;u();let b=o.channel(`chat-${c}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"chat_messages",filter:`transaction_id=eq.${c}`},a=>{k(b=>[...b,a.new])}).subscribe();return()=>{o.removeChannel(b)}},[a,c]),(0,j.useEffect)(()=>{t.current?.scrollIntoView({behavior:"smooth"})},[h]);let v=async a=>{if(a.preventDefault(),p.trim()&&!r){s(!0);try{await o.from("chat_messages").insert({transaction_id:c,sender_id:d,sender_name:e,message:p.trim(),is_driver:g}),q("")}catch(a){console.error("Send message error:",a)}finally{s(!1)}}};return a?(0,i.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:(0,i.jsxs)("div",{className:"bg-white rounded-2xl w-full max-w-md h-[500px] flex flex-col shadow-2xl animate-in zoom-in-95",children:[(0,i.jsxs)("div",{className:"bg-gradient-to-r from-green-600 to-emerald-600 p-4 rounded-t-2xl flex items-center justify-between text-white",children:[(0,i.jsxs)("div",{className:"flex items-center gap-3",children:[(0,i.jsx)("div",{className:"w-10 h-10 bg-white/20 rounded-full flex items-center justify-center",children:(0,i.jsx)(n.MessageCircle,{size:20})}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("h3",{className:"font-bold",children:["Chat dengan ",f]}),(0,i.jsxs)("p",{className:"text-xs opacity-80",children:["Order #",c?.slice(0,8)]})]})]}),(0,i.jsx)("button",{onClick:b,className:"p-2 hover:bg-white/20 rounded-full transition",children:(0,i.jsx)(l.X,{size:20})})]}),(0,i.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-3 bg-gray-50",children:[0===h.length?(0,i.jsxs)("div",{className:"text-center text-gray-400 py-8",children:[(0,i.jsx)(n.MessageCircle,{size:40,className:"mx-auto mb-2 opacity-30"}),(0,i.jsx)("p",{children:"Belum ada pesan"}),(0,i.jsx)("p",{className:"text-xs",children:"Mulai percakapan sekarang"})]}):h.map((a,b)=>(0,i.jsx)("div",{className:`flex ${a.sender_id===d?"justify-end":"justify-start"}`,children:(0,i.jsxs)("div",{className:`max-w-[75%] rounded-2xl px-4 py-2 ${a.sender_id===d?"bg-green-600 text-white rounded-br-md":"bg-white text-gray-800 border border-gray-200 rounded-bl-md"}`,children:[(0,i.jsx)("p",{className:`text-xs font-bold mb-0.5 ${a.sender_id===d?"text-green-100":"text-gray-500"}`,children:a.sender_name}),(0,i.jsx)("p",{className:"text-sm",children:a.message}),(0,i.jsx)("p",{className:`text-[10px] mt-1 ${a.sender_id===d?"text-green-200":"text-gray-400"}`,children:new Date(a.created_at).toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit"})})]})},a.id||b)),(0,i.jsx)("div",{ref:t})]}),(0,i.jsx)("form",{onSubmit:v,className:"p-4 border-t border-gray-200 bg-white rounded-b-2xl",children:(0,i.jsxs)("div",{className:"flex gap-2",children:[(0,i.jsx)("input",{type:"text",value:p,onChange:a=>q(a.target.value),placeholder:"Ketik pesan...",className:"flex-1 px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 ring-green-500 outline-none text-gray-800",disabled:r}),(0,i.jsx)("button",{type:"submit",disabled:r||!p.trim(),className:"bg-green-600 text-white px-4 py-3 rounded-xl hover:bg-green-700 transition disabled:opacity-50 disabled:cursor-not-allowed",children:(0,i.jsx)(m.Send,{size:20})})]})})]})}):null}a.s(["default",()=>p],55167);let q="remove",r="propertychange",s="change",t="contextmenu",u="click",v="keydown",w="keypress",x="touchmove",y="wheel",z=class{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}};function A(a,b){return a>b?1:a<b?-1:0}function B(a,b){return a<b?1:a>b?-1:0}function C(a,b,c){if(a[0]<=b)return 0;let d=a.length;if(b<=a[d-1])return d-1;if("function"==typeof c){for(let e=1;e<d;++e){let d=a[e];if(d===b)return e;if(d<b){if(c(b,a[e-1],d)>0)return e-1;return e}}return d-1}if(c>0){for(let c=1;c<d;++c)if(a[c]<b)return c-1;return d-1}if(c<0){for(let c=1;c<d;++c)if(a[c]<=b)return c;return d-1}for(let c=1;c<d;++c){if(a[c]==b)return c;if(a[c]<b){if(a[c-1]-b<b-a[c])return c-1;return c}}return d-1}function D(a,b){let c=Array.isArray(b)?b:[b],d=c.length;for(let b=0;b<d;b++)a[a.length]=c[b]}function E(a,b){let c=a.length;if(c!==b.length)return!1;for(let d=0;d<c;d++)if(a[d]!==b[d])return!1;return!0}function F(){return!0}function G(){return!1}function H(){}function I(a){let b,c,d;return function(){let e=Array.prototype.slice.call(arguments);return c&&this===d&&E(e,c)||(d=this,c=e,b=a.apply(this,arguments)),b}}function J(a){for(let b in a)delete a[b]}function K(a){let b;for(b in a)return!1;return!b}let L=class{constructor(a){this.propagationStopped,this.defaultPrevented,this.type=a,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}},M=class extends z{constructor(a){super(),this.eventTarget_=a,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(a,b){if(!a||!b)return;let c=this.listeners_||(this.listeners_={}),d=c[a]||(c[a]=[]);d.includes(b)||d.push(b)}dispatchEvent(a){let b,c="string"==typeof a,d=c?a:a.type,e=this.listeners_&&this.listeners_[d];if(!e)return;let f=c?new L(a):a;f.target||(f.target=this.eventTarget_||this);let g=this.dispatching_||(this.dispatching_={}),h=this.pendingRemovals_||(this.pendingRemovals_={});d in g||(g[d]=0,h[d]=0),++g[d];for(let a=0,c=e.length;a<c;++a)if(!1===(b="handleEvent"in e[a]?e[a].handleEvent(f):e[a].call(this,f))||f.propagationStopped){b=!1;break}if(0==--g[d]){let a=h[d];for(delete h[d];a--;)this.removeEventListener(d,H);delete g[d]}return b}disposeInternal(){this.listeners_&&J(this.listeners_)}getListeners(a){return this.listeners_&&this.listeners_[a]||void 0}hasListener(a){return!!this.listeners_&&(a?a in this.listeners_:Object.keys(this.listeners_).length>0)}removeEventListener(a,b){if(!this.listeners_)return;let c=this.listeners_[a];if(!c)return;let d=c.indexOf(b);-1!==d&&(this.pendingRemovals_&&a in this.pendingRemovals_?(c[d]=H,++this.pendingRemovals_[a]):(c.splice(d,1),0===c.length&&delete this.listeners_[a]))}};function N(a,b,c,d,e){if(e){let e=c;c=function(f){return a.removeEventListener(b,c),e.call(d??this,f)}}else d&&d!==a&&(c=c.bind(d));let f={target:a,type:b,listener:c};return a.addEventListener(b,c),f}function O(a){a&&a.target&&(a.target.removeEventListener(a.type,a.listener),J(a))}class P extends M{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(s)}getRevision(){return this.revision_}onInternal(a,b){if(Array.isArray(a)){let c=a.length,d=Array(c);for(let e=0;e<c;++e)d[e]=N(this,a[e],b);return d}return N(this,a,b)}onceInternal(a,b){let c;if(Array.isArray(a)){let d=a.length;c=Array(d);for(let e=0;e<d;++e)c[e]=N(this,a[e],b,void 0,!0)}else c=N(this,a,b,void 0,!0);return b.ol_key=c,c}unInternal(a,b){let c=b.ol_key;if(c){var d=c;if(Array.isArray(d))for(let a=0,b=d.length;a<b;++a)O(d[a]);else O(d)}else if(Array.isArray(a))for(let c=0,d=a.length;c<d;++c)this.removeEventListener(a[c],b);else this.removeEventListener(a,b)}}P.prototype.on,P.prototype.once,P.prototype.un;let Q=P;function R(){throw Error("Unimplemented abstract method.")}let S=0;function T(a){return a.ol_uid||(a.ol_uid=String(++S))}class U extends L{constructor(a,b,c){super(a),this.key=b,this.oldValue=c}}let V=class extends Q{constructor(a){super(),this.on,this.once,this.un,T(this),this.values_=null,void 0!==a&&this.setProperties(a)}get(a){let b;return this.values_&&this.values_.hasOwnProperty(a)&&(b=this.values_[a]),b}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(a,b){let c;c=`change:${a}`,this.hasListener(c)&&this.dispatchEvent(new U(c,a,b)),c=r,this.hasListener(c)&&this.dispatchEvent(new U(c,a,b))}addChangeListener(a,b){this.addEventListener(`change:${a}`,b)}removeChangeListener(a,b){this.removeEventListener(`change:${a}`,b)}set(a,b,c){let d=this.values_||(this.values_={});if(c)d[a]=b;else{let c=d[a];d[a]=b,c!==b&&this.notify(a,c)}}setProperties(a,b){for(let c in a)this.set(c,a[c],b)}applyProperties(a){a.values_&&Object.assign(this.values_||(this.values_={}),a.values_)}unset(a,b){if(this.values_&&a in this.values_){let c=this.values_[a];delete this.values_[a],K(this.values_)&&(this.values_=null),b||this.notify(a,c)}}},W="length";class X extends L{constructor(a,b,c){super(a),this.element=b,this.index=c}}let Y=class extends V{constructor(a,b){if(super(),this.on,this.once,this.un,b=b||{},this.unique_=!!b.unique,this.array_=a??[],this.unique_)for(let a=1,b=this.array_.length;a<b;++a)this.assertUnique_(this.array_[a],a);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(a){for(let b=0,c=a.length;b<c;++b)this.push(a[b]);return this}forEach(a){let b=this.array_;for(let c=0,d=b.length;c<d;++c)a(b[c],c,b)}getArray(){return this.array_}item(a){return this.array_[a]}getLength(){return this.get(W)}insertAt(a,b){if(a<0||a>this.getLength())throw Error("Index out of bounds: "+a);this.unique_&&this.assertUnique_(b),this.array_.splice(a,0,b),this.updateLength_(),this.dispatchEvent(new X("add",b,a))}pop(){return this.removeAt(this.getLength()-1)}push(a){let b=this.getLength();return this.insertAt(b,a),this.getLength()}remove(a){let b=this.array_;for(let c=0,d=b.length;c<d;++c)if(b[c]===a)return this.removeAt(c)}removeAt(a){if(a<0||a>=this.getLength())return;let b=this.array_[a];return this.array_.splice(a,1),this.updateLength_(),this.dispatchEvent(new X(q,b,a)),b}setAt(a,b){if(a>=this.getLength())return void this.insertAt(a,b);if(a<0)throw Error("Index out of bounds: "+a);this.unique_&&this.assertUnique_(b,a);let c=this.array_[a];this.array_[a]=b,this.dispatchEvent(new X(q,c,a)),this.dispatchEvent(new X("add",b,a))}updateLength_(){this.set(W,this.array_.length)}assertUnique_(a,b){let c=this.array_;for(let d=0,e=c.length;d<e;++d)if(c[d]===a&&d!==b)throw Error("Duplicate item added to a unique collection")}},Z=class extends L{constructor(a,b,c){super(a),this.map=b,this.frameState=void 0!==c?c:null}},$=class extends Z{constructor(a,b,c,d,e,f){super(a,b,e),this.originalEvent=c,this.pixel_=null,this.coordinate_=null,this.dragging=void 0!==d&&d,this.activePointers=f}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(a){this.pixel_=a}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(a){this.coordinate_=a}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}},_={SINGLECLICK:"singleclick",CLICK:u,DBLCLICK:"dblclick",POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},aa="u">typeof navigator&&void 0!==navigator.userAgent?navigator.userAgent.toLowerCase():"";aa.includes("safari")&&!aa.includes("chrom")&&(aa.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(aa));let ab=aa.includes("webkit")&&!aa.includes("edge"),ac=aa.includes("macintosh"),ad="u">typeof devicePixelRatio?devicePixelRatio:1,ae="u">typeof WorkerGlobalScope&&"u">typeof OffscreenCanvas&&self instanceof WorkerGlobalScope,af="u">typeof Image&&Image.prototype.decode,ag=function(){let a=!1;try{let b=Object.defineProperty({},"passive",{get:function(){a=!0}});window.addEventListener("_",null,b),window.removeEventListener("_",null,b)}catch{}return a}(),ah="pointerdown",ai=class extends M{constructor(a,b){super(a),this.map_=a,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=void 0===b?1:b,this.down_=null;const c=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=c,this.pointerdownListenerKey_=N(c,ah,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=N(c,"pointermove",this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(x,this.boundHandleTouchMove_,!!ag&&{passive:!1})}emulateClick_(a){let b=new $(_.CLICK,this.map_,a);this.dispatchEvent(b),void 0!==this.clickTimeoutId_?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,b=new $(_.DBLCLICK,this.map_,a),this.dispatchEvent(b)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;let b=new $(_.SINGLECLICK,this.map_,a);this.dispatchEvent(b)},250)}updateActivePointers_(a){let b=a.pointerId;if(a.type==_.POINTERUP||a.type==_.POINTERCANCEL){for(let c in delete this.trackedTouches_[b],this.trackedTouches_)if(this.trackedTouches_[c].target!==a.target){delete this.trackedTouches_[c];break}}else(a.type==_.POINTERDOWN||a.type==_.POINTERMOVE)&&(this.trackedTouches_[b]=a);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(a){this.updateActivePointers_(a);let b=new $(_.POINTERUP,this.map_,a,void 0,void 0,this.activePointers_);this.dispatchEvent(b),this.emulateClicks_&&!b.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(a)&&this.emulateClick_(this.down_),0===this.activePointers_.length&&(this.dragListenerKeys_.forEach(O),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(a){return 0===a.button}handlePointerDown_(a){this.emulateClicks_=0===this.activePointers_.length,this.updateActivePointers_(a);let b=new $(_.POINTERDOWN,this.map_,a,void 0,void 0,this.activePointers_);if(this.dispatchEvent(b),this.down_=new PointerEvent(a.type,a),Object.defineProperty(this.down_,"target",{writable:!1,value:a.target}),0===this.dragListenerKeys_.length){let a=this.map_.getOwnerDocument();this.dragListenerKeys_.push(N(a,_.POINTERMOVE,this.handlePointerMove_,this),N(a,_.POINTERUP,this.handlePointerUp_,this),N(this.element_,_.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==a&&this.dragListenerKeys_.push(N(this.element_.getRootNode(),_.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(a){if(this.isMoving_(a)){this.updateActivePointers_(a),this.dragging_=!0;let b=new $(_.POINTERDRAG,this.map_,a,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(b)}}relayMoveEvent_(a){this.originalPointerMoveEvent_=a;let b=!!(this.down_&&this.isMoving_(a));this.dispatchEvent(new $(_.POINTERMOVE,this.map_,a,b))}handleTouchMove_(a){let b=this.originalPointerMoveEvent_;(!b||b.defaultPrevented)&&("boolean"!=typeof a.cancelable||!0===a.cancelable)&&a.preventDefault()}isMoving_(a){return this.dragging_||Math.abs(a.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(a.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(O(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(x,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(O(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(O),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}},aj="postrender",ak="loadstart",al="loadend",am="layergroup",an="size",ao="target",ap="view";function aq(a,b){if(!a)throw Error(b)}let ar=1/0,as=class{constructor(a,b){this.priorityFunction_=a,this.keyFunction_=b,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,J(this.queuedElements_)}dequeue(){let a=this.elements_,b=this.priorities_,c=a[0];1==a.length?(a.length=0,b.length=0):(a[0]=a.pop(),b[0]=b.pop(),this.siftUp_(0));let d=this.keyFunction_(c);return delete this.queuedElements_[d],c}enqueue(a){aq(!(this.keyFunction_(a)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");let b=this.priorityFunction_(a);return b!=ar&&(this.elements_.push(a),this.priorities_.push(b),this.queuedElements_[this.keyFunction_(a)]=!0,this.siftDown_(0,this.elements_.length-1),!0)}getCount(){return this.elements_.length}getLeftChildIndex_(a){return 2*a+1}getRightChildIndex_(a){return 2*a+2}getParentIndex_(a){return a-1>>1}heapify_(){let a;for(a=(this.elements_.length>>1)-1;a>=0;a--)this.siftUp_(a)}isEmpty(){return 0===this.elements_.length}isKeyQueued(a){return a in this.queuedElements_}isQueued(a){return this.isKeyQueued(this.keyFunction_(a))}siftUp_(a){let b=this.elements_,c=this.priorities_,d=b.length,e=b[a],f=c[a],g=a;for(;a<d>>1;){let e=this.getLeftChildIndex_(a),f=this.getRightChildIndex_(a),g=f<d&&c[f]<c[e]?f:e;b[a]=b[g],c[a]=c[g],a=g}b[a]=e,c[a]=f,this.siftDown_(g,a)}siftDown_(a,b){let c=this.elements_,d=this.priorities_,e=c[b],f=d[b];for(;b>a;){let a=this.getParentIndex_(b);if(d[a]>f)c[b]=c[a],d[b]=d[a],b=a;else break}c[b]=e,d[b]=f}reprioritize(){let a,b,c,d=this.priorityFunction_,e=this.elements_,f=this.priorities_,g=0,h=e.length;for(b=0;b<h;++b)(c=d(a=e[b]))==ar?delete this.queuedElements_[this.keyFunction_(a)]:(f[g]=c,e[g++]=a);e.length=g,f.length=g,this.heapify_()}},at=class extends as{constructor(a,b){super(b=>a.apply(null,b),a=>a[0].getKey()),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=b,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(a){let b=super.enqueue(a);return b&&a[0].addEventListener(s,this.boundHandleTileChange_),b}getTilesLoading(){return this.tilesLoading_}handleTileChange(a){let b=a.target,c=b.getState();if(2===c||3===c||4===c){3!==c&&b.removeEventListener(s,this.boundHandleTileChange_);let a=b.getKey();a in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[a],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(a,b){let c=0;for(;this.tilesLoading_<a&&c<b&&this.getCount()>0;){let a=this.dequeue()[0],b=a.getKey();0!==a.getState()||b in this.tilesLoadingKeys_||(this.tilesLoadingKeys_[b]=!0,++this.tilesLoading_,++c,a.load())}}},au={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};function av(a,b,c){return Math.min(Math.max(a,b),c)}function aw(a,b,c,d){let e=c-a,f=d-b;return e*e+f*f}function ax(a){return 180*a/Math.PI}function ay(a){return a*Math.PI/180}function az(a,b){let c=a%b;return c*b<0?c+b:c}function aA(a,b){let c=Math.pow(10,b);return Math.round(a*c)/c}function aB(a,b){return Math.floor(aA(a,b))}function aC(a,b){return Math.ceil(aA(a,b))}function aD(a,b,c){if(a>=b&&a<c)return a;let d=c-b;return((a-b)%d+d)%d+b}function aE(a,b,c){return function(d,e,f,g,h){if(!d)return;if(!e&&!b)return d;let i=b?0:f[0]*e,j=b?0:f[1]*e,k=h?h[0]:0,l=h?h[1]:0,m=a[0]+i/2+k,n=a[2]-i/2+k,o=a[1]+j/2+l,p=a[3]-j/2+l;m>n&&(n=m=(n+m)/2),o>p&&(p=o=(p+o)/2);let q=av(d[0],m,n),r=av(d[1],o,p);if(g&&c&&e){let a=30*e;q+=-a*Math.log(1+Math.max(0,m-d[0])/a)+a*Math.log(1+Math.max(0,d[0]-n)/a),r+=-a*Math.log(1+Math.max(0,o-d[1])/a)+a*Math.log(1+Math.max(0,d[1]-p)/a)}return[q,r]}}function aF(a){return a}function aG(a){let b=aO();for(let c=0,d=a.length;c<d;++c)aT(b,a[c]);return b}function aH(a,b,c){return c?(c[0]=a[0]-b,c[1]=a[1]-b,c[2]=a[2]+b,c[3]=a[3]+b,c):[a[0]-b,a[1]-b,a[2]+b,a[3]+b]}function aI(a,b){return b?(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b):a.slice()}function aJ(a,b,c){let d,e;return(d=b<a[0]?a[0]-b:a[2]<b?b-a[2]:0)*d+(e=c<a[1]?a[1]-c:a[3]<c?c-a[3]:0)*e}function aK(a,b){return aM(a,b[0],b[1])}function aL(a,b){return a[0]<=b[0]&&b[2]<=a[2]&&a[1]<=b[1]&&b[3]<=a[3]}function aM(a,b,c){return a[0]<=b&&b<=a[2]&&a[1]<=c&&c<=a[3]}function aN(a,b){let c=a[0],d=a[1],e=a[2],f=a[3],g=b[0],h=b[1],i=0;return g<c?i|=16:g>e&&(i|=4),h<d?i|=8:h>f&&(i|=2),0===i&&(i=1),i}function aO(){return[1/0,1/0,-1/0,-1/0]}function aP(a,b,c,d,e){return e?(e[0]=a,e[1]=b,e[2]=c,e[3]=d,e):[a,b,c,d]}function aQ(a){return aP(1/0,1/0,-1/0,-1/0,a)}function aR(a,b){let c=a[0],d=a[1];return aP(c,d,c,d,b)}function aS(a,b){return a[0]==b[0]&&a[2]==b[2]&&a[1]==b[1]&&a[3]==b[3]}function aT(a,b){b[0]<a[0]&&(a[0]=b[0]),b[0]>a[2]&&(a[2]=b[0]),b[1]<a[1]&&(a[1]=b[1]),b[1]>a[3]&&(a[3]=b[1])}function aU(a,b,c,d,e){for(;c<d;c+=e){var f,g,h;f=a,g=b[c],h=b[c+1],f[0]=Math.min(f[0],g),f[1]=Math.min(f[1],h),f[2]=Math.max(f[2],g),f[3]=Math.max(f[3],h)}return a}function aV(a,b){let c;return!!((c=b(aX(a)))||(c=b(aY(a)))||(c=b(a3(a)))||(c=b(a2(a))))&&c}function aW(a){let b=0;return a6(a)||(b=a4(a)*a0(a)),b}function aX(a){return[a[0],a[1]]}function aY(a){return[a[2],a[1]]}function aZ(a){return[(a[0]+a[2])/2,(a[1]+a[3])/2]}function a$(a,b,c,d,e){let[f,g,h,i,j,k,l,m]=a_(a,b,c,d);return aP(Math.min(f,h,j,l),Math.min(g,i,k,m),Math.max(f,h,j,l),Math.max(g,i,k,m),e)}function a_(a,b,c,d){let e=b*d[0]/2,f=b*d[1]/2,g=Math.cos(c),h=Math.sin(c),i=e*g,j=e*h,k=f*g,l=f*h,m=a[0],n=a[1];return[m-i+l,n-j-k,m-i-l,n-j+k,m+i-l,n+j+k,m+i+l,n+j-k,m-i+l,n-j-k]}function a0(a){return a[3]-a[1]}function a1(a,b,c){let d=c||aO();return a5(a,b)?(a[0]>b[0]?d[0]=a[0]:d[0]=b[0],a[1]>b[1]?d[1]=a[1]:d[1]=b[1],a[2]<b[2]?d[2]=a[2]:d[2]=b[2],a[3]<b[3]?d[3]=a[3]:d[3]=b[3]):aQ(d),d}function a2(a){return[a[0],a[3]]}function a3(a){return[a[2],a[3]]}function a4(a){return a[2]-a[0]}function a5(a,b){return a[0]<=b[2]&&a[2]>=b[0]&&a[1]<=b[3]&&a[3]>=b[1]}function a6(a){return a[2]<a[0]||a[3]<a[1]}function a7(a,b){let c=b.getExtent(),d=aZ(a);if(b.canWrapX()&&(d[0]<c[0]||d[0]>=c[2])){let b=a4(c),e=Math.floor((d[0]-c[0])/b)*b;a[0]-=e,a[2]-=e}return a}function a8(a,b,c){if(b.canWrapX()){let d=b.getExtent();if(!isFinite(a[0])||!isFinite(a[2]))return[[d[0],a[1],d[2],a[3]]];a7(a,b);let e=a4(d);if(a4(a)>e&&!c)return[[d[0],a[1],d[2],a[3]]];if(a[0]<d[0])return[[a[0]+e,a[1],d[2],a[3]],[d[0],a[1],a[2],a[3]]];if(a[2]>d[2])return[[a[0],a[1],d[2],a[3]],[d[0],a[1],a[2]-e,a[3]]]}return[a]}function a9(a,b){let c=!0;for(let d=a.length-1;d>=0;--d)if(a[d]!=b[d]){c=!1;break}return c}function ba(a,b){let c=Math.cos(b),d=Math.sin(b),e=a[0]*c-a[1]*d,f=a[1]*c+a[0]*d;return a[0]=e,a[1]=f,a}function bb(a,b){if(b.canWrapX()){var c,d,e;let f,g,h=a4(b.getExtent()),i=(c=a,d=b,e=h,f=d.getExtent(),g=0,d.canWrapX()&&(c[0]<f[0]||c[0]>f[2])&&(e=e||a4(f),g=Math.floor((c[0]-f[0])/e)),g);i&&(a[0]-=i*h)}return a}function bc(a){return Math.pow(a,3)}function bd(a){return 1-bc(1-a)}function be(a){return 3*a*a-2*a*a*a}function bf(a){return a}function bg(...a){console.warn(...a)}let bh={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937},bi=class{constructor(a){this.code_=a.code,this.units_=a.units,this.extent_=void 0!==a.extent?a.extent:null,this.worldExtent_=void 0!==a.worldExtent?a.worldExtent:null,this.axisOrientation_=void 0!==a.axisOrientation?a.axisOrientation:"enu",this.global_=void 0!==a.global&&a.global,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=a.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=a.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||bh[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(a){this.global_=a,this.canWrapX_=!!(a&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(a){this.defaultTileGrid_=a}setExtent(a){this.extent_=a,this.canWrapX_=!!(this.global_&&a)}setWorldExtent(a){this.worldExtent_=a}setGetPointResolution(a){this.getPointResolutionFunc_=a}getPointResolutionFunc(){return this.getPointResolutionFunc_}},bj=6378137*Math.PI,bk=[-bj,-bj,bj,bj],bl=[-180,-85,180,85],bm=6378137*Math.log(Math.tan(Math.PI/2));class bn extends bi{constructor(a){super({code:a,units:"m",extent:bk,global:!0,worldExtent:bl,getPointResolution:function(a,b){return a/Math.cosh(b[1]/6378137)}})}}let bo=[new bn("EPSG:3857"),new bn("EPSG:102100"),new bn("EPSG:102113"),new bn("EPSG:900913"),new bn("http://www.opengis.net/def/crs/EPSG/0/3857"),new bn("http://www.opengis.net/gml/srs/epsg.xml#3857")],bp=[-180,-90,180,90],bq=6378137*Math.PI/180;class br extends bi{constructor(a,b){super({code:a,units:"degrees",extent:bp,axisOrientation:b,global:!0,metersPerUnit:bq,worldExtent:bp})}}let bs=[new br("CRS:84"),new br("EPSG:4326","neu"),new br("urn:ogc:def:crs:OGC:1.3:CRS84"),new br("urn:ogc:def:crs:OGC:2:84"),new br("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new br("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new br("http://www.opengis.net/def/crs/EPSG/0/4326","neu")],bt={},bu={};function bv(a,b,c){let d=a.getCode(),e=b.getCode();d in bu||(bu[d]={}),bu[d][e]=c}function bw(a,b){return a in bu&&b in bu[a]?bu[a][b]:null}let bx=.00669438/.99330562,by=Math.sqrt(.99330562),bz=(1-by)/(1+by),bA=bz*bz,bB=bA*bz,bC=bB*bz,bD=bC*bz,bE=1-.001673595-1344441707532e-16/64-15000339463446782e-22/256,bF=.02008314/8+1344441707532e-16/32+13500305517102105e-21/1024,bG=672220853766e-15/256+13500305517102105e-21/1024,bH=10500237624412747e-21/3072,bI=1.5*bz-27/32*bB+269/512*bD,bJ=21/16*bA-55/32*bC,bK=151/96*bB-417/128*bD,bL=1097/512*bC;function bM(a,b,c){let d=(c.north?b:b-1e7)/.9996/(6378137*bE),e=d+bI*Math.sin(2*d)+bJ*Math.sin(4*d)+bK*Math.sin(6*d)+bL*Math.sin(8*d),f=Math.sin(e),g=f*f,h=Math.cos(e),i=f/h,j=i*i,k=j*j,l=bx*h**2,m=l*l,n=(a-5e5)/(6378137/Math.sqrt(1-.00669438*g)*.9996),o=n*n,p=o*n,q=p*n,r=q*n,s=e-i/(.99330562/(1-.00669438*g))*(o/2-q/24*(5+3*j+10*l-4*m-9*bx))+r*n/720*(61+90*j+298*l+45*k-252*bx-3*m),t=(n-p/6*(1+2*j+l)+r/120*(5-2*l+28*j-3*m+8*bx+24*k))/h;return[ax(t=aD(t+ay(bO(c.number)),-Math.PI,Math.PI)),ax(s)]}function bN(a,b,c){a=aD(a,-180,180),b<-80?b=-80:b>84&&(b=84);let d=ay(b),e=Math.sin(d),f=Math.cos(d),g=e/f,h=g*g,i=h*h,j=ay(a),k=ay(bO(c.number)),l=6378137/Math.sqrt(1-.00669438*e**2),m=bx*f**2,n=f*aD(j-k,-Math.PI,Math.PI),o=n*n,p=o*n,q=p*n,r=q*n,s=.9996*l*(n+p/6*(1-h+m)+r/120*(5-18*h+i+72*m-58*bx))+5e5,t=.9996*(6378137*(bE*d-bF*Math.sin(2*d)+bG*Math.sin(4*d)-bH*Math.sin(6*d))+l*g*(o/2+q/24*(5-h+9*m+4*m**2)+r*n/720*(61-58*h+i+600*m-330*bx)));return c.north||(t+=1e7),[s,t]}function bO(a){return(a-1)*6-180+3}let bP=[/^EPSG:(\d+)$/,/^urn:ogc:def:crs:EPSG::(\d+)$/,/^http:\/\/www\.opengis\.net\/def\/crs\/EPSG\/0\/(\d+)$/];function bQ(a){let b=0;for(let c of bP){let d=a.match(c);if(d){b=parseInt(d[1]);break}}if(!b)return null;let c=0,d=!1;return(b>32700&&b<32761?c=b-32700:b>32600&&b<32661&&(d=!0,c=b-32600),c)?{number:c,north:d}:null}function bR(a,b){return function(c,d,e,f){let g=c.length;e=e>1?e:2,f=f??e,d||(d=e>2?c.slice():Array(g));for(let e=0;e<g;e+=f){let f=a(c[e],c[e+1],b);d[e]=f[0],d[e+1]=f[1]}return d}}function bS(a,b,c){c=c||6371008.8;let d=ay(a[1]),e=ay(b[1]),f=(e-d)/2,g=ay(b[0]-a[0])/2,h=Math.sin(f)*Math.sin(f)+Math.sin(g)*Math.sin(g)*Math.cos(d)*Math.cos(e);return 2*c*Math.atan2(Math.sqrt(h),Math.sqrt(1-h))}let bT=[function(a){let b=bQ(a.getCode());return b?{forward:bR(bN,b),inverse:bR(bM,b)}:null}],bU=[function(a){return bQ(a)?new bi({code:a,units:"m"}):null}],bV=!0;function bW(a){bV=!(void 0===a||a)}function bX(a,b){if(void 0!==b)for(let c=0,d=a.length;c<d;++c)b[c]=a[c];else b=a.slice();return b}function bY(a){var b;b=a.getCode(),bt[b]=a,bv(a,a,bX)}function bZ(a){if("string"!=typeof a)return a;let b=bt[a]||bt[a.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null;if(b)return b;for(let b of bU){let c=b(a);if(c)return c}return null}function b$(a,b,c,d){let e,f=(a=bZ(a)).getPointResolutionFunc();if(f){if(e=f(b,c),d&&d!==a.getUnits()){let b=a.getMetersPerUnit();b&&(e=e*b/bh[d])}}else{let f=a.getUnits();if(("degrees"!=f||d)&&"degrees"!=d){let g=b4(a,bZ("EPSG:4326"));if(g||"degrees"===f){let a=[c[0]-b/2,c[1],c[0]+b/2,c[1],c[0],c[1]-b/2,c[0],c[1]+b/2];e=(bS((a=g(a,a,2)).slice(0,2),a.slice(2,4))+bS(a.slice(4,6),a.slice(6,8)))/2}else e=b*a.getMetersPerUnit();let h=d?bh[d]:a.getMetersPerUnit();void 0!==h&&(e/=h)}else e=b}return e}function b_(a){a.forEach(bY),a.forEach(function(b){a.forEach(function(a){b!==a&&bv(b,a,bX)})})}function b0(a,b){return a?"string"==typeof a?bZ(a):a:bZ(b)}function b1(a){return function(b,c,d,e){let f=b.length;d=void 0!==d?d:2,e=e??d,c=void 0!==c?c:Array(f);for(let g=0;g<f;g+=e){let f=a(b.slice(g,g+d)),h=f.length;for(let a=0,d=e;a<d;++a)c[g+a]=a>=h?b[g+a]:f[a]}return c}}function b2(a,b){return bW(),b7(a,"EPSG:4326",void 0!==b?b:"EPSG:3857")}function b3(a,b){if(a===b)return!0;let c=a.getUnits()===b.getUnits();return a.getCode()===b.getCode()?c:b4(a,b)===bX&&c}function b4(a,b){let c=a.getCode(),d=b.getCode(),e=bw(c,d);if(e)return e;let f=null,g=null;for(let c of bT)f||(f=c(a)),g||(g=c(b));if(!f&&!g)return null;let h="EPSG:4326";if(g)if(f)e=b5(f.inverse,g.forward);else{let a=bw(c,h);a&&(e=b5(a,g.forward))}else{let a=bw(h,d);a&&(e=b5(f.inverse,a))}return e&&(bY(a),bY(b),bv(a,b,e)),e}function b5(a,b){return function(c,d,e,f){return b(d=a(c,d,e,f),d,e,f)}}function b6(a,b){return b4(bZ(a),bZ(b))}function b7(a,b,c){let d=b6(b,c);if(!d){let a=bZ(b).getCode(),d=bZ(c).getCode();throw Error(`No transform available between ${a} and ${d}`)}return d(a,void 0,a.length)}function b8(){return null}function b9(a,b){return a}function ca(a,b){return bV&&!a9(a,[0,0])&&a[0]>=-180&&a[0]<=180&&a[1]>=-90&&a[1]<=90&&(bV=!1,bg("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),a}function cb(a,b){return a}function cc(a,b){return a}function cd(a,b){return a}function ce(){return[1,0,0,1,0,0]}function cf(a,b){let c=b[0],d=b[1];return b[0]=a[0]*c+a[2]*d+a[4],b[1]=a[1]*c+a[3]*d+a[5],b}function cg(a,b,c,d,e,f,g,h){let i=Math.sin(f),j=Math.cos(f);return a[0]=d*j,a[1]=e*i,a[2]=-d*i,a[3]=e*j,a[4]=g*d*j-h*d*i+b,a[5]=g*e*i+h*e*j+c,a}function ch(a,b){var c;let d=(c=b)[0]*c[3]-c[1]*c[2];aq(0!==d,"Transformation matrix cannot be inverted");let e=b[0],f=b[1],g=b[2],h=b[3],i=b[4],j=b[5];return a[0]=h/d,a[1]=-f/d,a[2]=-g/d,a[3]=e/d,a[4]=(g*j-h*i)/d,a[5]=-(e*j-f*i)/d,a}b_(bo),b_(bs),g=function(a,b,c,d){let e=a.length;c=c>1?c:2,d=d??c,void 0===b&&(b=c>2?a.slice():Array(e));for(let c=0;c<e;c+=d){b[c]=bj*a[c]/180;let d=6378137*Math.log(Math.tan(Math.PI*(+a[c+1]+90)/360));d>bm?d=bm:d<-bm&&(d=-bm),b[c+1]=d}return b},h=function(a,b,c,d){let e=a.length;c=c>1?c:2,d=d??c,void 0===b&&(b=c>2?a.slice():Array(e));for(let c=0;c<e;c+=d)b[c]=180*a[c]/bj,b[c+1]=360*Math.atan(Math.exp(a[c+1]/6378137))/Math.PI-90;return b},bs.forEach(function(a){bo.forEach(function(b){bv(a,b,g),bv(b,a,h)})}),a.s(["createProjection",()=>b0,"createTransformFromCoordinateTransform",()=>b1,"disableCoordinateWarning",()=>bW,"equivalent",()=>b3,"fromLonLat",()=>b2,"fromUserCoordinate",()=>ca,"fromUserExtent",()=>cc,"get",()=>bZ,"getPointResolution",()=>b$,"getTransform",()=>b6,"getTransformFromProjections",()=>b4,"getUserProjection",()=>b8,"toUserCoordinate",()=>b9,"toUserExtent",()=>cb,"toUserResolution",()=>cd,"transform",()=>b7],52883);let ci=[1e5,1e5,1e5,1e5,2,2];function cj(a){return a.substring(7,a.length-1).split(",").map(parseFloat)}function ck(a,b,c,d,e,f,g){f=f||[],g=g||2;let h=0;for(let i=b;i<c;i+=d){let b=a[i],c=a[i+1];f[h++]=e[0]*b+e[2]*c+e[4],f[h++]=e[1]*b+e[3]*c+e[5];for(let b=2;b<g;b++)f[h++]=a[i+b]}return f&&f.length!=h&&(f.length=h),f}function cl(a,b,c,d,e,f,g){g=g||[];let h=Math.cos(e),i=Math.sin(e),j=f[0],k=f[1],l=0;for(let e=b;e<c;e+=d){let b=a[e]-j,c=a[e+1]-k;g[l++]=j+b*h-c*i,g[l++]=k+b*i+c*h;for(let b=e+2;b<e+d;++b)g[l++]=a[b]}return g&&g.length!=l&&(g.length=l),g}let cm=ce(),cn=[NaN,NaN],co=class extends V{constructor(){super(),this.extent_=aO(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=I((a,b,c)=>{if(!c)return this.getSimplifiedGeometry(b);let d=this.clone();return d.applyTransform(c),d.getSimplifiedGeometry(b)})}simplifyTransformed(a,b){return this.simplifyTransformedInternal(this.getRevision(),a,b)}clone(){return R()}closestPointXY(a,b,c,d){return R()}containsXY(a,b){return 0===this.closestPointXY(a,b,cn,5e-324)}getClosestPoint(a,b){return b=b||[NaN,NaN],this.closestPointXY(a[0],a[1],b,1/0),b}intersectsCoordinate(a){return this.containsXY(a[0],a[1])}computeExtent(a){return R()}getExtent(a){var b;if(this.extentRevision_!=this.getRevision()){let a=this.computeExtent(this.extent_);(isNaN(a[0])||isNaN(a[1]))&&aQ(a),this.extentRevision_=this.getRevision()}return b=this.extent_,a?(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a):b}rotate(a,b){R()}scale(a,b,c){R()}simplify(a){return this.getSimplifiedGeometry(a*a)}getSimplifiedGeometry(a){return R()}getType(){return R()}applyTransform(a){R()}intersectsExtent(a){return R()}translate(a,b){R()}transform(a,b){let c=bZ(a),d="tile-pixels"==c.getUnits()?function(a,d,e){let f=c.getExtent(),g=c.getWorldExtent(),h=a0(g)/a0(f);cg(cm,g[0],g[3],h,-h,0,0,0);let i=ck(a,0,a.length,e,cm,d),j=b6(c,b);return j?j(i,i,e):i}:b6(c,b);return this.applyTransform(d),this}};function cp(a){let b;return"XY"==a?b=2:"XYZ"==a||"XYM"==a?b=3:"XYZM"==a&&(b=4),b}let cq=class extends co{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(a){var b,c,d;return b=this.flatCoordinates,c=this.flatCoordinates.length,d=this.stride,aU(aQ(a),b,0,c,d)}getCoordinates(){return R()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(a){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),a<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&a<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;let b=this.getSimplifiedGeometryInternal(a);return b.getFlatCoordinates().length<this.flatCoordinates.length?b:(this.simplifiedGeometryMaxMinSquaredTolerance=a,this)}getSimplifiedGeometryInternal(a){return this}getStride(){return this.stride}setFlatCoordinates(a,b){this.stride=cp(a),this.layout=a,this.flatCoordinates=b}setCoordinates(a,b){R()}setLayout(a,b,c){let d;if(a)d=cp(a);else{var e;let f;for(let a=0;a<c;++a){if(0===b.length){this.layout="XY",this.stride=2;return}b=b[0]}2==(e=d=b.length)?f="XY":3==e?f="XYZ":4==e&&(f="XYZM"),a=f}this.layout=a,this.stride=d}applyTransform(a){this.flatCoordinates&&(a(this.flatCoordinates,this.flatCoordinates,this.layout.startsWith("XYZ")?3:2,this.stride),this.changed())}rotate(a,b){let c=this.getFlatCoordinates();if(c){let d=this.getStride();cl(c,0,c.length,d,a,b,c),this.changed()}}scale(a,b,c){void 0===b&&(b=a),c||(c=aZ(this.getExtent()));let d=this.getFlatCoordinates();if(d){let e=this.getStride();!function(a,b,c,d,e,f,g,h){h=h||[];let i=g[0],j=g[1],k=0;for(let b=0;b<c;b+=d){let c=a[b]-i,g=a[b+1]-j;h[k++]=i+e*c,h[k++]=j+f*g;for(let c=b+2;c<b+d;++c)h[k++]=a[c]}h&&h.length!=k&&(h.length=k)}(d,0,d.length,e,a,b,c,d),this.changed()}}translate(a,b){let c=this.getFlatCoordinates();if(c){let d=this.getStride();!function(a,b,c,d,e,f,g){g=g||[];let h=0;for(let b=0;b<c;b+=d){g[h++]=a[b]+e,g[h++]=a[b+1]+f;for(let c=b+2;c<b+d;++c)g[h++]=a[c]}g&&g.length!=h&&(g.length=h)}(c,0,c.length,d,a,b,c),this.changed()}}};function cr(a,b,c,d){let e=0,f=a[c-d],g=a[c-d+1],h=0,i=0;for(;b<c;b+=d){let c=a[b]-f,d=a[b+1]-g;e+=i*c-h*d,h=c,i=d}return e/2}function cs(a,b,c,d,e,f,g){let h,i=a[b],j=a[b+1],k=a[c]-i,l=a[c+1]-j;if(0===k&&0===l)h=b;else{let n=((e-i)*k+(f-j)*l)/(k*k+l*l);if(n>1)h=c;else if(n>0){for(let e=0;e<d;++e){var m;g[e]=(m=a[b+e],m+n*(a[c+e]-m))}g.length=d;return}else h=b}for(let b=0;b<d;++b)g[b]=a[h+b];g.length=d}function ct(a,b,c,d,e){let f=a[b],g=a[b+1];for(b+=d;b<c;b+=d){let c=a[b],d=a[b+1],h=aw(f,g,c,d);h>e&&(e=h),f=c,g=d}return e}function cu(a,b,c,d,e,f,g,h,i,j,k){let l,m;if(b==c)return j;if(0===e){if((m=aw(g,h,a[b],a[b+1]))<j){for(l=0;l<d;++l)i[l]=a[b+l];return i.length=d,m}return j}k=k||[NaN,NaN];let n=b+d;for(;n<c;)if(cs(a,n-d,n,d,g,h,k),(m=aw(g,h,k[0],k[1]))<j){for(l=0,j=m;l<d;++l)i[l]=k[l];i.length=d,n+=d}else n+=d*Math.max((Math.sqrt(m)-Math.sqrt(j))/e|0,1);if(f&&(cs(a,c-d,b,d,g,h,k),(m=aw(g,h,k[0],k[1]))<j)){for(l=0,j=m;l<d;++l)i[l]=k[l];i.length=d}return j}function cv(a,b,c,d){for(let e=0,f=c.length;e<f;++e){let f=c[e];for(let c=0;c<d;++c)a[b++]=f[c]}return b}function cw(a,b,c,d,e){e=void 0!==e?e:[];let f=0;for(let g=b;g<c;g+=d)e[f++]=a.slice(g,g+d);return e.length=f,e}function cx(a,b,c,d,e){e=void 0!==e?e:[];let f=0;for(let g=0,h=c.length;g<h;++g){let h=c[g];e[f++]=cw(a,b,h,d,e[f]),b=h}return e.length=f,e}function cy(a,b,c,d,e){e=void 0!==e?e:[];let f=0;for(let g=0,h=c.length;g<h;++g){let h=c[g];e[f++]=1===h.length&&h[0]===b?[]:cx(a,b,h,d,e[f]),b=h[h.length-1]}return e.length=f,e}function cz(a,b,c,d,e,f,g){let h=(c-b)/d;if(h<3){for(;b<c;b+=d)f[g++]=a[b],f[g++]=a[b+1];return g}let i=Array(h);i[0]=1,i[h-1]=1;let j=[b,c-d],k=0;for(;j.length>0;){let c=j.pop(),f=j.pop(),g=0,h=a[f],l=a[f+1],m=a[c],n=a[c+1];for(let b=f+d;b<c;b+=d){let c=function(a,b,c,d,e,f){let g=e-c,h=f-d;if(0!==g||0!==h){let i=((a-c)*g+(b-d)*h)/(g*g+h*h);i>1?(c=e,d=f):i>0&&(c+=g*i,d+=h*i)}return aw(a,b,c,d)}(a[b],a[b+1],h,l,m,n);c>g&&(k=b,g=c)}g>e&&(i[(k-b)/d]=1,f+d<k&&j.push(f,k),k+d<c&&j.push(k,c))}for(let c=0;c<h;++c)i[c]&&(f[g++]=a[b+c*d],f[g++]=a[b+c*d+1]);return g}function cA(a,b){return b*Math.round(a/b)}function cB(a,b,c,d,e,f,g,h){for(let i=0,j=c.length;i<j;++i){let j=c[i];g=function(a,b,c,d,e,f,g){let h,i;if(b==c)return g;let j=cA(a[b],e),k=cA(a[b+1],e);b+=d,f[g++]=j,f[g++]=k;do if(h=cA(a[b],e),i=cA(a[b+1],e),(b+=d)==c)return f[g++]=h,f[g++]=i,g;while(h==j&&i==k)for(;b<c;){let c=cA(a[b],e),l=cA(a[b+1],e);if(b+=d,c==h&&l==i)continue;let m=h-j,n=i-k,o=c-j,p=l-k;if(m*p==n*o&&(m<0&&o<m||m==o||m>0&&o>m)&&(n<0&&p<n||n==p||n>0&&p>n)){h=c,i=l;continue}f[g++]=h,f[g++]=i,j=h,k=i,h=c,i=l}return f[g++]=h,f[g++]=i,g}(a,b,j,d,e,f,g),h.push(g),b=j}return g}class cC extends cq{constructor(a,b){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,void 0===b||Array.isArray(a[0])?this.setCoordinates(a,b):this.setFlatCoordinates(b,a)}clone(){return new cC(this.flatCoordinates.slice(),this.layout)}closestPointXY(a,b,c,d){return d<aJ(this.getExtent(),a,b)?d:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(ct(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),cu(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,a,b,c,d))}getArea(){return cr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return cw(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(a){let b=[];return b.length=cz(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,a,b,0),new cC(b,"XY")}getType(){return"LinearRing"}intersectsExtent(a){return!1}setCoordinates(a,b){this.setLayout(b,a,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=cv(this.flatCoordinates,0,a,this.stride),this.changed()}}class cD extends cq{constructor(a,b){super(),this.setCoordinates(a,b)}clone(){let a=new cD(this.flatCoordinates.slice(),this.layout);return a.applyProperties(this),a}closestPointXY(a,b,c,d){let e=this.flatCoordinates,f=aw(a,b,e[0],e[1]);if(f<d){let a=this.stride;for(let b=0;b<a;++b)c[b]=e[b];return c.length=a,f}return d}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(a){return aR(this.flatCoordinates,a)}getType(){return"Point"}intersectsExtent(a){return aM(a,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(a,b){this.setLayout(b,a,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=function(a,b,c,d){for(let d=0,e=c.length;d<e;++d)a[b++]=c[d];return b}(this.flatCoordinates,0,a,this.stride),this.changed()}}function cE(a,b,c,d,e,f){let g=0,h=a[c-d],i=a[c-d+1];for(;b<c;b+=d){let c=a[b],d=a[b+1];i<=f?d>f&&(c-h)*(f-i)-(e-h)*(d-i)>0&&g++:d<=f&&(c-h)*(f-i)-(e-h)*(d-i)<0&&g--,h=c,i=d}return 0!==g}function cF(a,b,c,d,e,f){if(0===c.length||!cE(a,b,c[0],d,e,f))return!1;for(let b=1,g=c.length;b<g;++b)if(cE(a,c[b-1],c[b],d,e,f))return!1;return!0}function cG(a,b,c,d,e,f,g){let h,i,j,k,l,m,n,o=e[f+1],p=[];for(let e=0,f=c.length;e<f;++e){let f=c[e];for(k=a[f-d],m=a[f-d+1],h=b;h<f;h+=d)l=a[h],n=a[h+1],(o<=m&&n<=o||m<=o&&o<=n)&&(j=(o-m)/(n-m)*(l-k)+k,p.push(j)),k=l,m=n}let q=NaN,r=-1/0;for(p.sort(A),k=p[0],h=1,i=p.length;h<i;++h){let e=Math.abs((l=p[h])-k);e>r&&cF(a,b,c,d,j=(k+l)/2,o)&&(q=j,r=e),k=l}return(isNaN(q)&&(q=e[f]),g)?(g.push(q,o,r),g):[q,o,r]}function cH(a,b,c,d,e){let f;for(b+=d;b<c;b+=d)if(f=e(a.slice(b-d,b),a.slice(b,b+d)))return f;return!1}function cI(a,b,c,d,e,f){return!!a5(e,f=f??aU(aO(),a,b,c,d))&&(f[0]>=e[0]&&f[2]<=e[2]||f[1]>=e[1]&&f[3]<=e[3]||cH(a,b,c,d,function(a,b){return function(a,b,c){let d=!1,e=aN(a,b),f=aN(a,c);if(1===e||1===f)d=!0;else{let g,h,i=a[0],j=a[1],k=a[2],l=a[3],m=b[0],n=b[1],o=c[0],p=c[1],q=(p-n)/(o-m);2&f&&!(2&e)&&(d=(g=o-(p-l)/q)>=i&&g<=k),d||!(4&f)||4&e||(d=(h=p-(o-k)*q)>=j&&h<=l),d||!(8&f)||8&e||(d=(g=o-(p-j)/q)>=i&&g<=k),d||!(16&f)||16&e||(d=(h=p-(o-i)*q)>=j&&h<=l)}return d}(e,a,b)}))}function cJ(a,b,c,d,e){return!!(cI(a,b,c,d,e)||cE(a,b,c,d,e[0],e[1])||cE(a,b,c,d,e[0],e[3])||cE(a,b,c,d,e[2],e[1])||cE(a,b,c,d,e[2],e[3]))}function cK(a,b,c,d){let e=0,f=a[c-d],g=a[c-d+1];for(;b<c;b+=d){let c=a[b],d=a[b+1];e+=(c-f)*(d+g),f=c,g=d}return 0===e?void 0:e>0}function cL(a,b,c,d,e){e=void 0!==e&&e;for(let f=0,g=c.length;f<g;++f){let g=c[f],h=cK(a,b,g,d);(0===f?e&&h||!e&&!h:e&&!h||!e&&h)&&function(a,b,c,d){for(;b<c-d;){for(let e=0;e<d;++e){let f=a[b+e];a[b+e]=a[c-d+e],a[c-d+e]=f}b+=d,c-=d}}(a,b,g,d),b=g}return b}a.s(["default",0,cD],51626);class cM extends cq{constructor(a,b,c){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,void 0!==b&&c?(this.setFlatCoordinates(b,a),this.ends_=c):this.setCoordinates(a,b)}appendLinearRing(a){this.flatCoordinates?D(this.flatCoordinates,a.getFlatCoordinates()):this.flatCoordinates=a.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){let a=new cM(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return a.applyProperties(this),a}closestPointXY(a,b,c,d){return d<aJ(this.getExtent(),a,b)?d:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(function(a,b,c,d,e){for(let f=0,g=c.length;f<g;++f){let g=c[f];e=ct(a,b,g,d,e),b=g}return e}(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),function(a,b,c,d,e,f,g,h,i,j,k){k=k||[NaN,NaN];for(let l=0,m=c.length;l<m;++l){let m=c[l];j=cu(a,b,m,d,e,f,g,h,i,j,k),b=m}return j}(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,a,b,c,d))}containsXY(a,b){return cF(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,a,b)}getArea(){return function(a,b,c,d){let e=0;for(let f=0,g=c.length;f<g;++f){let g=c[f];e+=cr(a,b,g,d),b=g}return e}(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(a){let b;return void 0!==a?cL(b=this.getOrientedFlatCoordinates().slice(),0,this.ends_,this.stride,a):b=this.flatCoordinates,cx(b,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){let a=aZ(this.getExtent());this.flatInteriorPoint_=cG(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,a,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new cD(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(a){return a<0||this.ends_.length<=a?null:new cC(this.flatCoordinates.slice(0===a?0:this.ends_[a-1],this.ends_[a]),this.layout)}getLinearRings(){let a=this.layout,b=this.flatCoordinates,c=this.ends_,d=[],e=0;for(let f=0,g=c.length;f<g;++f){let g=c[f],h=new cC(b.slice(e,g),a);d.push(h),e=g}return d}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){let a=this.flatCoordinates;!function(a,b,c,d,e){e=void 0!==e&&e;for(let f=0,g=c.length;f<g;++f){let g=c[f],h=cK(a,b,g,d);if(0===f){if(e&&h||!e&&!h)return!1}else if(e&&!h||!e&&h)return!1;b=g}return!0}(a,0,this.ends_,this.stride)?(this.orientedFlatCoordinates_=a.slice(),this.orientedFlatCoordinates_.length=cL(this.orientedFlatCoordinates_,0,this.ends_,this.stride)):this.orientedFlatCoordinates_=a,this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(a){let b=[],c=[];return b.length=cB(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(a),b,0,c),new cM(b,"XY",c)}getType(){return"Polygon"}intersectsExtent(a){return function(a,b,c,d,e){if(!cJ(a,0,c[0],d,e))return!1;if(1===c.length)return!0;for(let b=1,f=c.length;b<f;++b)if(function(a,b,c,d,e){return!aV(e,function(e){return!cE(a,b,c,d,e[0],e[1])})}(a,c[b-1],c[b],d,e)&&!cI(a,c[b-1],c[b],d,e))return!1;return!0}(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,a)}setCoordinates(a,b){this.setLayout(b,a,2),this.flatCoordinates||(this.flatCoordinates=[]);let c=function(a,b,c,d,e){e=e||[];let f=0;for(let g=0,h=c.length;g<h;++g){let h=cv(a,b,c[g],d);e[f++]=h,b=h}return e.length=f,e}(this.flatCoordinates,0,a,this.stride,this.ends_);this.flatCoordinates.length=0===c.length?0:c[c.length-1],this.changed()}}function cN(a){if(a6(a))throw Error("Cannot create polygon from empty extent");let b=a[0],c=a[1],d=a[2],e=a[3],f=[b,c,b,e,d,e,d,c,b,c];return new cM(f,"XY",[f.length])}function cO(a,b,c,d){let e=a4(b)/c[0],f=a0(b)/c[1];return d?Math.min(a,Math.max(e,f)):Math.min(a,Math.min(e,f))}function cP(a,b,c){let d=Math.min(a,b);return d*=Math.log(1+50*Math.max(0,a/b-1))/50+1,c&&(d=Math.max(d,c)/(Math.log(1+50*Math.max(0,c/a-1))/50+1)),av(d,c/2,2*b)}function cQ(a,b,c,d,e){return c=void 0===c||c,function(f,g,h,i){if(void 0!==f){let g=d?cO(a,d,h,e):a;return c&&i?cP(f,g,b):av(f,b,g)}}}function cR(a){if(void 0!==a)return 0}function cS(a){if(void 0!==a)return a}function cT(a,b){setTimeout(function(){a(b)},0)}function cU(a,b,c,d,e){let f=Math.cos(-e),g=Math.sin(-e),h=a[0]*f-a[1]*g,i=a[1]*f+a[0]*g;return h+=(b[0]/2-c[0])*d,[h*f-(i+=(c[1]-b[1]/2)*d)*(g=-g),i*f+h*g]}let cV=class extends V{constructor(a){var b,c;super(),this.on,this.once,this.un,a=Object.assign({},a),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=b0(a.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,a.projection&&bW(),a.center&&(a.center=ca(a.center,this.projection_)),a.extent&&(a.extent=(b=a.extent,c=this.projection_,b)),this.applyOptions_(a)}applyOptions_(a){let b=Object.assign({},a);for(let a in au)delete b[a];this.setProperties(b,!0);let c=function(a){var b,c,d,e,f,g;let h,i,j,k=void 0!==a.minZoom?a.minZoom:0,l=void 0!==a.maxZoom?a.maxZoom:28,m=void 0!==a.zoomFactor?a.zoomFactor:2,n=void 0!==a.multiWorld&&a.multiWorld,o=void 0===a.smoothResolutionConstraint||a.smoothResolutionConstraint,p=void 0!==a.showFullExtent&&a.showFullExtent,q=b0(a.projection,"EPSG:3857"),r=q.getExtent(),s=a.constrainOnlyCenter,t=a.extent;if(!n&&!t&&q.isGlobal()&&(s=!1,t=r),void 0!==a.resolutions){let d=a.resolutions;(i=d[k],j=void 0!==d[l]?d[l]:d[d.length-1],a.constrainResolution)?(b=o,c=!s&&t,b=void 0===b||b,h=function(a,e,f,g){if(void 0!==a){let h=d[0],i=d[d.length-1],j=c?cO(h,c,f,p):h;if(g)return b?cP(a,j,i):av(a,i,j);let k=Math.floor(C(d,Math.min(j,a),e));return d[k]>j&&k<d.length-1?d[k+1]:d[k]}}):h=cQ(i,j,o,!s&&t,p)}else{let b=(r?Math.max(a4(r),a0(r)):360*bh.degrees/q.getMetersPerUnit())/256/1;(void 0!==(i=a.maxResolution)?k=0:i=b/Math.pow(m,k),void 0===(j=a.minResolution)&&(j=void 0!==a.maxZoom?void 0!==a.maxResolution?i/Math.pow(m,l):b/Math.pow(m,l):b/0x10000000),l=k+Math.floor(Math.log(i/j)/Math.log(m)),j=i/Math.pow(m,l-k),a.constrainResolution)?(d=i,e=j,f=o,g=!s&&t,f=void 0===f||f,e=void 0!==e?e:0,h=function(a,b,c,h){if(void 0!==a){let i=g?cO(d,g,c,p):d;if(h)return f?cP(a,i,e):av(a,e,i);let j=Math.max(Math.ceil(Math.log(d/i)/Math.log(m)-1e-9),Math.floor(Math.log(d/Math.min(i,a))/Math.log(m)+(-(.499999999*b)+.5)));return av(d/Math.pow(m,j),e,i)}}):h=cQ(i,j,o,!s&&t,p)}return{constraint:h,maxResolution:i,minResolution:j,minZoom:k,zoomFactor:m}}(a);this.maxResolution_=c.maxResolution,this.minResolution_=c.minResolution,this.zoomFactor_=c.zoomFactor,this.resolutions_=a.resolutions,this.padding_=a.padding,this.minZoom_=c.minZoom;let d=function(a){if(void 0!==a.extent){let b=void 0===a.smoothExtentConstraint||a.smoothExtentConstraint;return aE(a.extent,a.constrainOnlyCenter,b)}let b=b0(a.projection,"EPSG:3857");if(!0!==a.multiWorld&&b.isGlobal()){let a=b.getExtent().slice();return a[0]=-1/0,a[2]=1/0,aE(a,!1,!1)}return aF}(a),e=c.constraint,f=function(a){if(void 0===a.enableRotation||a.enableRotation){let b=a.constrainRotation;if(void 0===b||!0===b){let a;return a=ay(5),function(b,c){return c||void 0===b?b:Math.abs(b)<=a?0:b}}if(!1===b)return cS;if("number"==typeof b){let a;return a=2*Math.PI/b,function(b,c){return c?b:void 0!==b?b=Math.floor(b/a+.5)*a:void 0}}return cS}return cR}(a);this.constraints_={center:d,resolution:e,rotation:f},this.setRotation(void 0!==a.rotation?a.rotation:0),this.setCenterInternal(void 0!==a.center?a.center:null),void 0!==a.resolution?this.setResolution(a.resolution):void 0!==a.zoom&&this.setZoom(a.zoom)}get padding(){return this.padding_}set padding(a){let b=this.padding_;this.padding_=a;let c=this.getCenterInternal();if(c){let d=a||[0,0,0,0];b=b||[0,0,0,0];let e=this.getResolution(),f=e/2*(d[3]-b[3]+b[1]-d[1]),g=e/2*(d[0]-b[0]+b[2]-d[2]);this.setCenterInternal([c[0]+f,c[1]-g])}}getUpdatedOptions_(a){let b=this.getProperties();return void 0!==b.resolution?b.resolution=this.getResolution():b.zoom=this.getZoom(),b.center=this.getCenterInternal(),b.rotation=this.getRotation(),Object.assign({},b,a)}animate(a){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);let b=Array(arguments.length);for(let a=0;a<b.length;++a){let c=arguments[a];c.center&&((c=Object.assign({},c)).center=ca(c.center,this.getProjection())),c.anchor&&((c=Object.assign({},c)).anchor=ca(c.anchor,this.getProjection())),b[a]=c}this.animateInternal.apply(this,b)}animateInternal(a){let b,c=arguments.length;c>1&&"function"==typeof arguments[c-1]&&(b=arguments[c-1],--c);let d=0;for(;d<c&&!this.isDef();++d){let a=arguments[d];a.center&&this.setCenterInternal(a.center),void 0!==a.zoom?this.setZoom(a.zoom):a.resolution&&this.setResolution(a.resolution),void 0!==a.rotation&&this.setRotation(a.rotation)}if(d===c){b&&cT(b,!0);return}let e=Date.now(),f=this.targetCenter_.slice(),g=this.targetResolution_,h=this.targetRotation_,i=[];for(;d<c;++d){var j;let a=arguments[d],c={start:e,complete:!1,anchor:a.anchor,duration:void 0!==a.duration?a.duration:1e3,easing:a.easing||be,callback:b};if(a.center&&(c.sourceCenter=f,c.targetCenter=a.center.slice(),f=c.targetCenter),void 0!==a.zoom?(c.sourceResolution=g,c.targetResolution=this.getResolutionForZoom(a.zoom),g=c.targetResolution):a.resolution&&(c.sourceResolution=g,c.targetResolution=a.resolution,g=c.targetResolution),void 0!==a.rotation){c.sourceRotation=h;let b=az(a.rotation-h+Math.PI,2*Math.PI)-Math.PI;c.targetRotation=h+b,h=c.targetRotation}(!(j=c).sourceCenter||!j.targetCenter||a9(j.sourceCenter,j.targetCenter))&&j.sourceResolution===j.targetResolution&&j.sourceRotation===j.targetRotation?c.complete=!0:e+=c.duration,i.push(c)}this.animations_.push(i),this.setHint(0,1),this.updateAnimations_()}getAnimating(){return this.hints_[0]>0}getInteracting(){return this.hints_[1]>0}cancelAnimations(){let a;this.setHint(0,-this.hints_[0]);for(let b=0,c=this.animations_.length;b<c;++b){let c=this.animations_[b];if(c[0].callback&&cT(c[0].callback,!1),!a)for(let b=0,d=c.length;b<d;++b){let d=c[b];if(!d.complete){a=d.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=a,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(void 0!==this.updateAnimationKey_&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;let a=Date.now(),b=!1;for(let c=this.animations_.length-1;c>=0;--c){let d=this.animations_[c],e=!0;for(let c=0,f=d.length;c<f;++c){let f=d[c];if(f.complete)continue;let g=a-f.start,h=f.duration>0?g/f.duration:1;h>=1?(f.complete=!0,h=1):e=!1;let i=f.easing(h);if(f.sourceCenter){let a=f.sourceCenter[0],b=f.sourceCenter[1],c=f.targetCenter[0],d=f.targetCenter[1];this.nextCenter_=f.targetCenter;let e=a+i*(c-a),g=b+i*(d-b);this.targetCenter_=[e,g]}if(f.sourceResolution&&f.targetResolution){let a=1===i?f.targetResolution:f.sourceResolution+i*(f.targetResolution-f.sourceResolution);if(f.anchor){let b=this.getViewportSize_(this.getRotation()),c=this.constraints_.resolution(a,0,b,!0);this.targetCenter_=this.calculateCenterZoom(c,f.anchor)}this.nextResolution_=f.targetResolution,this.targetResolution_=a,this.applyTargetState_(!0)}if(void 0!==f.sourceRotation&&void 0!==f.targetRotation){let a=1===i?az(f.targetRotation+Math.PI,2*Math.PI)-Math.PI:f.sourceRotation+i*(f.targetRotation-f.sourceRotation);if(f.anchor){let b=this.constraints_.rotation(a,!0);this.targetCenter_=this.calculateCenterRotate(b,f.anchor)}this.nextRotation_=f.targetRotation,this.targetRotation_=a}if(this.applyTargetState_(!0),b=!0,!f.complete)break}if(e){this.animations_[c]=null,this.setHint(0,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;let a=d[0].callback;a&&cT(a,!0)}}this.animations_=this.animations_.filter(Boolean),b&&void 0===this.updateAnimationKey_&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(a,b){let c,d=this.getCenterInternal();if(void 0!==d){var e;ba(c=[d[0]-b[0],d[1]-b[1]],a-this.getRotation()),e=c,e[0]+=+b[0],e[1]+=+b[1]}return c}calculateCenterZoom(a,b){let c,d=this.getCenterInternal(),e=this.getResolution();return void 0!==d&&void 0!==e&&(c=[b[0]-a*(b[0]-d[0])/e,b[1]-a*(b[1]-d[1])/e]),c}getViewportSize_(a){let b=this.viewportSize_;if(a){let c=b[0],d=b[1];return[Math.abs(c*Math.cos(a))+Math.abs(d*Math.sin(a)),Math.abs(c*Math.sin(a))+Math.abs(d*Math.cos(a))]}return b}setViewportSize(a){this.viewportSize_=Array.isArray(a)?a.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){var a,b;let c=this.getCenterInternal();return c?(a=c,b=this.getProjection(),a):c}getCenterInternal(){return this.get(au.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(a){return void 0!==a?(a[0]=this.hints_[0],a[1]=this.hints_[1],a):this.hints_.slice()}calculateExtent(a){var b,c;return b=this.calculateExtentInternal(a),c=this.getProjection(),b}calculateExtentInternal(a){a=a||this.getViewportSizeMinusPadding_();let b=this.getCenterInternal();aq(b,"The view center is not defined");let c=this.getResolution();aq(void 0!==c,"The view resolution is not defined");let d=this.getRotation();return aq(void 0!==d,"The view rotation is not defined"),a$(b,c,d,a)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(a){this.applyOptions_(this.getUpdatedOptions_({maxZoom:a}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(a){this.applyOptions_(this.getUpdatedOptions_({minZoom:a}))}setConstrainResolution(a){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:a}))}getProjection(){return this.projection_}getResolution(){return this.get(au.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(a,b){var c,d;return this.getResolutionForExtentInternal((c=a,d=this.getProjection(),c),b)}getResolutionForExtentInternal(a,b){return b=b||this.getViewportSizeMinusPadding_(),Math.max(a4(a)/b[0],a0(a)/b[1])}getResolutionForValueFunction(a){a=a||2;let b=this.getConstrainedResolution(this.maxResolution_),c=Math.log(b/this.minResolution_)/Math.log(a);return function(d){return b/Math.pow(a,d*c)}}getRotation(){return this.get(au.ROTATION)}getValueForResolutionFunction(a){let b=Math.log(a||2),c=this.getConstrainedResolution(this.maxResolution_),d=Math.log(c/this.minResolution_)/b;return function(a){return Math.log(c/a)/b/d}}getViewportSizeMinusPadding_(a){let b=this.getViewportSize_(a),c=this.padding_;return c&&(b=[b[0]-c[1]-c[3],b[1]-c[0]-c[2]]),b}getState(){let a=this.getProjection(),b=this.getResolution(),c=this.getRotation(),d=this.getCenterInternal(),e=this.padding_;if(e){let a=this.getViewportSizeMinusPadding_();d=cU(d,this.getViewportSize_(),[a[0]/2+e[3],a[1]/2+e[0]],b,c)}return{center:d.slice(0),projection:void 0!==a?a:null,resolution:b,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:c,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let a,b=this.getResolution();return void 0!==b&&(a=this.getZoomForResolution(b)),a}getZoomForResolution(a){let b,c,d=this.minZoom_||0;if(this.resolutions_){let e=C(this.resolutions_,a,1);d=e,b=this.resolutions_[e],c=e==this.resolutions_.length-1?2:b/this.resolutions_[e+1]}else b=this.maxResolution_,c=this.zoomFactor_;return d+Math.log(b/a)/Math.log(c)}getResolutionForZoom(a){if(this.resolutions_?.length){if(1===this.resolutions_.length)return this.resolutions_[0];let b=av(Math.floor(a),0,this.resolutions_.length-2),c=this.resolutions_[b]/this.resolutions_[b+1];return this.resolutions_[b]/Math.pow(c,av(a-b,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,a-this.minZoom_)}fit(a,b){var c,d,e,f;let g;if(aq(Array.isArray(a)||"function"==typeof a.getSimplifiedGeometry,"Invalid extent or geometry provided as `geometry`"),Array.isArray(a)){aq(!a6(a),"Cannot fit empty extent provided as `geometry`"),g=cN((c=a,d=this.getProjection(),c))}else if("Circle"===a.getType()){let b=(e=a.getExtent(),f=this.getProjection(),e);(g=cN(b)).rotate(this.getRotation(),aZ(b))}else{let b=b8();g=b?a.clone().transform(b,this.getProjection()):a}this.fitInternal(g,b)}rotatedExtentForGeometry(a){let b=this.getRotation(),c=Math.cos(b),d=Math.sin(-b),e=a.getFlatCoordinates(),f=a.getStride(),g=Infinity,h=Infinity,i=-1/0,j=-1/0;for(let a=0,b=e.length;a<b;a+=f){let b=e[a]*c-e[a+1]*d,f=e[a]*d+e[a+1]*c;g=Math.min(g,b),h=Math.min(h,f),i=Math.max(i,b),j=Math.max(j,f)}return[g,h,i,j]}fitInternal(a,b){let c,d=(b=b||{}).size;d||(d=this.getViewportSizeMinusPadding_());let e=void 0!==b.padding?b.padding:[0,0,0,0],f=void 0!==b.nearest&&b.nearest;c=void 0!==b.minResolution?b.minResolution:void 0!==b.maxZoom?this.getResolutionForZoom(b.maxZoom):0;let g=this.rotatedExtentForGeometry(a),h=this.getResolutionForExtentInternal(g,[d[0]-e[1]-e[3],d[1]-e[0]-e[2]]);h=isNaN(h)?c:Math.max(h,c),h=this.getConstrainedResolution(h,+!f);let i=this.getRotation(),j=Math.sin(i),k=Math.cos(i),l=aZ(g);l[0]+=(e[1]-e[3])/2*h,l[1]+=(e[0]-e[2])/2*h;let m=l[0]*k-l[1]*j,n=l[1]*k+l[0]*j,o=this.getConstrainedCenter([m,n],h),p=b.callback?b.callback:H;void 0!==b.duration?this.animateInternal({resolution:h,center:o,duration:b.duration,easing:b.easing},p):(this.targetResolution_=h,this.targetCenter_=o,this.applyTargetState_(!1,!0),cT(p,!0))}centerOn(a,b,c){this.centerOnInternal(ca(a,this.getProjection()),b,c)}centerOnInternal(a,b,c){this.setCenterInternal(cU(a,b,c,this.getResolution(),this.getRotation()))}calculateCenterShift(a,b,c,d){let e,f=this.padding_;if(f&&a){let g=this.getViewportSizeMinusPadding_(-c),h=cU(a,d,[g[0]/2+f[3],g[1]/2+f[0]],b,c);e=[a[0]-h[0],a[1]-h[1]]}return e}isDef(){return!!this.getCenterInternal()&&void 0!==this.getResolution()}adjustCenter(a){var b,c;let d=(b=this.targetCenter_,c=this.getProjection(),b);this.setCenter([d[0]+a[0],d[1]+a[1]])}adjustCenterInternal(a){let b=this.targetCenter_;this.setCenterInternal([b[0]+a[0],b[1]+a[1]])}adjustResolution(a,b){b=b&&ca(b,this.getProjection()),this.adjustResolutionInternal(a,b)}adjustResolutionInternal(a,b){let c=this.getAnimating()||this.getInteracting(),d=this.getViewportSize_(this.getRotation()),e=this.constraints_.resolution(this.targetResolution_*a,0,d,c);b&&(this.targetCenter_=this.calculateCenterZoom(e,b)),this.targetResolution_*=a,this.applyTargetState_()}adjustZoom(a,b){this.adjustResolution(Math.pow(this.zoomFactor_,-a),b)}adjustRotation(a,b){b&&(b=ca(b,this.getProjection())),this.adjustRotationInternal(a,b)}adjustRotationInternal(a,b){let c=this.getAnimating()||this.getInteracting(),d=this.constraints_.rotation(this.targetRotation_+a,c);b&&(this.targetCenter_=this.calculateCenterRotate(d,b)),this.targetRotation_+=a,this.applyTargetState_()}setCenter(a){this.setCenterInternal(a?ca(a,this.getProjection()):a)}setCenterInternal(a){this.targetCenter_=a,this.applyTargetState_()}setHint(a,b){return this.hints_[a]+=b,this.changed(),this.hints_[a]}setResolution(a){this.targetResolution_=a,this.applyTargetState_()}setRotation(a){this.targetRotation_=a,this.applyTargetState_()}setZoom(a){this.setResolution(this.getResolutionForZoom(a))}applyTargetState_(a,b){let c=this.getAnimating()||this.getInteracting()||b,d=this.constraints_.rotation(this.targetRotation_,c),e=this.getViewportSize_(d),f=this.constraints_.resolution(this.targetResolution_,0,e,c),g=this.constraints_.center(this.targetCenter_,f,e,c,this.calculateCenterShift(this.targetCenter_,f,d,e));this.get(au.ROTATION)!==d&&this.set(au.ROTATION,d),this.get(au.RESOLUTION)!==f&&(this.set(au.RESOLUTION,f),this.set("zoom",this.getZoom(),!0)),g&&this.get(au.CENTER)&&a9(this.get(au.CENTER),g)||this.set(au.CENTER,g),this.getAnimating()&&!a&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(a,b,c){a=void 0!==a?a:200;let d=this.constraints_.rotation(this.targetRotation_),e=this.getViewportSize_(d),f=this.constraints_.resolution(this.targetResolution_,b||0,e),g=this.constraints_.center(this.targetCenter_,f,e,!1,this.calculateCenterShift(this.targetCenter_,f,d,e));if(0===a&&!this.cancelAnchor_){this.targetResolution_=f,this.targetRotation_=d,this.targetCenter_=g,this.applyTargetState_();return}c=c||(0===a?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,this.getResolution()===f&&this.getRotation()===d&&this.getCenterInternal()&&a9(this.getCenterInternal(),g)||(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:d,center:g,resolution:f,duration:a,easing:bd,anchor:c}))}beginInteraction(){this.resolveConstraints(0),this.setHint(1,1)}endInteraction(a,b,c){c=c&&ca(c,this.getProjection()),this.endInteractionInternal(a,b,c)}endInteractionInternal(a,b,c){this.getInteracting()&&(this.setHint(1,-1),this.resolveConstraints(a,b,c))}getConstrainedCenter(a,b){let c=this.getViewportSize_(this.getRotation());return this.constraints_.center(a,b||this.getResolution(),c)}getConstrainedZoom(a,b){let c=this.getResolutionForZoom(a);return this.getZoomForResolution(this.getConstrainedResolution(c,b))}getConstrainedResolution(a,b){b=b||0;let c=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(a,b,c)}};a.s(["default",0,cV],40874);let cW="ol-hidden",cX="ol-unselectable",cY="ol-control",cZ="ol-collapsed",c$=RegExp("^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))?\\s*([-,\\\"\\'\\sa-z0-9]+?)\\s*$","i"),c_=["style","variant","weight","size","lineHeight","family"],c0={normal:400,bold:700},c1=function(a){let b=a.match(c$);if(!b)return null;let c={lineHeight:"normal",size:"1.2em",style:"normal",weight:"400",variant:"normal"};for(let a=0,d=c_.length;a<d;++a){let d=b[a+1];void 0!==d&&(c[c_[a]]="string"==typeof d?d.trim():d)}return isNaN(Number(c.weight))&&c.weight in c0&&(c.weight=c0[c.weight]),c.families=c.family.split(/,\s?/).map(a=>a.trim().replace(/^['"]|['"]$/g,"")),c};function c2(a,b,c,d){let e;return e=c&&c.length?c.shift():ae?new class extends OffscreenCanvas{style={}}(a??300,b??150):document.createElement("canvas"),a&&(e.width=a),b&&(e.height=b),e.getContext("2d",d)}function c3(){return b||(b=c2(1,1)),b}function c4(a){let b=a.canvas;b.width=1,b.height=1,a.clearRect(0,0,1,1)}function c5(a,b){let c=b.parentNode;c&&c.replaceChild(a,b)}function c6(){return new Proxy({childNodes:[],appendChild:function(a){return this.childNodes.push(a),a},remove:function(){},removeChild:function(a){let b=this.childNodes.indexOf(a);if(-1===b)throw Error("Node to remove was not found");return this.childNodes.splice(b,1),a},insertBefore:function(a,b){let c=this.childNodes.indexOf(b);if(-1===c)throw Error("Reference node not found");return this.childNodes.splice(c,0,a),a},style:{}},{get:(a,b,c)=>"firstElementChild"===b?a.childNodes.length>0?a.childNodes[0]:null:Reflect.get(a,b,c)})}function c7(a){return"u">typeof HTMLCanvasElement&&a instanceof HTMLCanvasElement||"u">typeof OffscreenCanvas&&a instanceof OffscreenCanvas}let c8=class extends V{constructor(a){super();const b=a.element;!b||a.target||b.style.pointerEvents||(b.style.pointerEvents="auto"),this.element=b||null,this.target_=null,this.map_=null,this.listenerKeys=[],a.render&&(this.render=a.render),a.target&&this.setTarget(a.target)}disposeInternal(){this.element?.remove(),super.disposeInternal()}getMap(){return this.map_}setMap(a){this.map_&&this.element?.remove();for(let a=0,b=this.listenerKeys.length;a<b;++a)O(this.listenerKeys[a]);if(this.listenerKeys.length=0,this.map_=a,a){let b=this.target_??a.getOverlayContainerStopEvent();this.element&&b.appendChild(this.element),this.render!==H&&this.listenerKeys.push(N(a,aj,this.render,this)),a.render()}}render(a){}setTarget(a){this.target_="string"==typeof a?document.getElementById(a):a}},c9=class extends c8{constructor(a){a=a||{},super({element:document.createElement("div"),render:a.render,target:a.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=void 0===a.collapsed||a.collapsed,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=void 0!==a.collapsible,this.collapsible_=void 0===a.collapsible||a.collapsible,this.collapsible_||(this.collapsed_=!1),this.attributions_=a.attributions;const b=void 0!==a.className?a.className:"ol-attribution",c=void 0!==a.tipLabel?a.tipLabel:"Attributions",d=void 0!==a.expandClassName?a.expandClassName:b+"-expand",e=void 0!==a.collapseLabel?a.collapseLabel:"",f=void 0!==a.collapseClassName?a.collapseClassName:b+"-collapse";"string"==typeof e?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=e,this.collapseLabel_.className=f):this.collapseLabel_=e;const g=void 0!==a.label?a.label:"i";"string"==typeof g?(this.label_=document.createElement("span"),this.label_.textContent=g,this.label_.className=d):this.label_=g;const h=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=c,this.toggleButton_.appendChild(h),this.toggleButton_.addEventListener(u,this.handleClick_.bind(this),!1);const i=b+" "+cX+" "+cY+(this.collapsed_&&this.collapsible_?" "+cZ:"")+(this.collapsible_?"":" ol-uncollapsible"),j=this.element;j.className=i,j.appendChild(this.toggleButton_),j.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(a){let b=this.getMap().getAllLayers(),c=new Set(b.flatMap(b=>b.getAttributions(a)));if(void 0!==this.attributions_&&(Array.isArray(this.attributions_)?this.attributions_.forEach(a=>c.add(a)):c.add(this.attributions_)),!this.overrideCollapsible_){let a=!b.some(a=>a.getSource()?.getAttributionsCollapsible()===!1);this.setCollapsible(a)}return Array.from(c)}async updateElement_(a){if(!a){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}let b=await Promise.all(this.collectSourceAttributions_(a).map(a=>(function(a){let b;try{b=a()}catch(a){return Promise.reject(a)}return b instanceof Promise?b:Promise.resolve(b)})(()=>a))),c=b.length>0;if(this.renderedVisible_!=c&&(this.element.style.display=c?"":"none",this.renderedVisible_=c),!E(b,this.renderedAttributions_)){for(var d=this.ulElement_;d.lastChild;)d.lastChild.remove();for(let a=0,c=b.length;a<c;++a){let c=document.createElement("li");c.innerHTML=b[a],this.ulElement_.appendChild(c)}this.renderedAttributions_=b}}handleClick_(a){a.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(cZ),this.collapsed_?c5(this.collapseLabel_,this.label_):c5(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(a){this.collapsible_!==a&&(this.collapsible_=a,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(a){this.userCollapsed_=a,this.collapsible_&&this.collapsed_!==a&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(a){this.updateElement_(a.frameState)}},da=class extends c8{constructor(a){a=a||{},super({element:document.createElement("div"),render:a.render,target:a.target});const b=void 0!==a.className?a.className:"ol-rotate",c=void 0!==a.label?a.label:"",d=void 0!==a.compassClassName?a.compassClassName:"ol-compass";this.label_=null,"string"==typeof c?(this.label_=document.createElement("span"),this.label_.className=d,this.label_.textContent=c):(this.label_=c,this.label_.classList.add(d));const e=a.tipLabel?a.tipLabel:"Reset rotation",f=document.createElement("button");f.className=b+"-reset",f.setAttribute("type","button"),f.title=e,f.appendChild(this.label_),f.addEventListener(u,this.handleClick_.bind(this),!1);const g=this.element;g.className=b+" "+cX+" "+cY,g.appendChild(f),this.callResetNorth_=a.resetNorth?a.resetNorth:void 0,this.duration_=void 0!==a.duration?a.duration:250,this.autoHide_=void 0===a.autoHide||a.autoHide,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(cW)}handleClick_(a){a.preventDefault(),void 0!==this.callResetNorth_?this.callResetNorth_():this.resetNorth_()}resetNorth_(){let a=this.getMap().getView();if(!a)return;let b=a.getRotation();void 0!==b&&(this.duration_>0&&b%(2*Math.PI)!=0?a.animate({rotation:0,duration:this.duration_,easing:bd}):a.setRotation(0))}render(a){let b=a.frameState;if(!b)return;let c=b.viewState.rotation;if(c!=this.rotation_){if(this.autoHide_){let a=this.element.classList.contains(cW);a||0!==c?a&&0!==c&&this.element.classList.remove(cW):this.element.classList.add(cW)}this.label_.style.transform="rotate("+c+"rad)"}this.rotation_=c}},db=class extends c8{constructor(a){a=a||{},super({element:document.createElement("div"),target:a.target});const b=void 0!==a.className?a.className:"ol-zoom",c=void 0!==a.delta?a.delta:1,d=void 0!==a.zoomInClassName?a.zoomInClassName:b+"-in",e=void 0!==a.zoomOutClassName?a.zoomOutClassName:b+"-out",f=void 0!==a.zoomInLabel?a.zoomInLabel:"+",g=void 0!==a.zoomOutLabel?a.zoomOutLabel:"",h=void 0!==a.zoomInTipLabel?a.zoomInTipLabel:"Zoom in",i=void 0!==a.zoomOutTipLabel?a.zoomOutTipLabel:"Zoom out",j=document.createElement("button");j.className=d,j.setAttribute("type","button"),j.title=h,j.appendChild("string"==typeof f?document.createTextNode(f):f),j.addEventListener(u,this.handleClick_.bind(this,c),!1);const k=document.createElement("button");k.className=e,k.setAttribute("type","button"),k.title=i,k.appendChild("string"==typeof g?document.createTextNode(g):g),k.addEventListener(u,this.handleClick_.bind(this,-c),!1);const l=this.element;l.className=b+" "+cX+" "+cY,l.appendChild(j),l.appendChild(k),this.duration_=void 0!==a.duration?a.duration:250}handleClick_(a,b){b.preventDefault(),this.zoomByDelta_(a)}zoomByDelta_(a){let b=this.getMap().getView();if(!b)return;let c=b.getZoom();if(void 0!==c){let d=b.getConstrainedZoom(c+a);this.duration_>0?(b.getAnimating()&&b.cancelAnimations(),b.animate({zoom:d,duration:this.duration_,easing:bd})):b.setZoom(d)}}},dc=class{constructor(a,b,c){this.decay_=a,this.minVelocity_=b,this.delay_=c,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(a,b){this.points_.push(a,b,Date.now())}end(){if(this.points_.length<6)return!1;let a=Date.now()-this.delay_,b=this.points_.length-3;if(this.points_[b+2]<a)return!1;let c=b-3;for(;c>0&&this.points_[c+2]>a;)c-=3;let d=this.points_[b+2]-this.points_[c+2];if(d<1e3/60)return!1;let e=this.points_[b]-this.points_[c],f=this.points_[b+1]-this.points_[c+1];return this.angle_=Math.atan2(f,e),this.initialVelocity_=Math.sqrt(e*e+f*f)/d,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}},dd="active";function de(a,b,c,d){let e=a.getZoom();if(void 0===e)return;let f=a.getConstrainedZoom(e+b),g=a.getResolutionForZoom(f);a.getAnimating()&&a.cancelAnimations(),a.animate({resolution:g,anchor:c,duration:void 0!==d?d:250,easing:bd})}let df=class extends V{constructor(a){super(),this.on,this.once,this.un,a&&a.handleEvent&&(this.handleEvent=a.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(dd)}getMap(){return this.map_}handleEvent(a){return!0}setActive(a){this.set(dd,a)}setMap(a){this.map_=a}},dg=class extends df{constructor(a){super(),a=a||{},this.delta_=a.delta?a.delta:1,this.duration_=void 0!==a.duration?a.duration:250}handleEvent(a){let b=!1;if(a.type==_.DBLCLICK){let c=a.originalEvent,d=a.map,e=a.coordinate,f=c.shiftKey?-this.delta_:this.delta_;de(d.getView(),f,e,this.duration_),c.preventDefault(),b=!0}return!b}};function dh(a){let b=arguments;return function(a){let c=!0;for(let d=0,e=b.length;d<e&&(c=c&&b[d](a));++d);return c}}let di=function(a){let b=a.originalEvent;return b.altKey&&!(b.metaKey||b.ctrlKey)&&b.shiftKey},dj=function(a){let b=a.map.getTargetElement(),c=b.getRootNode(),d=a.map.getOwnerDocument().activeElement;return c instanceof ShadowRoot?c.host.contains(d):b.contains(d)},dk=function(a){let b=a.map.getTargetElement(),c=b.getRootNode();return!(c instanceof ShadowRoot?c.host:b).hasAttribute("tabindex")||dj(a)},dl=function(a){let b=a.originalEvent;return"pointerId"in b&&0==b.button&&!(ab&&ac&&b.ctrlKey)},dm=function(a){let b=a.originalEvent;return!b.altKey&&!(b.metaKey||b.ctrlKey)&&!b.shiftKey},dn=function(a){let b=a.originalEvent;return ac?b.metaKey:b.ctrlKey},dp=function(a){let b=a.originalEvent;return!b.altKey&&!(b.metaKey||b.ctrlKey)&&b.shiftKey},dq=function(a){let b=a.originalEvent,c=b.target.tagName;return"INPUT"!==c&&"SELECT"!==c&&"TEXTAREA"!==c&&!b.target.isContentEditable},dr=function(a){let b=a.originalEvent;return"pointerId"in b&&"mouse"==b.pointerType},ds=function(a){let b=a.originalEvent;return"pointerId"in b&&b.isPrimary&&0===b.button};function dt(a){let b=a.length,c=0,d=0;for(let e=0;e<b;e++)c+=a[e].clientX,d+=a[e].clientY;return{clientX:c/b,clientY:d/b}}let du=class extends df{constructor(a){super(a=a||{}),a.handleDownEvent&&(this.handleDownEvent=a.handleDownEvent),a.handleDragEvent&&(this.handleDragEvent=a.handleDragEvent),a.handleMoveEvent&&(this.handleMoveEvent=a.handleMoveEvent),a.handleUpEvent&&(this.handleUpEvent=a.handleUpEvent),a.stopDown&&(this.stopDown=a.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(a){return!1}handleDragEvent(a){}handleEvent(a){if(!a.originalEvent)return!0;let b=!1;if(this.updateTrackedPointers_(a),this.handlingDownUpSequence){if(a.type==_.POINTERDRAG)this.handleDragEvent(a),a.originalEvent.preventDefault();else if(a.type==_.POINTERUP){let b=this.handleUpEvent(a);this.handlingDownUpSequence=b&&this.targetPointers.length>0}}else if(a.type==_.POINTERDOWN){let c=this.handleDownEvent(a);this.handlingDownUpSequence=c,b=this.stopDown(c)}else a.type==_.POINTERMOVE&&this.handleMoveEvent(a);return!b}handleMoveEvent(a){}handleUpEvent(a){return!1}stopDown(a){return a}updateTrackedPointers_(a){a.activePointers&&(this.targetPointers=a.activePointers)}},dv=class extends du{constructor(a){super({stopDown:G}),a=a||{},this.kinetic_=a.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const b=a.condition?a.condition:dh(dm,ds);this.condition_=a.onFocusOnly?dh(dk,b):b,this.noKinetic_=!1}handleDragEvent(a){let b=a.map;this.panning_||(this.panning_=!0,b.getView().beginInteraction());let c=this.targetPointers,d=b.getEventPixel(dt(c));if(c.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(d[0],d[1]),this.lastCentroid){var e;let b=[this.lastCentroid[0]-d[0],d[1]-this.lastCentroid[1]],c=a.map.getView();e=c.getResolution(),b[0]*=e,b[1]*=e,ba(b,c.getRotation()),c.adjustCenterInternal(b)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=d,this.lastPointersCount_=c.length,a.originalEvent.preventDefault()}handleUpEvent(a){let b=a.map,c=b.getView();if(0===this.targetPointers.length){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){let a=this.kinetic_.getDistance(),d=this.kinetic_.getAngle(),e=c.getCenterInternal(),f=b.getPixelFromCoordinateInternal(e),g=b.getCoordinateFromPixelInternal([f[0]-a*Math.cos(d),f[1]-a*Math.sin(d)]);c.animateInternal({center:c.getConstrainedCenter(g),duration:500,easing:bd})}return this.panning_&&(this.panning_=!1,c.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(a){if(this.targetPointers.length>0&&this.condition_(a)){let b=a.map.getView();return this.lastCentroid=null,b.getAnimating()&&b.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}},dw=class extends du{constructor(a){a=a||{},super({stopDown:G}),this.condition_=a.condition?a.condition:di,this.lastAngle_=void 0,this.duration_=void 0!==a.duration?a.duration:250}handleDragEvent(a){if(!dr(a))return;let b=a.map,c=b.getView();if(c.getConstraints().rotation===cR)return;let d=b.getSize(),e=a.pixel,f=Math.atan2(d[1]/2-e[1],e[0]-d[0]/2);if(void 0!==this.lastAngle_){let a=f-this.lastAngle_;c.adjustRotationInternal(-a)}this.lastAngle_=f}handleUpEvent(a){return!dr(a)||(a.map.getView().endInteraction(this.duration_),!1)}handleDownEvent(a){return!!dr(a)&&!!(dl(a)&&this.condition_(a))&&(a.map.getView().beginInteraction(),this.lastAngle_=void 0,!0)}},dx=class extends z{constructor(a){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+a,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){let a=this.startPixel_,b=this.endPixel_,c=this.element_.style;c.left=Math.min(a[0],b[0])+"px",c.top=Math.min(a[1],b[1])+"px",c.width=Math.abs(b[0]-a[0])+"px",c.height=Math.abs(b[1]-a[1])+"px"}setMap(a){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);let a=this.element_.style;a.left="inherit",a.top="inherit",a.width="inherit",a.height="inherit"}this.map_=a,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(a,b){this.startPixel_=a,this.endPixel_=b,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){if(!this.map_)return;let a=this.startPixel_,b=this.endPixel_,c=[a,[a[0],b[1]],b,[b[0],a[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);c[4]=c[0].slice(),this.geometry_?this.geometry_.setCoordinates([c]):this.geometry_=new cM([c])}getGeometry(){return this.geometry_}},dy="boxcancel";class dz extends L{constructor(a,b,c){super(a),this.coordinate=b,this.mapBrowserEvent=c}}let dA=class extends du{constructor(a){super(),this.on,this.once,this.un,a=a??{},this.box_=new dx(a.className||"ol-dragbox"),this.minArea_=a.minArea??64,a.onBoxEnd&&(this.onBoxEnd=a.onBoxEnd),this.startPixel_=null,this.condition_=a.condition??dl,this.boxEndCondition_=a.boxEndCondition??this.defaultBoxEndCondition}defaultBoxEndCondition(a,b,c){let d=c[0]-b[0],e=c[1]-b[1];return d*d+e*e>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(a){this.startPixel_&&(this.box_.setPixels(this.startPixel_,a.pixel),this.dispatchEvent(new dz("boxdrag",a.coordinate,a)))}handleUpEvent(a){if(!this.startPixel_)return!1;let b=this.boxEndCondition_(a,this.startPixel_,a.pixel);return b&&this.onBoxEnd(a),this.dispatchEvent(new dz(b?"boxend":dy,a.coordinate,a)),this.box_.setMap(null),this.startPixel_=null,!1}handleDownEvent(a){return!!this.condition_(a)&&(this.startPixel_=a.pixel,this.box_.setMap(a.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new dz("boxstart",a.coordinate,a)),!0)}onBoxEnd(a){}setActive(a){!a&&(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new dz(dy,this.startPixel_,null)),this.startPixel_=null)),super.setActive(a)}setMap(a){this.getMap()&&(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new dz(dy,this.startPixel_,null)),this.startPixel_=null)),super.setMap(a)}},dB=class extends dA{constructor(a){super({condition:(a=a||{}).condition?a.condition:dp,className:a.className||"ol-dragzoom",minArea:a.minArea}),this.duration_=void 0!==a.duration?a.duration:200,this.out_=void 0!==a.out&&a.out}onBoxEnd(a){let b=this.getMap().getView(),c=this.getGeometry();if(this.out_){let a=b.rotatedExtentForGeometry(c),d=b.getResolutionForExtentInternal(a),e=b.getResolution()/d;(c=c.clone()).scale(e*e)}b.fitInternal(c,{duration:this.duration_,easing:bd})}},dC="ArrowLeft",dD="ArrowRight",dE="ArrowDown",dF=class extends df{constructor(a){super(),a=a||{},this.defaultCondition_=function(a){return dm(a)&&dq(a)},this.condition_=void 0!==a.condition?a.condition:this.defaultCondition_,this.duration_=void 0!==a.duration?a.duration:100,this.pixelDelta_=void 0!==a.pixelDelta?a.pixelDelta:128}handleEvent(a){let b=!1;if(a.type==v){let d=a.originalEvent,e=d.key;if(this.condition_(a)&&(e==dE||e==dC||e==dD||"ArrowUp"==e)){let f=a.map.getView(),g=f.getResolution()*this.pixelDelta_,h=0,i=0;e==dE?i=-g:e==dC?h=-g:e==dD?h=g:i=g;let j=[h,i];ba(j,f.getRotation());var c=this.duration_;let k=f.getCenterInternal();if(k){let a=[k[0]+j[0],k[1]+j[1]];f.animateInternal({duration:void 0!==c?c:250,easing:bf,center:f.getConstrainedCenter(a)})}d.preventDefault(),b=!0}}return!b}},dG=class extends df{constructor(a){super(),a=a||{},this.condition_=a.condition?a.condition:function(a){return!dn(a)&&dq(a)},this.delta_=a.delta?a.delta:1,this.duration_=void 0!==a.duration?a.duration:100}handleEvent(a){let b=!1;if(a.type==v||a.type==w){let c=a.originalEvent,d=c.key;if(this.condition_(a)&&("+"===d||"-"===d)){let e=a.map,f="+"===d?this.delta_:-this.delta_;de(e.getView(),f,void 0,this.duration_),c.preventDefault(),b=!0}}return!b}},dH=class extends df{constructor(a){super(a=a||{}),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=void 0!==a.maxDelta?a.maxDelta:1,this.duration_=void 0!==a.duration?a.duration:250,this.timeout_=void 0!==a.timeout?a.timeout:80,this.useAnchor_=void 0===a.useAnchor||a.useAnchor,this.constrainResolution_=void 0!==a.constrainResolution&&a.constrainResolution;const b=a.condition?a.condition:F;this.condition_=a.onFocusOnly?dh(dk,b):b,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;let a=this.getMap();a&&a.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_?a.getCoordinateFromPixel(this.lastAnchor_):null)}handleEvent(a){if(!this.condition_(a)||a.type!==y)return!0;let b=a.map,c=a.originalEvent;c.preventDefault(),this.useAnchor_&&(this.lastAnchor_=a.pixel);let d=c.deltaY;switch(c.deltaMode){case WheelEvent.DOM_DELTA_LINE:d*=40;break;case WheelEvent.DOM_DELTA_PAGE:d*=300}if(0===d)return!1;this.lastDelta_=d;let e=Date.now();void 0===this.startTime_&&(this.startTime_=e),(!this.mode_||e-this.startTime_>this.trackpadEventGap_)&&(this.mode_=4>Math.abs(d)?"trackpad":"wheel");let f=b.getView();if("trackpad"===this.mode_&&!(f.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(f.getAnimating()&&f.cancelAnimations(),f.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),f.adjustZoom(-d/this.deltaPerZoom_,this.lastAnchor_?b.getCoordinateFromPixel(this.lastAnchor_):null),this.startTime_=e,!1;this.totalDelta_+=d;let g=Math.max(this.timeout_-(e-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,b),g),!1}handleWheelZoom_(a){let b=a.getView();b.getAnimating()&&b.cancelAnimations();let c=-av(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(b.getConstrainResolution()||this.constrainResolution_)&&(c=c?c>0?1:-1:0),de(b,c,this.lastAnchor_?a.getCoordinateFromPixel(this.lastAnchor_):null,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(a){this.useAnchor_=a,a||(this.lastAnchor_=null)}},dI=class extends du{constructor(a){const b=a=a||{};b.stopDown||(b.stopDown=G),super(b),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=void 0!==a.threshold?a.threshold:.3,this.duration_=void 0!==a.duration?a.duration:250}handleDragEvent(a){let b=0,c=this.targetPointers[0],d=this.targetPointers[1],e=Math.atan2(d.clientY-c.clientY,d.clientX-c.clientX);if(void 0!==this.lastAngle_){let a=e-this.lastAngle_;this.rotationDelta_+=a,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),b=a}this.lastAngle_=e;let f=a.map,g=f.getView();g.getConstraints().rotation!==cR&&(this.anchor_=f.getCoordinateFromPixelInternal(f.getEventPixel(dt(this.targetPointers))),this.rotating_&&(f.render(),g.adjustRotationInternal(b,this.anchor_)))}handleUpEvent(a){return!(this.targetPointers.length<2)||(a.map.getView().endInteraction(this.duration_),!1)}handleDownEvent(a){if(this.targetPointers.length>=2){let b=a.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||b.getView().beginInteraction(),!0}return!1}},dJ=class extends du{constructor(a){const b=a=a||{};b.stopDown||(b.stopDown=G),super(b),this.anchor_=null,this.duration_=void 0!==a.duration?a.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(a){let b=1,c=this.targetPointers[0],d=this.targetPointers[1],e=c.clientX-d.clientX,f=c.clientY-d.clientY,g=Math.sqrt(e*e+f*f);void 0!==this.lastDistance_&&(b=this.lastDistance_/g),this.lastDistance_=g;let h=a.map,i=h.getView();1!=b&&(this.lastScaleDelta_=b),this.anchor_=h.getCoordinateFromPixelInternal(h.getEventPixel(dt(this.targetPointers))),h.render(),i.adjustResolutionInternal(b,this.anchor_)}handleUpEvent(a){if(this.targetPointers.length<2){let b=a.map.getView(),c=this.lastScaleDelta_>1?1:-1;return b.endInteraction(this.duration_,c),!1}return!0}handleDownEvent(a){if(this.targetPointers.length>=2){let b=a.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||b.getView().beginInteraction(),!0}return!1}},dK="opacity",dL="visible",dM="extent",dN="zIndex",dO="maxResolution",dP="minResolution",dQ="maxZoom",dR="minZoom",dS="source",dT=class extends V{constructor(a){super(),this.on,this.once,this.un,this.background_=a.background;const b=Object.assign({},a);"object"==typeof a.properties&&(delete b.properties,Object.assign(b,a.properties)),b[dK]=void 0!==a.opacity?a.opacity:1,aq("number"==typeof b[dK],"Layer opacity must be a number"),b[dL]=void 0===a.visible||a.visible,b[dN]=a.zIndex,b[dO]=void 0!==a.maxResolution?a.maxResolution:1/0,b[dP]=void 0!==a.minResolution?a.minResolution:0,b[dR]=void 0!==a.minZoom?a.minZoom:-1/0,b[dQ]=void 0!==a.maxZoom?a.maxZoom:1/0,this.className_=void 0!==b.className?b.className:"ol-layer",delete b.className,this.setProperties(b),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(a){let b=this.state_||{layer:this,managed:void 0===a||a},c=this.getZIndex();return b.opacity=av(Math.round(100*this.getOpacity())/100,0,1),b.visible=this.getVisible(),b.extent=this.getExtent(),b.zIndex=void 0!==c||b.managed?c:1/0,b.maxResolution=this.getMaxResolution(),b.minResolution=Math.max(this.getMinResolution(),0),b.minZoom=this.getMinZoom(),b.maxZoom=this.getMaxZoom(),this.state_=b,b}getLayersArray(a){return R()}getLayerStatesArray(a){return R()}getExtent(){return this.get(dM)}getMaxResolution(){return this.get(dO)}getMinResolution(){return this.get(dP)}getMinZoom(){return this.get(dR)}getMaxZoom(){return this.get(dQ)}getOpacity(){return this.get(dK)}getSourceState(){return R()}getVisible(){return this.get(dL)}getZIndex(){return this.get(dN)}setBackground(a){this.background_=a,this.changed()}setExtent(a){this.set(dM,a)}setMaxResolution(a){this.set(dO,a)}setMinResolution(a){this.set(dP,a)}setMaxZoom(a){this.set(dQ,a)}setMinZoom(a){this.set(dR,a)}setOpacity(a){aq("number"==typeof a,"Layer opacity must be a number"),this.set(dK,a)}setVisible(a){this.set(dL,a)}setZIndex(a){this.set(dN,a)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}},dU="addlayer",dV="removelayer";class dW extends L{constructor(a,b){super(a),this.layer=b}}let dX="layers";class dY extends dT{constructor(a){const b=Object.assign({},a=a||{});delete b.layers;let c=a.layers;super(b),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(dX,this.handleLayersChanged_),c?Array.isArray(c)?c=new Y(c.slice(),{unique:!0}):aq("function"==typeof c.getArray,"Expected `layers` to be an array or a `Collection`"):c=new Y(void 0,{unique:!0}),this.setLayers(c)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(O),this.layersListenerKeys_.length=0;let a=this.getLayers();for(let b in this.layersListenerKeys_.push(N(a,"add",this.handleLayersAdd_,this),N(a,q,this.handleLayersRemove_,this)),this.listenerKeys_)this.listenerKeys_[b].forEach(O);J(this.listenerKeys_);let b=a.getArray();for(let a=0,c=b.length;a<c;a++){let c=b[a];this.registerLayerListeners_(c),this.dispatchEvent(new dW(dU,c))}this.changed()}registerLayerListeners_(a){let b=[N(a,r,this.handleLayerChange_,this),N(a,s,this.handleLayerChange_,this)];a instanceof dY&&b.push(N(a,dU,this.handleLayerGroupAdd_,this),N(a,dV,this.handleLayerGroupRemove_,this)),this.listenerKeys_[T(a)]=b}handleLayerGroupAdd_(a){this.dispatchEvent(new dW(dU,a.layer))}handleLayerGroupRemove_(a){this.dispatchEvent(new dW(dV,a.layer))}handleLayersAdd_(a){let b=a.element;this.registerLayerListeners_(b),this.dispatchEvent(new dW(dU,b)),this.changed()}handleLayersRemove_(a){let b=a.element,c=T(b);this.listenerKeys_[c].forEach(O),delete this.listenerKeys_[c],this.dispatchEvent(new dW(dV,b)),this.changed()}getLayers(){return this.get(dX)}setLayers(a){let b=this.getLayers();if(b){let a=b.getArray();for(let b=0,c=a.length;b<c;++b)this.dispatchEvent(new dW(dV,a[b]))}this.set(dX,a)}getLayersArray(a){return a=void 0!==a?a:[],this.getLayers().forEach(function(b){b.getLayersArray(a)}),a}getLayerStatesArray(a){let b=void 0!==a?a:[],c=b.length;this.getLayers().forEach(function(a){a.getLayerStatesArray(b)});let d=this.getLayerState(),e=d.zIndex;a||void 0!==d.zIndex||(e=0);for(let a=c,f=b.length;a<f;a++){let c=b[a];c.opacity*=d.opacity,c.visible=c.visible&&d.visible,c.maxResolution=Math.min(c.maxResolution,d.maxResolution),c.minResolution=Math.max(c.minResolution,d.minResolution),c.minZoom=Math.max(c.minZoom,d.minZoom),c.maxZoom=Math.min(c.maxZoom,d.maxZoom),void 0!==d.extent&&(void 0!==c.extent?c.extent=a1(c.extent,d.extent):c.extent=d.extent),void 0===c.zIndex&&(c.zIndex=e)}return b}getSourceState(){return"ready"}}let dZ="prerender",d$="postrender",d_="precompose",d0="rendercomplete";function d1(a,b){if(!a.visible)return!1;let c=b.resolution;if(c<a.minResolution||c>=a.maxResolution)return!1;let d=b.zoom;return d>a.minZoom&&d<=a.maxZoom}let d2=class extends dT{constructor(a){const b=Object.assign({},a);delete b.source,super(b),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,a.render&&(this.render=a.render),a.map&&this.setMap(a.map),this.addChangeListener(dS,this.handleSourcePropertyChange_);const c=a.source?a.source:null;this.setSource(c)}getLayersArray(a){return(a=a||[]).push(this),a}getLayerStatesArray(a){return(a=a||[]).push(this.getLayerState()),a}getSource(){return this.get(dS)||null}getRenderSource(){return this.getSource()}getSourceState(){let a=this.getSource();return a?a.getState():"undefined"}handleSourceChange_(){this.changed(),this.sourceReady_||"ready"!==this.getSource().getState()||(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(O(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;let a=this.getSource();a&&(this.sourceChangeKey_=N(a,s,this.handleSourceChange_,this),"ready"===a.getState()&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(a){return this.renderer_?this.renderer_.getFeatures(a):Promise.resolve([])}getData(a){return this.renderer_&&this.rendered?this.renderer_.getData(a):null}isVisible(a){let b,c,d=this.getMapInternal();if(!a&&d&&(a=d.getView()),!(b=a instanceof cV?{viewState:a.getState(),extent:a.calculateExtent()}:a).layerStatesArray&&d&&(b.layerStatesArray=d.getLayerGroup().getLayerStatesArray()),b.layerStatesArray){if(!(c=b.layerStatesArray.find(a=>a.layer===this)))return!1}else c=this.getLayerState();let e=this.getExtent();return d1(c,b.viewState)&&(!e||a5(e,b.extent))}getAttributions(a){if(!this.isVisible(a))return[];let b=this.getSource()?.getAttributions();if(!b)return[];let c=b(a instanceof cV?a.getViewStateAndExtent():a);return Array.isArray(c)||(c=[c]),c}render(a,b){let c=this.getRenderer();return c.prepareFrame(a)?(this.rendered=!0,c.renderFrame(a,b)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(a,b){}renderDeferred(a){let b=this.getRenderer();b&&b.renderDeferred(a)}setMapInternal(a){a||this.unrender(),this.set("map",a)}getMapInternal(){return this.get("map")}setMap(a){this.mapPrecomposeKey_&&(O(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),a||this.changed(),this.mapRenderKey_&&(O(this.mapRenderKey_),this.mapRenderKey_=null),a&&(this.mapPrecomposeKey_=N(a,d_,this.handlePrecompose_,this),this.mapRenderKey_=N(this,s,a.render,a),this.changed())}handlePrecompose_(a){let b=a.frameState.layerStatesArray,c=this.getLayerState(!1);aq(!b.some(a=>a.layer===c.layer),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),b.push(c)}setSource(a){this.set(dS,a)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}clearRenderer(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_)}disposeInternal(){this.clearRenderer(),this.setSource(null),super.disposeInternal()}};function d3(a,b,c){let d=a[b];a[b]=a[c],a[c]=d}class d4{constructor(a=9){this._maxEntries=Math.max(4,a),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()}all(){return this._all(this.data,[])}search(a){let b=this.data,c=[];if(!ed(a,b))return c;let d=this.toBBox,e=[];for(;b;){for(let f=0;f<b.children.length;f++){let g=b.children[f],h=b.leaf?d(g):g;ed(a,h)&&(b.leaf?c.push(g):ec(a,h)?this._all(g,c):e.push(g))}b=e.pop()}return c}collides(a){let b=this.data;if(!ed(a,b))return!1;let c=[];for(;b;){for(let d=0;d<b.children.length;d++){let e=b.children[d],f=b.leaf?this.toBBox(e):e;if(ed(a,f)){if(b.leaf||ec(a,f))return!0;c.push(e)}}b=c.pop()}return!1}load(a){if(!(a&&a.length))return this;if(a.length<this._minEntries){for(let b=0;b<a.length;b++)this.insert(a[b]);return this}let b=this._build(a.slice(),0,a.length-1,0);if(this.data.children.length)if(this.data.height===b.height)this._splitRoot(this.data,b);else{if(this.data.height<b.height){let a=this.data;this.data=b,b=a}this._insert(b,this.data.height-b.height-1,!0)}else this.data=b;return this}insert(a){return a&&this._insert(a,this.data.height-1),this}clear(){return this.data=ee([]),this}remove(a,b){let c,d,e;if(!a)return this;let f=this.data,g=this.toBBox(a),h=[],i=[];for(;f||h.length;){if(f||(f=h.pop(),d=h[h.length-1],c=i.pop(),e=!0),f.leaf){let c=function(a,b,c){if(!c)return b.indexOf(a);for(let d=0;d<b.length;d++)if(c(a,b[d]))return d;return -1}(a,f.children,b);if(-1!==c){f.children.splice(c,1),h.push(f),this._condense(h);break}}!e&&!f.leaf&&ec(f,g)?(h.push(f),i.push(c),c=0,d=f,f=f.children[0]):d?(c++,f=d.children[c],e=!1):f=null}return this}toBBox(a){return a}compareMinX(a,b){return a.minX-b.minX}compareMinY(a,b){return a.minY-b.minY}toJSON(){return this.data}fromJSON(a){return this.data=a,this}_all(a,b){let c=[];for(;a;)a.leaf?b.push(...a.children):c.push(...a.children),a=c.pop();return b}_build(a,b,c,d){let e,f=c-b+1,g=this._maxEntries;if(f<=g)return d5(e=ee(a.slice(b,c+1)),this.toBBox),e;d||(d=Math.ceil(Math.log(f)/Math.log(g)),g=Math.ceil(f/Math.pow(g,d-1))),(e=ee([])).leaf=!1,e.height=d;let h=Math.ceil(f/g),i=h*Math.ceil(Math.sqrt(g));ef(a,b,c,i,this.compareMinX);for(let f=b;f<=c;f+=i){let b=Math.min(f+i-1,c);ef(a,f,b,h,this.compareMinY);for(let c=f;c<=b;c+=h){let f=Math.min(c+h-1,b);e.children.push(this._build(a,c,f,d-1))}}return d5(e,this.toBBox),e}_chooseSubtree(a,b,c,d){for(;;){let g;if(d.push(b),b.leaf||d.length-1===c)break;let h=1/0,i=1/0;for(let c=0;c<b.children.length;c++){var e,f;let d=b.children[c],j=ea(d),k=(e=a,(Math.max((f=d).maxX,e.maxX)-Math.min(f.minX,e.minX))*(Math.max(f.maxY,e.maxY)-Math.min(f.minY,e.minY))-j);k<i?(i=k,h=j<h?j:h,g=d):k===i&&j<h&&(h=j,g=d)}b=g||b.children[0]}return b}_insert(a,b,c){let d=c?a:this.toBBox(a),e=[],f=this._chooseSubtree(d,this.data,b,e);for(f.children.push(a),d7(f,d);b>=0;)if(e[b].children.length>this._maxEntries)this._split(e,b),b--;else break;this._adjustParentBBoxes(d,e,b)}_split(a,b){let c=a[b],d=c.children.length,e=this._minEntries;this._chooseSplitAxis(c,e,d);let f=this._chooseSplitIndex(c,e,d),g=ee(c.children.splice(f,c.children.length-f));g.height=c.height,g.leaf=c.leaf,d5(c,this.toBBox),d5(g,this.toBBox),b?a[b-1].children.push(g):this._splitRoot(c,g)}_splitRoot(a,b){this.data=ee([a,b]),this.data.height=a.height+1,this.data.leaf=!1,d5(this.data,this.toBBox)}_chooseSplitIndex(a,b,c){let d,e=1/0,f=1/0;for(let g=b;g<=c-b;g++){let b=d6(a,0,g,this.toBBox),h=d6(a,g,c,this.toBBox),i=function(a,b){let c=Math.max(a.minX,b.minX),d=Math.max(a.minY,b.minY);return Math.max(0,Math.min(a.maxX,b.maxX)-c)*Math.max(0,Math.min(a.maxY,b.maxY)-d)}(b,h),j=ea(b)+ea(h);i<e?(e=i,d=g,f=j<f?j:f):i===e&&j<f&&(f=j,d=g)}return d||c-b}_chooseSplitAxis(a,b,c){let d=a.leaf?this.compareMinX:d8,e=a.leaf?this.compareMinY:d9;this._allDistMargin(a,b,c,d)<this._allDistMargin(a,b,c,e)&&a.children.sort(d)}_allDistMargin(a,b,c,d){a.children.sort(d);let e=this.toBBox,f=d6(a,0,b,e),g=d6(a,c-b,c,e),h=eb(f)+eb(g);for(let d=b;d<c-b;d++){let b=a.children[d];d7(f,a.leaf?e(b):b),h+=eb(f)}for(let d=c-b-1;d>=b;d--){let b=a.children[d];d7(g,a.leaf?e(b):b),h+=eb(g)}return h}_adjustParentBBoxes(a,b,c){for(let d=c;d>=0;d--)d7(b[d],a)}_condense(a){for(let b=a.length-1,c;b>=0;b--)0===a[b].children.length?b>0?(c=a[b-1].children).splice(c.indexOf(a[b]),1):this.clear():d5(a[b],this.toBBox)}}function d5(a,b){d6(a,0,a.children.length,b,a)}function d6(a,b,c,d,e){e||(e=ee(null)),e.minX=1/0,e.minY=1/0,e.maxX=-1/0,e.maxY=-1/0;for(let f=b;f<c;f++){let b=a.children[f];d7(e,a.leaf?d(b):b)}return e}function d7(a,b){return a.minX=Math.min(a.minX,b.minX),a.minY=Math.min(a.minY,b.minY),a.maxX=Math.max(a.maxX,b.maxX),a.maxY=Math.max(a.maxY,b.maxY),a}function d8(a,b){return a.minX-b.minX}function d9(a,b){return a.minY-b.minY}function ea(a){return(a.maxX-a.minX)*(a.maxY-a.minY)}function eb(a){return a.maxX-a.minX+(a.maxY-a.minY)}function ec(a,b){return a.minX<=b.minX&&a.minY<=b.minY&&b.maxX<=a.maxX&&b.maxY<=a.maxY}function ed(a,b){return b.minX<=a.maxX&&b.minY<=a.maxY&&b.maxX>=a.minX&&b.maxY>=a.minY}function ee(a){return{children:a,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function ef(a,b,c,d,e){let f=[b,c];for(;f.length;){if((c=f.pop())-(b=f.pop())<=d)continue;let g=b+Math.ceil((c-b)/d/2)*d;!function a(b,c,d=0,e=b.length-1,f=function(a,b){return a<b?-1:+(a>b)}){for(;e>d;){if(e-d>600){let g=e-d+1,h=c-d+1,i=Math.log(g),j=.5*Math.exp(2*i/3),k=.5*Math.sqrt(i*j*(g-j)/g)*(h-g/2<0?-1:1),l=Math.max(d,Math.floor(c-h*j/g+k)),m=Math.min(e,Math.floor(c+(g-h)*j/g+k));a(b,c,l,m,f)}let g=b[c],h=d,i=e;for(d3(b,d,c),f(b[e],g)>0&&d3(b,d,e);h<i;){for(d3(b,h,i),h++,i--;0>f(b[h],g);)h++;for(;f(b[i],g)>0;)i--}0===f(b[d],g)?d3(b,d,i):d3(b,++i,e),i<=c&&(d=i+1),c<=i&&(e=i-1)}}(a,g,b,c,e),f.push(b,g,g,c)}}let eg=[NaN,NaN,NaN,0],eh=/^rgba?\(\s*(\d+%?)\s+(\d+%?)\s+(\d+%?)(?:\s*\/\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,ei=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,ej=/^rgba?\(\s*(\d+%)\s*,\s*(\d+%)\s*,\s*(\d+%)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,ek=/^#([\da-f]{3,4}|[\da-f]{6}|[\da-f]{8})$/i;function el(a,b){return a.endsWith("%")?Number(a.substring(0,a.length-1))/b:Number(a)}function em(a){throw Error('failed to parse "'+a+'" as color')}let en={},eo=0;function ep(a){return a>.0031308?269.025*Math.pow(a,1/2.4)-14.025:3294.6*a}function eq(a){return a>.2068965?Math.pow(a,3):108/841*(a-4/29)}function er(a){return a>10.314724?Math.pow((a+14.025)/269.025,2.4):a/3294.6}function es(a){return a>.0088564?Math.pow(a,1/3):a/(108/841)+4/29}function et(a){let b=er(a[0]),c=er(a[1]),d=er(a[2]),e=es(.222488403*b+.716873169*c+.06060791*d),f=500*(es(.452247074*b+.399439023*c+.148375274*d)-e),g=200*(e-es(.016863605*b+.117638439*c+.865350722*d)),h=180/Math.PI*Math.atan2(g,f);return[116*e-16,Math.sqrt(f*f+g*g),h<0?h+360:h,a[3]]}function eu(a){if("none"===a)return eg;if(en.hasOwnProperty(a))return en[a];if(eo>=1024){let a=0;for(let b in en)(3&a++)==0&&(delete en[b],--eo)}let b=function a(b){if(b.toLowerCase().startsWith("rgb")){let a=b.match(ei)||b.match(eh)||b.match(ej);if(a){let b=a[4],c=100/255;return[av(el(a[1],c)+.5|0,0,255),av(el(a[2],c)+.5|0,0,255),av(el(a[3],c)+.5|0,0,255),void 0!==b?av(el(b,100),0,1):1]}em(b)}if(b.startsWith("#")){if(ek.test(b)){let a=b.substring(1),c=a.length<=4?1:2,d=[0,0,0,255];for(let b=0,e=a.length;b<e;b+=c){let e=parseInt(a.substring(b,b+c),16);1===c&&(e+=e<<4),d[b/c]=e}return d[3]=d[3]/255,d}em(b)}let d=(c||(c=c2(1,1,void 0,{willReadFrequently:!0,desynchronized:!0})),c);d.fillStyle="#abcdef";let e=d.fillStyle;d.fillStyle=b,d.fillStyle===e&&(d.fillStyle="#fedcba",e=d.fillStyle,d.fillStyle=b,d.fillStyle===e&&em(b));let f=d.fillStyle;if(f.startsWith("#")||f.startsWith("rgba"))return a(f);d.clearRect(0,0,1,1),d.fillRect(0,0,1,1);let g=Array.from(d.getImageData(0,0,1,1).data);return g[3]=aA(g[3]/255,3),g}(a);for(let c of(4!==b.length&&em(a),b))isNaN(c)&&em(a);return en[a]=b,++eo,b}function ev(a){return Array.isArray(a)?a:eu(a)}function ew(a){let b=a[0];b!=(0|b)&&(b=b+.5|0);let c=a[1];c!=(0|c)&&(c=c+.5|0);let d=a[2];return d!=(0|d)&&(d=d+.5|0),"rgba("+b+","+c+","+d+","+(void 0===a[3]?1:Math.round(1e3*a[3])/1e3)+")"}function ex(a){return a[0]>0&&a[1]>0}function ey(a,b){return Array.isArray(a)?a:(void 0===b?b=[a,a]:(b[0]=a,b[1]=a),b)}let ez=0,eA=1<<ez++,eB=1<<ez++,eC=1<<ez++,eD=1<<ez++,eE=1<<ez++,eF=1<<ez++,eG=Math.pow(2,ez)-1,eH={[eA]:"boolean",[eB]:"number",[eC]:"string",[eD]:"color",[eE]:"number[]",[eF]:"size"},eI=Object.keys(eH).map(Number).sort(A);function eJ(a){let b=[];for(let d of eI){var c;(a&(c=d))===c&&b.push(eH[d])}return 0===b.length?"untyped":b.length<3?b.join(" or "):b.slice(0,-1).join(", ")+", or "+b[b.length-1]}class eK{constructor(a,b){if(!(a in eH))throw Error(`literal expressions must have a specific type, got ${eJ(a)}`);this.type=a,this.value=b}}class eL{constructor(a,b,...c){this.type=a,this.operator=b,this.args=c}}function eM(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1,mapState:!1}}function eN(a,b,c){switch(typeof a){case"boolean":if(b===eC)return new eK(eC,a?"true":"false");if((b&eA)!==eA)throw Error(`got a boolean, but expected ${eJ(b)}`);return new eK(eA,a);case"number":if(b===eF)return new eK(eF,ey(a));if(b===eA)return new eK(eA,!!a);if(b===eC)return new eK(eC,a.toString());if((b&eB)!==eB)throw Error(`got a number, but expected ${eJ(b)}`);return new eK(eB,a);case"string":if(b===eD)return new eK(eD,eu(a));if(b===eA)return new eK(eA,!!a);if((b&eC)!==eC)throw Error(`got a string, but expected ${eJ(b)}`);return new eK(eC,a)}if(!Array.isArray(a))throw Error("expression must be an array or a primitive value");if(0===a.length)throw Error("empty expression");if("string"==typeof a[0]){var d=a,e=b,f=c;let g=d[0],h=e3[g];if(!h)throw Error(`unknown operator: ${g}`);return h(d,e,f)}for(let b of a)if("number"!=typeof b)throw Error("expected an array of numbers");if(b===eF){if(2!==a.length)throw Error(`expected an array of two values for a size, got ${a.length}`);return new eK(eF,a)}if(b===eD){if(3===a.length)return new eK(eD,[...a,1]);if(4===a.length)return new eK(eD,a);throw Error(`expected an array of 3 or 4 values for a color, got ${a.length}`)}if((b&eE)!==eE)throw Error(`got an array of numbers, but expected ${eJ(b)}`);return new eK(eE,a)}let eO="concat",eP="geometry-type",eQ="resolution",eR="clamp",eS="floor",eT="ceil",eU="round",eV="atan",eW="sqrt",eX="match",eY="between",eZ="interpolate",e$="coalesce",e_="case",e0="number",e1="string",e2="to-string",e3={get:fb(e7(1,1/0),e4),var:fb(e7(1,1),function(a,b,c){let d=a[1];if("string"!=typeof d)throw Error("expected a string argument for var operation");return c.variables.add(d),[new eK(eC,d)]}),has:fb(e7(1,1/0),e4),id:fb(function(a,b,c){c.featureId=!0},e6),[eO]:fb(e7(2,1/0),e9(eC)),[eP]:fb(function(a,b,c){c.geometryType=!0},e6),"line-metric":fb(e6),[eQ]:fb(e5,e6),zoom:fb(e5,e6),time:fb(e5,e6),any:fb(e7(2,1/0),e9(eA)),all:fb(e7(2,1/0),e9(eA)),"!":fb(e7(1,1),e9(eA)),"==":fb(e7(2,2),e9(eG)),"!=":fb(e7(2,2),e9(eG)),">":fb(e7(2,2),e9(eB)),">=":fb(e7(2,2),e9(eB)),"<":fb(e7(2,2),e9(eB)),"<=":fb(e7(2,2),e9(eB)),"*":fb(e7(2,1/0),e8),[e$]:fb(e7(2,1/0),e8),"/":fb(e7(2,2),e9(eB)),"+":fb(e7(2,1/0),e9(eB)),"-":fb(e7(2,2),e9(eB)),[eR]:fb(e7(3,3),e9(eB)),"%":fb(e7(2,2),e9(eB)),"^":fb(e7(2,2),e9(eB)),abs:fb(e7(1,1),e9(eB)),[eS]:fb(e7(1,1),e9(eB)),[eT]:fb(e7(1,1),e9(eB)),[eU]:fb(e7(1,1),e9(eB)),sin:fb(e7(1,1),e9(eB)),cos:fb(e7(1,1),e9(eB)),[eV]:fb(e7(1,2),e9(eB)),[eW]:fb(e7(1,1),e9(eB)),[eX]:fb(e7(4,1/0),fa,function(a,b,c){let d=a.length-1,e=eC|eB|eA,f=eN(a[1],e,c),g=eN(a[a.length-1],b,c),h=Array(d-2);for(let b=0;b<d-2;b+=2){try{let d=eN(a[b+2],f.type,c);h[b]=d}catch(a){throw Error(`failed to parse argument ${b+1} of match expression: ${a.message}`)}try{let d=eN(a[b+3],g.type,c);h[b+1]=d}catch(a){throw Error(`failed to parse argument ${b+2} of match expression: ${a.message}`)}}return[f,...h,g]}),[eY]:fb(e7(3,3),e9(eB)),[eZ]:fb(e7(6,1/0),fa,function(a,b,c){let d,e,f=a[1];switch(f[0]){case"linear":d=1;break;case"exponential":let g=f[1];if("number"!=typeof g||g<=0)throw Error(`expected a number base for exponential interpolation, got ${JSON.stringify(g)} instead`);d=g;break;default:throw Error(`invalid interpolation type: ${JSON.stringify(f)}`)}let h=new eK(eB,d);try{e=eN(a[2],eB,c)}catch(a){throw Error(`failed to parse argument 1 in interpolate expression: ${a.message}`)}let i=Array(a.length-3);for(let d=0;d<i.length;d+=2){try{let b=eN(a[d+3],eB,c);i[d]=b}catch(a){throw Error(`failed to parse argument ${d+2} for interpolate expression: ${a.message}`)}try{let e=eN(a[d+4],b,c);i[d+1]=e}catch(a){throw Error(`failed to parse argument ${d+3} for interpolate expression: ${a.message}`)}}return[h,e,...i]}),[e_]:fb(e7(3,1/0),function(a,b,c){let d=a[0],e=a.length-1;if(e%2==0)throw Error(`expected an odd number of arguments for ${d}, got ${e} instead`)},function(a,b,c){let d=eN(a[a.length-1],b,c),e=Array(a.length-1);for(let b=0;b<e.length-1;b+=2){try{let d=eN(a[b+1],eA,c);e[b]=d}catch(a){throw Error(`failed to parse argument ${b} of case expression: ${a.message}`)}try{let f=eN(a[b+2],d.type,c);e[b+1]=f}catch(a){throw Error(`failed to parse argument ${b+1} of case expression: ${a.message}`)}}return e[e.length-1]=d,e}),in:fb(e7(2,2),function(a,b,c){let d,e=a[2];if(!Array.isArray(e))throw Error('the second argument for the "in" operator must be an array');if("string"==typeof e[0]){if("literal"!==e[0])throw Error('for the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions');if(!Array.isArray(e[1]))throw Error('failed to parse "in" expression: the literal operator must be followed by an array');e=e[1],d=eC}else d=eB;let f=Array(e.length);for(let a=0;a<f.length;a++)try{let b=eN(e[a],d,c);f[a]=b}catch(b){throw Error(`failed to parse haystack item ${a} for "in" expression: ${b.message}`)}return[eN(a[1],d,c),...f]}),[e0]:fb(e7(1,1/0),e9(eG)),[e1]:fb(e7(1,1/0),e9(eG)),array:fb(e7(1,1/0),e9(eB)),color:fb(e7(1,4),e9(eB)),band:fb(e7(1,3),e9(eB)),palette:fb(e7(2,2),function(a,b,c){let d;try{d=eN(a[1],eB,c)}catch(a){throw Error(`failed to parse first argument in palette expression: ${a.message}`)}let e=a[2];if(!Array.isArray(e))throw Error("the second argument of palette must be an array");let f=Array(e.length);for(let a=0;a<f.length;a++){let b;try{b=eN(e[a],eD,c)}catch(b){throw Error(`failed to parse color at index ${a} in palette expression: ${b.message}`)}if(!(b instanceof eK))throw Error(`the palette color at index ${a} must be a literal value`);f[a]=b}return[d,...f]}),[e2]:fb(e7(1,1),e9(eA|eB|eC|eD))};function e4(a,b,c){let d=a.length-1,e=Array(d);for(let b=0;b<d;++b){let d=a[b+1];switch(typeof d){case"number":e[b]=new eK(eB,d);break;case"string":e[b]=new eK(eC,d);break;default:throw Error(`expected a string key or numeric array index for a get operation, got ${d}`)}0===b&&c.properties.add(String(d))}return e}function e5(a,b,c){c.mapState=!0}function e6(a,b,c){let d=a[0];if(1!==a.length)throw Error(`expected no arguments for ${d} operation`);return[]}function e7(a,b){return function(c,d,e){let f=c[0],g=c.length-1;if(a===b){if(g!==a)throw Error(`expected ${a} argument${1===a?"":"s"} for ${f}, got ${g}`)}else if(g<a||g>b){let c=b===1/0?`${a} or more`:`${a} to ${b}`;throw Error(`expected ${c} arguments for ${f}, got ${g}`)}}}function e8(a,b,c){let d=a.length-1,e=Array(d);for(let f=0;f<d;++f){let d=eN(a[f+1],b,c);e[f]=d}return e}function e9(a){return function(b,c,d){let e=b.length-1,f=Array(e);for(let c=0;c<e;++c){let e=eN(b[c+1],a,d);f[c]=e}return f}}function fa(a,b,c){let d=a[0],e=a.length-1;if(e%2==1)throw Error(`expected an even number of arguments for operation ${d}, got ${e} instead`)}function fb(...a){return function(b,c,d){let e,f=b[0];for(let f=0;f<a.length;f++){let g=a[f](b,c,d);if(f==a.length-1){if(!g)throw Error("expected last argument validator to return the parsed args");e=g}}return new eL(c,f,...e)}}function fc(){return{variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""}}function fd(a,b,c){return function a(b,c){if(b instanceof eK){if(b.type===eD&&"string"==typeof b.value){let a=eu(b.value);return function(){return a}}return function(){return b.value}}let d=b.operator;switch(d){case e0:case e1:case e$:var e=b,f=c;let g=e.operator,h=e.args.length,i=Array(h);for(let b=0;b<h;++b)i[b]=a(e.args[b],f);switch(g){case e$:return a=>{for(let b=0;b<h;++b){let c=i[b](a);if(null!=c)return c}throw Error("Expected one of the values to be non-null")};case e0:case e1:return a=>{for(let b=0;b<h;++b){let c=i[b](a);if(typeof c===g)return c}throw Error(`Expected one of the values to be a ${g}`)};default:throw Error(`Unsupported assertion operator ${g}`)}case"get":case"var":case"has":var j=b;let k=j.args[0].value;switch(j.operator){case"get":return a=>{let b=j.args,c=a.properties[k];for(let a=1,d=b.length;a<d;++a)c=c[b[a].value];return c};case"var":return a=>a.variables[k];case"has":return a=>{let b=j.args;if(!(k in a.properties))return!1;let c=a.properties[k];for(let a=1,d=b.length;a<d;++a){let d=b[a].value;if(!c||!Object.hasOwn(c,d))return!1;c=c[d]}return!0};default:throw Error(`Unsupported accessor operator ${j.operator}`)}case"id":return a=>a.featureId;case eP:return a=>a.geometryType;case eO:{let d=b.args.map(b=>a(b,c));return a=>"".concat(...d.map(b=>b(a).toString()))}case eQ:return a=>a.resolution;case"any":case"all":case eY:case"in":case"!":var l=b,m=c;let n=l.operator,o=l.args.length,p=Array(o);for(let b=0;b<o;++b)p[b]=a(l.args[b],m);switch(n){case"any":return a=>{for(let b=0;b<o;++b)if(p[b](a))return!0;return!1};case"all":return a=>{for(let b=0;b<o;++b)if(!p[b](a))return!1;return!0};case eY:return a=>{let b=p[0](a),c=p[1](a),d=p[2](a);return b>=c&&b<=d};case"in":return a=>{let b=p[0](a);for(let c=1;c<o;++c)if(b===p[c](a))return!0;return!1};case"!":return a=>!p[0](a);default:throw Error(`Unsupported logical operator ${n}`)}case"==":case"!=":case"<":case"<=":case">":case">=":var q=b,r=c;let s=q.operator,t=a(q.args[0],r),u=a(q.args[1],r);switch(s){case"==":return a=>t(a)===u(a);case"!=":return a=>t(a)!==u(a);case"<":return a=>t(a)<u(a);case"<=":return a=>t(a)<=u(a);case">":return a=>t(a)>u(a);case">=":return a=>t(a)>=u(a);default:throw Error(`Unsupported comparison operator ${s}`)}case"*":case"/":case"+":case"-":case eR:case"%":case"^":case"abs":case eS:case eT:case eU:case"sin":case"cos":case eV:case eW:var v=b,w=c;let x=v.operator,y=v.args.length,z=Array(y);for(let b=0;b<y;++b)z[b]=a(v.args[b],w);switch(x){case"*":return a=>{let b=1;for(let c=0;c<y;++c)b*=z[c](a);return b};case"/":return a=>z[0](a)/z[1](a);case"+":return a=>{let b=0;for(let c=0;c<y;++c)b+=z[c](a);return b};case"-":return a=>z[0](a)-z[1](a);case eR:return a=>{let b=z[0](a),c=z[1](a);if(b<c)return c;let d=z[2](a);return b>d?d:b};case"%":return a=>z[0](a)%z[1](a);case"^":return a=>Math.pow(z[0](a),z[1](a));case"abs":return a=>Math.abs(z[0](a));case eS:return a=>Math.floor(z[0](a));case eT:return a=>Math.ceil(z[0](a));case eU:return a=>Math.round(z[0](a));case"sin":return a=>Math.sin(z[0](a));case"cos":return a=>Math.cos(z[0](a));case eV:if(2===y)return a=>Math.atan2(z[0](a),z[1](a));return a=>Math.atan(z[0](a));case eW:return a=>Math.sqrt(z[0](a));default:throw Error(`Unsupported numeric operator ${x}`)}case e_:var A=b,B=c;let C=A.args.length,D=Array(C);for(let b=0;b<C;++b)D[b]=a(A.args[b],B);return a=>{for(let b=0;b<C-1;b+=2)if(D[b](a))return D[b+1](a);return D[C-1](a)};case eX:var E=b,F=c;let G=E.args.length,H=Array(G);for(let b=0;b<G;++b)H[b]=a(E.args[b],F);return a=>{let b=H[0](a);for(let c=1;c<G-1;c+=2)if(b===H[c](a))return H[c+1](a);return H[G-1](a)};case eZ:var I=b,J=c;let K=I.args.length,L=Array(K);for(let b=0;b<K;++b)L[b]=a(I.args[b],J);return a=>{let b,c,d=L[0](a),e=L[1](a);for(let f=2;f<K;f+=2){let g=L[f](a),h=L[f+1](a),i=Array.isArray(h);if(i&&(h=function(a){if(4===a.length)return a;let b=a.slice();return b[3]=1,b}(h)),g>=e){if(2===f)return h;if(i)return function(a,b,c,d,e,f){var g;let h,i,j,k,l,m,n,o,p;if(0==e-c)return d;let q=et(d),r=et(f),s=r[2]-q[2];return s>180?s-=360:s<-180&&(s+=360),h=((g=[fe(a,b,c,q[0],e,r[0]),fe(a,b,c,q[1],e,r[1]),q[2]+fe(a,b,c,0,e,s),fe(a,b,c,d[3],e,f[3])])[0]+16)/116,i=g[1],j=g[2]*Math.PI/180,k=eq(h),l=eq(h+i/500*Math.cos(j)),n=ep(3.021973625*l-1.617392459*k-.404875592*(m=eq(h-i/200*Math.sin(j)))),o=ep(-.943766287*l+1.916279586*k+.027607165*m),p=ep(.069407491*l-.22898585*k+1.159737864*m),[av(n+.5|0,0,255),av(o+.5|0,0,255),av(p+.5|0,0,255),g[3]]}(d,e,b,c,g,h);return fe(d,e,b,c,g,h)}b=g,c=h}return c};case e2:var M=b,N=c;let O=M.operator,P=M.args.length,Q=Array(P);for(let b=0;b<P;++b)Q[b]=a(M.args[b],N);if(O===e2)return a=>{let b=Q[0](a);return M.args[0].type===eD?ew(b):b.toString()};throw Error(`Unsupported convert operator ${O}`);default:throw Error(`Unsupported operator ${d}`)}}(eN(a,b,c),c)}function fe(a,b,c,d,e,f){let g=e-c;if(0===g)return d;let h=b-c;return d+(1===a?h/g:(Math.pow(a,h)-1)/(Math.pow(a,g)-1))*(f-d)}function ff(a,b,c){return b+":"+a+":"+(c?ev(c):"null")}let fg=new class{constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=1024}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let a=0;for(let b in this.cache_){let c=this.cache_[b];(3&a++)==0&&!c.hasListener()&&(delete this.cache_[b],delete this.patternCache_[b],--this.cacheSize_)}}}get(a,b,c){let d=ff(a,b,c);return d in this.cache_?this.cache_[d]:null}getPattern(a,b,c){let d=ff(a,b,c);return d in this.patternCache_?this.patternCache_[d]:null}set(a,b,c,d,e){let f=ff(a,b,c),g=f in this.cache_;this.cache_[f]=d,e&&(0===d.getImageState()&&d.load(),1===d.getImageState()?d.ready().then(()=>{this.patternCache_[f]=c3().createPattern(d.getImage(1),"repeat")}):this.patternCache_[f]=c3().createPattern(d.getImage(1),"repeat")),!g&&++this.cacheSize_}setSize(a){this.maxCacheSize_=a,this.expire()}},fh=null;class fi extends M{constructor(a,b,c,d,e){super(),this.hitDetectionImage_=null,this.image_=a,this.crossOrigin_=c,this.canvas_={},this.color_=e,this.imageState_=void 0===d?0:d,this.size_=a&&a.width&&a.height?[a.width,a.height]:null,this.src_=b,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(void 0===this.tainted_&&2===this.imageState_){fh||(fh=c2(1,1,void 0,{willReadFrequently:!0})),fh.drawImage(this.image_,0,0);try{fh.getImageData(0,0,1,1),this.tainted_=!1}catch{fh=null,this.tainted_=!0}}return!0===this.tainted_}dispatchChangeEvent_(){this.dispatchEvent(s)}handleImageError_(){this.imageState_=3,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=2,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(a){return this.image_||this.initializeImage_(),this.replaceColor_(a),this.canvas_[a]?this.canvas_[a]:this.image_}getPixelRatio(a){return this.replaceColor_(a),this.canvas_[a]?a:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){let a=this.size_[0],b=this.size_[1],c=c2(a,b);c.fillRect(0,0,a,b),this.hitDetectionImage_=c.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(0===this.imageState_){var a,b;this.image_||this.initializeImage_(),this.imageState_=1;try{void 0!==this.src_&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&(a=this.image_,(b=this.src_)&&(a.src=b),a.src&&af?new Promise((b,c)=>a.decode().then(()=>b(a)).catch(d=>a.complete&&a.width?b(a):c(d))):new Promise((b,c)=>{function d(){f(),b(a)}function e(){f(),c(Error("Image load error"))}function f(){a.removeEventListener("load",d),a.removeEventListener("error",e)}a.addEventListener("load",d),a.addEventListener("error",e)})).then(a=>{this.image_=a,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(a){var b;if(!this.color_||this.canvas_[a]||2!==this.imageState_)return;let c=this.image_,d=c2(Math.ceil(c.width*a),Math.ceil(c.height*a)),e=d.canvas;d.scale(a,a),d.drawImage(c,0,0),d.globalCompositeOperation="multiply",d.fillStyle="string"==typeof(b=this.color_)?b:ew(b),d.fillRect(0,0,e.width/a,e.height/a),d.globalCompositeOperation="destination-in",d.drawImage(c,0,0),this.canvas_[a]=e}ready(){return this.ready_||(this.ready_=new Promise(a=>{if(2===this.imageState_||3===this.imageState_)a();else{let b=()=>{(2===this.imageState_||3===this.imageState_)&&(this.removeEventListener(s,b),a())};this.addEventListener(s,b)}})),this.ready_}}function fj(a,b,c,d,e,f){let g=void 0===b?void 0:fg.get(b,c,e);return g||(g=new fi(a,a&&"src"in a?a.src||void 0:b,c,d,e),fg.set(b,c,e,g,f)),f&&g&&!fg.getPattern(b,c,e)&&fg.set(b,c,e,g,f),g}function fk(a){return a?Array.isArray(a)?ew(a):"object"==typeof a&&"src"in a?function(a){if(!a.offset||!a.size)return fg.getPattern(a.src,"anonymous",a.color);let b=a.src+":"+a.offset,c=fg.getPattern(b,void 0,a.color);if(c)return c;let d=fg.get(a.src,"anonymous",null);if(2!==d.getImageState())return null;let e=c2(a.size[0],a.size[1]);return e.drawImage(d.getImage(1),a.offset[0],a.offset[1],a.size[0],a.size[1],0,0,a.size[0],a.size[1]),fj(e.canvas,b,void 0,2,a.color,!0),fg.getPattern(b,void 0,a.color)}(a):a:null}let fl="10px sans-serif",fm="#000",fn="round",fo=[],fp="round",fq="#000",fr="center",fs="middle",ft=[0,0,0,0],fu=new V,fv=null,fw={},fx=new Set(["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","emoji","math","fangsong"]),fy=function(){let a,b;async function c(a){await b.ready;let c=await b.load(a);if(0===c.length)return!1;let d=c1(a),e=d.families[0].toLowerCase(),f=d.weight;return c.some(a=>{let b=a.family.replace(/^['"]|['"]$/g,"").toLowerCase(),c=c0[a.weight]||a.weight;return b===e&&a.style===d.style&&c==f})}async function d(){await b.ready;let e=!0,f=fu.getProperties(),g=Object.keys(f).filter(a=>f[a]<100);for(let a=g.length-1;a>=0;--a){let b=g[a],d=f[b];d<100&&(await c(b)?(J(fw),fu.set(b,100)):(d+=10,fu.set(b,d,!0),d<100&&(e=!1)))}a=void 0,e||(a=setTimeout(d,100))}return async function(c){b||(b=ae?self.fonts:document.fonts);let e=c1(c);if(!e)return;let f=e.families,g=!1;for(let a of f){var h,i;if(fx.has(a))continue;let b=(h=e.style,i=e.weight,`${h} ${i} 16px "${a}"`);void 0===fu.get(b)&&(fu.set(b,0,!0),g=!0)}g&&(clearTimeout(a),a=setTimeout(d,100))}}(),fz=function(a){let b=fw[a];if(void 0==b){if(ae){let c=c1(a),d=fA(a,"g");b=(isNaN(Number(c.lineHeight))?1.2:Number(c.lineHeight))*(d.actualBoundingBoxAscent+d.actualBoundingBoxDescent)}else f||((f=document.createElement("div")).innerHTML="M",f.style.minHeight="0",f.style.maxHeight="none",f.style.height="auto",f.style.padding="0",f.style.border="none",f.style.position="absolute",f.style.display="block",f.style.left="-99999px"),f.style.font=a,document.body.appendChild(f),b=f.offsetHeight,document.body.removeChild(f);fw[a]=b}return b};function fA(a,b){return fv||(fv=c2(1,1)),a!=d&&(fv.font=a,d=fv.font),fv.measureText(b)}function fB(a,b,c){if(b in c)return c[b];let d=b.split("\n").reduce((b,c)=>Math.max(b,fA(a,c).width),0);return c[b]=d,d}class fC{constructor(a){this.opacity_=a.opacity,this.rotateWithView_=a.rotateWithView,this.rotation_=a.rotation,this.scale_=a.scale,this.scaleArray_=ey(a.scale),this.displacement_=a.displacement,this.declutterMode_=a.declutterMode}clone(){let a=this.getScale();return new fC({opacity:this.getOpacity(),scale:Array.isArray(a)?a.slice():a,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return R()}getImage(a){return R()}getHitDetectionImage(){return R()}getPixelRatio(a){return 1}getImageState(){return R()}getImageSize(){return R()}getOrigin(){return R()}getSize(){return R()}setDisplacement(a){this.displacement_=a}setOpacity(a){this.opacity_=a}setRotateWithView(a){this.rotateWithView_=a}setRotation(a){this.rotation_=a}setScale(a){this.scale_=a,this.scaleArray_=ey(a)}listenImageChange(a){R()}load(){R()}unlistenImageChange(a){R()}ready(){return Promise.resolve()}}let fD=fC;class fE extends fD{constructor(a){super({opacity:1,rotateWithView:void 0!==a.rotateWithView&&a.rotateWithView,rotation:void 0!==a.rotation?a.rotation:0,scale:void 0!==a.scale?a.scale:1,displacement:void 0!==a.displacement?a.displacement:[0,0],declutterMode:a.declutterMode}),this.hitDetectionCanvas_=null,this.fill_=void 0!==a.fill?a.fill:null,this.origin_=[0,0],this.points_=a.points,this.radius=a.radius,this.radius2_=a.radius2,this.angle_=void 0!==a.angle?a.angle:0,this.stroke_=void 0!==a.stroke?a.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?1:2,1===this.imageState_&&this.ready().then(()=>this.imageState_=2),this.render()}clone(){let a=this.getScale(),b=new fE({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(a)?a.slice():a,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return b.setOpacity(this.getOpacity()),b}getAnchor(){let a=this.size_,b=this.getDisplacement(),c=this.getScaleArray();return[a[0]/2-b[0]/c[0],a[1]/2+b[1]/c[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(a){this.fill_=a,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(a){let b=this.fill_?.getKey(),c=`${a},${this.angle_},${this.radius},${this.radius2_},${this.points_},${b}`+Object.values(this.renderOptions_).join(","),d=fg.get(c,null,null)?.getImage(1);if(!d){let b=this.renderOptions_,e=Math.ceil(b.size*a),f=c2(e,e);this.draw_(b,f,a),d=f.canvas,fg.set(c,null,null,new fi(d,void 0,null,2,null))}return d}getPixelRatio(a){return a}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(a){this.stroke_=a,this.render()}listenImageChange(a){}load(){}unlistenImageChange(a){}calculateLineJoinSize_(a,b,c){if(0===b||this.points_===1/0||"bevel"!==a&&"miter"!==a)return b;let d=this.radius,e=void 0===this.radius2_?d:this.radius2_;if(d<e){let a=d;d=e,e=a}let f=2*Math.PI/(void 0===this.radius2_?this.points_:2*this.points_),g=e*Math.sin(f),h=d-Math.sqrt(e*e-g*g),i=Math.sqrt(g*g+h*h),j=i/g;if("miter"===a&&j<=c)return j*b;let k=b/2/j,l=b/2*(h/i),m=Math.sqrt((d+k)*(d+k)+l*l)-d;if(void 0===this.radius2_||"bevel"===a)return 2*m;let n=d*Math.sin(f),o=e-Math.sqrt(d*d-n*n),p=Math.sqrt(n*n+o*o)/n;return p<=c?2*Math.max(m,p*b/2-e-d):2*m}createRenderOptions(){let a,b=fn,c=fp,d=0,e=null,f=0,g=0;this.stroke_&&(a=fk(this.stroke_.getColor()??fq),g=this.stroke_.getWidth()??1,e=this.stroke_.getLineDash(),f=this.stroke_.getLineDashOffset()??0,c=this.stroke_.getLineJoin()??fp,b=this.stroke_.getLineCap()??fn,d=this.stroke_.getMiterLimit()??10);let h=this.calculateLineJoinSize_(c,g,d);return{strokeStyle:a,strokeWidth:g,size:Math.ceil(2*Math.max(this.radius,this.radius2_||0)+h),lineCap:b,lineDash:e,lineDashOffset:f,lineJoin:c,miterLimit:d}}render(){this.renderOptions_=this.createRenderOptions();let a=this.renderOptions_.size;this.hitDetectionCanvas_=null,this.size_=[a,a]}draw_(a,b,c){if(b.scale(c,c),b.translate(a.size/2,a.size/2),this.createPath_(b),this.fill_){let a=this.fill_.getColor();null===a&&(a=fm),b.fillStyle=fk(a),b.fill()}a.strokeStyle&&(b.strokeStyle=a.strokeStyle,b.lineWidth=a.strokeWidth,a.lineDash&&(b.setLineDash(a.lineDash),b.lineDashOffset=a.lineDashOffset),b.lineCap=a.lineCap,b.lineJoin=a.lineJoin,b.miterLimit=a.miterLimit,b.stroke())}createHitDetectionCanvas_(a){let b;if(this.fill_){let c=this.fill_.getColor(),d=0;"string"==typeof c&&(c=ev(c)),null===c?d=1:Array.isArray(c)&&(d=4===c.length?c[3]:1),0===d&&(b=c2(a.size,a.size),this.drawHitDetectionCanvas_(a,b))}return b?b.canvas:this.getImage(1)}createPath_(a){let b=this.points_,c=this.radius;if(b===1/0)a.arc(0,0,c,0,2*Math.PI);else{let d=void 0===this.radius2_?c:this.radius2_;void 0!==this.radius2_&&(b*=2);let e=this.angle_-Math.PI/2,f=2*Math.PI/b;for(let g=0;g<b;g++){let b=e+g*f,h=g%2==0?c:d;a.lineTo(h*Math.cos(b),h*Math.sin(b))}a.closePath()}}drawHitDetectionCanvas_(a,b){b.translate(a.size/2,a.size/2),this.createPath_(b),b.fillStyle=fm,b.fill(),a.strokeStyle&&(b.strokeStyle=a.strokeStyle,b.lineWidth=a.strokeWidth,a.lineDash&&(b.setLineDash(a.lineDash),b.lineDashOffset=a.lineDashOffset),b.lineJoin=a.lineJoin,b.miterLimit=a.miterLimit,b.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}}let fF=fE;class fG extends fF{constructor(a){super({points:1/0,fill:(a=a||{radius:5}).fill,radius:a.radius,stroke:a.stroke,scale:void 0!==a.scale?a.scale:1,rotation:void 0!==a.rotation?a.rotation:0,rotateWithView:void 0!==a.rotateWithView&&a.rotateWithView,displacement:void 0!==a.displacement?a.displacement:[0,0],declutterMode:a.declutterMode})}clone(){let a=this.getScale(),b=new fG({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(a)?a.slice():a,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return b.setOpacity(this.getOpacity()),b}setRadius(a){this.radius=a,this.render()}}class fH{constructor(a){a=a||{},this.patternImage_=null,this.color_=null,void 0!==a.color&&this.setColor(a.color)}clone(){let a=this.getColor();return new fH({color:Array.isArray(a)?a.slice():a||void 0})}getColor(){return this.color_}setColor(a){if(null!==a&&"object"==typeof a&&"src"in a){let b=fj(null,a.src,"anonymous",void 0,a.offset?null:a.color?a.color:null,!(a.offset&&a.size));b.ready().then(()=>{this.patternImage_=null}),0===b.getImageState()&&b.load(),1===b.getImageState()&&(this.patternImage_=b)}this.color_=a}getKey(){let a=this.getColor();return a?a instanceof CanvasPattern||a instanceof CanvasGradient?T(a):"object"==typeof a&&"src"in a?a.src+":"+a.offset:ev(a).toString():""}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}function fI(a,b,c,d){return void 0!==c&&void 0!==d?[c/a,d/b]:void 0!==c?c/a:void 0!==d?d/b:1}class fJ extends fD{constructor(a){let b;const c=void 0!==(a=a||{}).opacity?a.opacity:1,d=void 0!==a.rotation?a.rotation:0,e=void 0!==a.scale?a.scale:1,f=void 0!==a.rotateWithView&&a.rotateWithView;super({opacity:c,rotation:d,scale:e,displacement:void 0!==a.displacement?a.displacement:[0,0],rotateWithView:f,declutterMode:a.declutterMode}),this.anchor_=void 0!==a.anchor?a.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=void 0!==a.anchorOrigin?a.anchorOrigin:"top-left",this.anchorXUnits_=void 0!==a.anchorXUnits?a.anchorXUnits:"fraction",this.anchorYUnits_=void 0!==a.anchorYUnits?a.anchorYUnits:"fraction",this.crossOrigin_=void 0!==a.crossOrigin?a.crossOrigin:null;const g=void 0!==a.img?a.img:null;let h=a.src;if(aq(!(void 0!==h&&g),"`image` and `src` cannot be provided at the same time"),(void 0===h||0===h.length)&&g&&(h=g.src||T(g)),aq(void 0!==h&&h.length>0,"A defined and non-empty `src` or `image` must be provided"),aq(void 0===a.width&&void 0===a.height||void 0===a.scale,"`width` or `height` cannot be provided together with `scale`"),void 0!==a.src?b=0:void 0!==g&&(b="complete"in g?g.complete?2*!!g.src:1:2),this.color_=void 0!==a.color?ev(a.color):null,this.iconImage_=fj(g,h,this.crossOrigin_,b,this.color_),this.offset_=void 0!==a.offset?a.offset:[0,0],this.offsetOrigin_=void 0!==a.offsetOrigin?a.offsetOrigin:"top-left",this.origin_=null,this.size_=void 0!==a.size?a.size:null,this.initialOptions_,void 0!==a.width||void 0!==a.height){let b,c;if(a.size)[b,c]=a.size;else{const d=this.getImage(1);if(d.width&&d.height)b=d.width,c=d.height;else if(d instanceof HTMLImageElement){this.initialOptions_=a;const b=()=>{if(this.unlistenImageChange(b),!this.initialOptions_)return;let c=this.iconImage_.getSize();this.setScale(fI(c[0],c[1],a.width,a.height))};this.listenImageChange(b);return}}void 0!==b&&this.setScale(fI(b,c,a.width,a.height))}}clone(){let a,b,c;return this.initialOptions_?(b=this.initialOptions_.width,c=this.initialOptions_.height):a=Array.isArray(a=this.getScale())?a.slice():a,new fJ({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:a,width:b,height:c,size:null!==this.size_?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let a=this.normalizedAnchor_;if(!a){a=this.anchor_;let b=this.getSize();if("fraction"==this.anchorXUnits_||"fraction"==this.anchorYUnits_){if(!b)return null;a=this.anchor_.slice(),"fraction"==this.anchorXUnits_&&(a[0]*=b[0]),"fraction"==this.anchorYUnits_&&(a[1]*=b[1])}if("top-left"!=this.anchorOrigin_){if(!b)return null;a===this.anchor_&&(a=this.anchor_.slice()),("top-right"==this.anchorOrigin_||"bottom-right"==this.anchorOrigin_)&&(a[0]=-a[0]+b[0]),("bottom-left"==this.anchorOrigin_||"bottom-right"==this.anchorOrigin_)&&(a[1]=-a[1]+b[1])}this.normalizedAnchor_=a}let b=this.getDisplacement(),c=this.getScaleArray();return[a[0]-b[0]/c[0],a[1]+b[1]/c[1]]}setAnchor(a){this.anchor_=a,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(a){return this.iconImage_.getImage(a)}getPixelRatio(a){return this.iconImage_.getPixelRatio(a)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let a=this.offset_;if("top-left"!=this.offsetOrigin_){let b=this.getSize(),c=this.iconImage_.getSize();if(!b||!c)return null;a=a.slice(),("top-right"==this.offsetOrigin_||"bottom-right"==this.offsetOrigin_)&&(a[0]=c[0]-b[0]-a[0]),("bottom-left"==this.offsetOrigin_||"bottom-right"==this.offsetOrigin_)&&(a[1]=c[1]-b[1]-a[1])}return this.origin_=a,this.origin_}getSrc(){return this.iconImage_.getSrc()}setSrc(a){this.iconImage_=fj(null,a,this.crossOrigin_,0,this.color_)}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){let a=this.getScaleArray();return this.size_?this.size_[0]*a[0]:2==this.iconImage_.getImageState()?this.iconImage_.getSize()[0]*a[0]:void 0}getHeight(){let a=this.getScaleArray();return this.size_?this.size_[1]*a[1]:2==this.iconImage_.getImageState()?this.iconImage_.getSize()[1]*a[1]:void 0}setScale(a){delete this.initialOptions_,super.setScale(a)}listenImageChange(a){this.iconImage_.addEventListener(s,a)}load(){this.iconImage_.load()}unlistenImageChange(a){this.iconImage_.removeEventListener(s,a)}ready(){return this.iconImage_.ready()}}class fK{constructor(a){a=a||{},this.color_=void 0!==a.color?a.color:null,this.lineCap_=a.lineCap,this.lineDash_=void 0!==a.lineDash?a.lineDash:null,this.lineDashOffset_=a.lineDashOffset,this.lineJoin_=a.lineJoin,this.miterLimit_=a.miterLimit,this.width_=a.width}clone(){let a=this.getColor();return new fK({color:Array.isArray(a)?a.slice():a||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(a){this.color_=a}setLineCap(a){this.lineCap_=a}setLineDash(a){this.lineDash_=a}setLineDashOffset(a){this.lineDashOffset_=a}setLineJoin(a){this.lineJoin_=a}setMiterLimit(a){this.miterLimit_=a}setWidth(a){this.width_=a}}class fL{constructor(a){a=a||{},this.geometry_=null,this.geometryFunction_=fO,void 0!==a.geometry&&this.setGeometry(a.geometry),this.fill_=void 0!==a.fill?a.fill:null,this.image_=void 0!==a.image?a.image:null,this.renderer_=void 0!==a.renderer?a.renderer:null,this.hitDetectionRenderer_=void 0!==a.hitDetectionRenderer?a.hitDetectionRenderer:null,this.stroke_=void 0!==a.stroke?a.stroke:null,this.text_=void 0!==a.text?a.text:null,this.zIndex_=a.zIndex}clone(){let a=this.getGeometry();return a&&"object"==typeof a&&(a=a.clone()),new fL({geometry:a??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(a){this.renderer_=a}setHitDetectionRenderer(a){this.hitDetectionRenderer_=a}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(a){this.fill_=a}getImage(){return this.image_}setImage(a){this.image_=a}getStroke(){return this.stroke_}setStroke(a){this.stroke_=a}getText(){return this.text_}setText(a){this.text_=a}getZIndex(){return this.zIndex_}setGeometry(a){"function"==typeof a?this.geometryFunction_=a:"string"==typeof a?this.geometryFunction_=function(b){return b.get(a)}:a?void 0!==a&&(this.geometryFunction_=function(){return a}):this.geometryFunction_=fO,this.geometry_=a}setZIndex(a){this.zIndex_=a}}let fM=null;function fN(a,b){if(!fM){let a=new fH({color:"rgba(255,255,255,0.4)"}),b=new fK({color:"#3399CC",width:1.25});fM=[new fL({image:new fG({fill:a,stroke:b,radius:5}),fill:a,stroke:b})]}return fM}function fO(a){return a.getGeometry()}class fP{constructor(a){a=a||{},this.font_=a.font,this.rotation_=a.rotation,this.rotateWithView_=a.rotateWithView,this.keepUpright_=a.keepUpright,this.scale_=a.scale,this.scaleArray_=ey(void 0!==a.scale?a.scale:1),this.text_=a.text,this.textAlign_=a.textAlign,this.justify_=a.justify,this.repeat_=a.repeat,this.textBaseline_=a.textBaseline,this.fill_=void 0!==a.fill?a.fill:new fH({color:"#333"}),this.maxAngle_=void 0!==a.maxAngle?a.maxAngle:Math.PI/4,this.placement_=void 0!==a.placement?a.placement:"point",this.overflow_=!!a.overflow,this.stroke_=void 0!==a.stroke?a.stroke:null,this.offsetX_=void 0!==a.offsetX?a.offsetX:0,this.offsetY_=void 0!==a.offsetY?a.offsetY:0,this.backgroundFill_=a.backgroundFill?a.backgroundFill:null,this.backgroundStroke_=a.backgroundStroke?a.backgroundStroke:null,this.padding_=void 0===a.padding?null:a.padding,this.declutterMode_=a.declutterMode}clone(){let a=this.getScale();return new fP({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),keepUpright:this.getKeepUpright(),scale:Array.isArray(a)?a.slice():a,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()instanceof fH?this.getFill().clone():this.getFill(),stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getKeepUpright(){return this.keepUpright_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(a){this.overflow_=a}setFont(a){this.font_=a}setMaxAngle(a){this.maxAngle_=a}setOffsetX(a){this.offsetX_=a}setOffsetY(a){this.offsetY_=a}setPlacement(a){this.placement_=a}setRepeat(a){this.repeat_=a}setRotateWithView(a){this.rotateWithView_=a}setKeepUpright(a){this.keepUpright_=a}setFill(a){this.fill_=a}setRotation(a){this.rotation_=a}setScale(a){this.scale_=a,this.scaleArray_=ey(void 0!==a?a:1)}setStroke(a){this.stroke_=a}setText(a){this.text_=a}setTextAlign(a){this.textAlign_=a}setJustify(a){this.justify_=a}setTextBaseline(a){this.textBaseline_=a}setBackgroundFill(a){this.backgroundFill_=a}setBackgroundStroke(a){this.backgroundStroke_=a}setPadding(a){this.padding_=a}}function fQ(a){return!0}function fR(a){let b=eM(),c=a.length,d=Array(c);for(let e=0;e<c;++e)d[e]=fS(a[e],b);let e=fc(),f=Array(c);return function(a,g){if(e.properties=a.getPropertiesInternal(),e.resolution=g,b.featureId){let b=a.getId();void 0!==b?e.featureId=b:e.featureId=null}let h=0;for(let a=0;a<c;++a){let b=d[a](e);b&&(f[h]=b,h+=1)}return f.length=h,f}}function fS(a,b){var c,d,e,f,g,h,i,j;let k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y=fT(a,"",b),Z=fU(a,"",b),$=function(a,b){let c="text-",d=fW(a,c+"value",b);if(!d)return null;let e=fT(a,c,b),f=fT(a,c+"background-",b),g=fU(a,c,b),h=fU(a,c+"background-",b),i=fW(a,c+"font",b),j=fV(a,c+"max-angle",b),k=fV(a,c+"offset-x",b),l=fV(a,c+"offset-y",b),m=fX(a,c+"overflow",b),n=fW(a,c+"placement",b),o=fV(a,c+"repeat",b),p=f0(a,c+"scale",b),q=fX(a,c+"rotate-with-view",b),r=fV(a,c+"rotation",b),s=fW(a,c+"align",b),t=fW(a,c+"justify",b),u=fW(a,c+"baseline",b),v=fX(a,c+"keep-upright",b),w=fZ(a,c+"padding",b),x=new fP({declutterMode:f4(a,c+"declutter-mode")});return function(a){if(x.setText(d(a)),e&&x.setFill(e(a)),f&&x.setBackgroundFill(f(a)),g&&x.setStroke(g(a)),h&&x.setBackgroundStroke(h(a)),i&&x.setFont(i(a)),j&&x.setMaxAngle(j(a)),k&&x.setOffsetX(k(a)),l&&x.setOffsetY(l(a)),m&&x.setOverflow(m(a)),n){let b=n(a);if("point"!==b&&"line"!==b)throw Error("Expected point or line for text-placement");x.setPlacement(b)}if(o&&x.setRepeat(o(a)),p&&x.setScale(p(a)),q&&x.setRotateWithView(q(a)),r&&x.setRotation(r(a)),s){let b=s(a);if("left"!==b&&"center"!==b&&"right"!==b&&"end"!==b&&"start"!==b)throw Error("Expected left, right, center, start, or end for text-align");x.setTextAlign(b)}if(t){let b=t(a);if("left"!==b&&"right"!==b&&"center"!==b)throw Error("Expected left, right, or center for text-justify");x.setJustify(b)}if(u){let b=u(a);if("bottom"!==b&&"top"!==b&&"middle"!==b&&"alphabetic"!==b&&"hanging"!==b)throw Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");x.setTextBaseline(b)}return w&&x.setPadding(w(a)),v&&x.setKeepUpright(v(a)),x}}(a,b),_=(c=a,d=b,"icon-src"in c?(e=c,f=d,m=f6(e[l=(k="icon-")+"src"],l),n=f$(e,k+"anchor",f),o=f0(e,k+"scale",f),p=fV(e,k+"opacity",f),q=f$(e,k+"displacement",f),r=fV(e,k+"rotation",f),s=fX(e,k+"rotate-with-view",f),t=f2(e,k+"anchor-origin"),u=f3(e,k+"anchor-x-units"),v=f3(e,k+"anchor-y-units"),w=function(a,b){let c=a[b];if(void 0!==c)return f8(c,b)}(e,k+"color"),x=function(a,b){let c=a[b];if(void 0!==c){if("string"!=typeof c)throw Error(`Expected a string for ${b}`);return c}}(e,k+"cross-origin"),y=function(a,b){let c=a[b];if(void 0!==c)return f5(c,b)}(e,k+"offset"),z=f2(e,k+"offset-origin"),A=f1(e,k+"width"),B=new fJ({src:m,anchorOrigin:t,anchorXUnits:u,anchorYUnits:v,color:w,crossOrigin:x,offset:y,offsetOrigin:z,height:f1(e,k+"height"),width:A,size:function(a,b){let c=a[b];if(void 0!==c){if("number"==typeof c)return ey(c);if(!Array.isArray(c)||2!==c.length||"number"!=typeof c[0]||"number"!=typeof c[1])throw Error(`Expected a number or size array for ${b}`);return c}}(e,k+"size"),declutterMode:f4(e,k+"declutter-mode")}),function(a){return p&&B.setOpacity(p(a)),q&&B.setDisplacement(q(a)),r&&B.setRotation(r(a)),s&&B.setRotateWithView(s(a)),o&&B.setScale(o(a)),n&&B.setAnchor(n(a)),B}):"shape-points"in c?(g=c,h=d,D=(C="shape-")+"points",E=C+"radius",F=f7(g[D],D),G=f7(g[E],E),H=fT(g,C,h),I=fU(g,C,h),J=f0(g,C+"scale",h),L=f$(g,C+"displacement",h),M=fV(g,C+"rotation",h),N=fX(g,C+"rotate-with-view",h),O=new fF({points:F,radius:G,radius2:f1(g,C+"radius2"),angle:f1(g,C+"angle"),declutterMode:f4(g,C+"declutter-mode")}),function(a){return H&&O.setFill(H(a)),I&&O.setStroke(I(a)),L&&O.setDisplacement(L(a)),M&&O.setRotation(M(a)),N&&O.setRotateWithView(N(a)),J&&O.setScale(J(a)),O}):"circle-radius"in c?(Q=fT(i=c,P="circle-",j=d),R=fU(i,P,j),S=fV(i,P+"radius",j),T=f0(i,P+"scale",j),U=f$(i,P+"displacement",j),V=fV(i,P+"rotation",j),W=fX(i,P+"rotate-with-view",j),X=new fG({radius:5,declutterMode:f4(i,P+"declutter-mode")}),function(a){return S&&X.setRadius(S(a)),Q&&X.setFill(Q(a)),R&&X.setStroke(R(a)),U&&X.setDisplacement(U(a)),V&&X.setRotation(V(a)),W&&X.setRotateWithView(W(a)),T&&X.setScale(T(a)),X}):null),aa=fV(a,"z-index",b);if(!Y&&!Z&&!$&&!_&&!K(a))throw Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(a));let ab=new fL;return function(a){let b=!0;if(Y){let c=Y(a);c&&(b=!1),ab.setFill(c)}if(Z){let c=Z(a);c&&(b=!1),ab.setStroke(c)}if($){let c=$(a);c&&(b=!1),ab.setText(c)}if(_){let c=_(a);c&&(b=!1),ab.setImage(c)}return(aa&&ab.setZIndex(aa(a)),b)?null:ab}}function fT(a,b,c){let d;if(b+"fill-pattern-src"in a){var e,f,g;let h,i,j,k;h=fW(e=a,(f=b+"fill-")+"pattern-src",g=c),i=f_(e,f+"pattern-offset",g),j=f_(e,f+"pattern-size",g),k=fY(e,f+"color",g),d=function(a){return{src:h(a),offset:i&&i(a),size:j&&j(a),color:k&&k(a)}}}else{if("none"===a[b+"fill-color"])return a=>null;d=fY(a,b+"fill-color",c)}if(!d)return null;let h=new fH;return function(a){let b=d(a);return b===eg?null:(h.setColor(b),h)}}function fU(a,b,c){let d=fV(a,b+"stroke-width",c),e=fY(a,b+"stroke-color",c);if(!d&&!e)return null;let f=fW(a,b+"stroke-line-cap",c),g=fW(a,b+"stroke-line-join",c),h=fZ(a,b+"stroke-line-dash",c),i=fV(a,b+"stroke-line-dash-offset",c),j=fV(a,b+"stroke-miter-limit",c),k=new fK;return function(a){if(e){let b=e(a);if(b===eg)return null;k.setColor(b)}if(d&&k.setWidth(d(a)),f){let b=f(a);if("butt"!==b&&"round"!==b&&"square"!==b)throw Error("Expected butt, round, or square line cap");k.setLineCap(b)}if(g){let b=g(a);if("bevel"!==b&&"round"!==b&&"miter"!==b)throw Error("Expected bevel, round, or miter line join");k.setLineJoin(b)}return h&&k.setLineDash(h(a)),i&&k.setLineDashOffset(i(a)),j&&k.setMiterLimit(j(a)),k}}function fV(a,b,c){if(!(b in a))return;let d=fd(a[b],eB,c);return function(a){return f7(d(a),b)}}function fW(a,b,c){if(!(b in a))return null;let d=fd(a[b],eC,c);return function(a){return f6(d(a),b)}}function fX(a,b,c){if(!(b in a))return null;let d=fd(a[b],eA,c);return function(a){let c=d(a);if("boolean"!=typeof c)throw Error(`Expected a boolean for ${b}`);return c}}function fY(a,b,c){if(!(b in a))return null;let d=fd(a[b],eD,c);return function(a){return f8(d(a),b)}}function fZ(a,b,c){if(!(b in a))return null;let d=fd(a[b],eE,c);return function(a){return f5(d(a),b)}}function f$(a,b,c){if(!(b in a))return null;let d=fd(a[b],eE,c);return function(a){let c=f5(d(a),b);if(2!==c.length)throw Error(`Expected two numbers for ${b}`);return c}}function f_(a,b,c){if(!(b in a))return null;let d=fd(a[b],eE,c);return function(a){return f9(d(a),b)}}function f0(a,b,c){if(!(b in a))return null;let d=fd(a[b],eE|eB,c);return function(a){var c,e;return c=d(a),e=b,"number"==typeof c?c:f9(c,e)}}function f1(a,b){let c=a[b];if(void 0!==c){if("number"!=typeof c)throw Error(`Expected a number for ${b}`);return c}}function f2(a,b){let c=a[b];if(void 0!==c){if("bottom-left"!==c&&"bottom-right"!==c&&"top-left"!==c&&"top-right"!==c)throw Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${b}`);return c}}function f3(a,b){let c=a[b];if(void 0!==c){if("pixels"!==c&&"fraction"!==c)throw Error(`Expected pixels or fraction for ${b}`);return c}}function f4(a,b){let c=a[b];if(void 0!==c){if("string"!=typeof c)throw Error(`Expected a string for ${b}`);if("declutter"!==c&&"obstacle"!==c&&"none"!==c)throw Error(`Expected declutter, obstacle, or none for ${b}`);return c}}function f5(a,b){if(!Array.isArray(a))throw Error(`Expected an array for ${b}`);let c=a.length;for(let d=0;d<c;++d)if("number"!=typeof a[d])throw Error(`Expected an array of numbers for ${b}`);return a}function f6(a,b){if("string"!=typeof a)throw Error(`Expected a string for ${b}`);return a}function f7(a,b){if("number"!=typeof a)throw Error(`Expected a number for ${b}`);return a}function f8(a,b){if("string"==typeof a)return a;let c=f5(a,b),d=c.length;if(d<3||d>4)throw Error(`Expected a color with 3 or 4 values for ${b}`);return c}function f9(a,b){let c=f5(a,b);if(2!==c.length)throw Error(`Expected an array of two numbers for ${b}`);return c}let ga="renderOrder",gb=class extends d2{constructor(a){const b=Object.assign({},a=a||{});delete b.style,delete b.renderBuffer,delete b.updateWhileAnimating,delete b.updateWhileInteracting,super(b),this.declutter_=a.declutter?String(a.declutter):void 0,this.renderBuffer_=void 0!==a.renderBuffer?a.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(a.style),this.updateWhileAnimating_=void 0!==a.updateWhileAnimating&&a.updateWhileAnimating,this.updateWhileInteracting_=void 0!==a.updateWhileInteracting&&a.updateWhileInteracting}getDeclutter(){return this.declutter_}getFeatures(a){return super.getFeatures(a)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(ga)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(a,b){let c=this.getDeclutter();c in a.declutter==!1&&(a.declutter[c]=new d4(9)),this.getRenderer().renderDeclutter(a,b)}setRenderOrder(a){this.set(ga,a)}setStyle(a){this.style_=void 0===a?fN:a;let b=function(a){if(void 0===a)return fN;if(!a)return null;if("function"==typeof a||a instanceof fL)return a;if(!Array.isArray(a))return fR([a]);if(0===a.length)return[];let b=a.length,c=a[0];if(c instanceof fL){let c=Array(b);for(let d=0;d<b;++d){let b=a[d];if(!(b instanceof fL))throw Error("Expected a list of style instances");c[d]=b}return c}if("style"in c){let c,d,e,f=Array(b);for(let c=0;c<b;++c){let b=a[c];if(!("style"in b))throw Error("Expected a list of rules with a style property");f[c]=b}return d=function(a,b){let c=a.length,d=Array(c);for(let e=0;e<c;++e){let c,f=a[e],g="filter"in f?fd(f.filter,eA,b):fQ;if(Array.isArray(f.style)){let a=f.style.length;c=Array(a);for(let d=0;d<a;++d)c[d]=fS(f.style[d],b)}else c=[fS(f.style,b)];d[e]={filter:g,styles:c}}return function(b){let e=[],f=!1;for(let g=0;g<c;++g)if((0,d[g].filter)(b)&&(!a[g].else||!f))for(let a of(f=!0,d[g].styles)){let c=a(b);c&&e.push(c)}return e}}(f,c=eM()),e=fc(),function(a,b){if(e.properties=a.getPropertiesInternal(),e.resolution=b,c.featureId){let b=a.getId();void 0!==b?e.featureId=b:e.featureId=null}return c.geometryType&&(e.geometryType=function a(b){if(!b)return"";let c=b.getType();switch(c){case"Point":case"LineString":case"Polygon":return c;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return c.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return a(b.getGeometries()[0]);default:return""}}(a.getGeometry())),d(e)}}return fR(a)}(a);this.styleFunction_=null===a?void 0:function(a){let b;if("function"==typeof a)b=a;else{let c;Array.isArray(a)?c=a:(aq("function"==typeof a.getZIndex,"Expected an `Style` or an array of `Style`"),c=[a]),b=function(){return c}}return b}(b),this.changed()}setDeclutter(a){this.declutter_=a?String(a):void 0,this.changed()}},gc=class extends L{constructor(a,b,c,d){super(a),this.inversePixelTransform=b,this.frameState=c,this.context=d}};function gd(a,b){fg.expire()}let ge=class extends z{constructor(a){super(),this.map_=a}dispatchRenderEvent(a,b){R()}calculateMatrices2D(a){let b=a.viewState,c=a.coordinateToPixelTransform,d=a.pixelToCoordinateTransform;cg(c,a.size[0]/2,a.size[1]/2,1/b.resolution,-1/b.resolution,-b.rotation,-b.center[0],-b.center[1]),ch(d,c)}forEachFeatureAtCoordinate(a,b,c,d,e,f,g,h){let i,j=b.viewState;function k(a,b,c,d){return e.call(f,b,a?c:null,d)}let l=j.projection,m=bb(a.slice(),l),n=[[0,0]];if(l.canWrapX()&&d){let a=a4(l.getExtent());n.push([-a,0],[a,0])}let o=b.layerStatesArray,p=o.length,q=[],r=[];for(let d=0;d<n.length;d++)for(let e=p-1;e>=0;--e){let f=o[e],l=f.layer;if(l.hasRenderer()&&d1(f,j)&&g.call(h,l)){let e=l.getRenderer(),g=l.getSource();if(e&&g){let h=g.getWrapX()?m:a,j=k.bind(null,f.managed);r[0]=h[0]+n[d][0],r[1]=h[1]+n[d][1],i=e.forEachFeatureAtCoordinate(r,b,c,j,q)}if(i)return i}}if(0===q.length)return;let s=1/q.length;return q.forEach((a,b)=>a.distanceSq+=b*s),q.sort((a,b)=>a.distanceSq-b.distanceSq),q.some(a=>i=a.callback(a.feature,a.layer,a.geometry)),i}hasFeatureAtCoordinate(a,b,c,d,e,f){return void 0!==this.forEachFeatureAtCoordinate(a,b,c,d,F,this,e,f)}getMap(){return this.map_}renderFrame(a){R()}scheduleExpireIconCache(a){fg.canExpireCache()&&a.postRenderFunctions.push(gd)}},gf=class extends ge{constructor(a){super(a),this.fontChangeListenerKey_=N(fu,r,a.redrawText,a),this.element_=ae?c6():document.createElement("div");const b=this.element_.style;b.position="absolute",b.width="100%",b.height="100%",b.zIndex="0",this.element_.className=cX+" ol-layers";const c=a.getViewport();c&&c.insertBefore(this.element_,c.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(a,b){let c=this.getMap();if(c.hasListener(a)){let d=new gc(a,void 0,b);c.dispatchEvent(d)}}disposeInternal(){O(this.fontChangeListenerKey_),this.element_.remove(),super.disposeInternal()}renderFrame(a){if(!a){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(a),this.dispatchRenderEvent(d_,a);let b=a.layerStatesArray.sort((a,b)=>a.zIndex-b.zIndex);b.some(a=>a.layer instanceof gb&&a.layer.getDeclutter())&&(a.declutter={});let c=a.viewState;this.children_.length=0;let d=[],e=null;for(let f=0,g=b.length;f<g;++f){let g=b[f];a.layerIndex=f;let h=g.layer,i=h.getSourceState();if(!d1(g,c)||"ready"!=i&&"undefined"!=i){h.unrender();continue}let j=h.render(a,e);j&&(j!==e&&(this.children_.push(j),e=j),d.push(g))}this.declutter(a,d),function(a,b){let c=a.childNodes;for(let d=0;;++d){let e=c[d],f=b[d];if(!e&&!f)break;if(e!==f){if(!e){a.appendChild(f);continue}if(!f){a.removeChild(e),--d;continue}a.insertBefore(f,e)}}}(this.element_,this.children_);let f=this.getMap().getTargetElement();if(c7(f)){let a=f.getContext("2d");for(let b of this.children_){let c=b.firstElementChild||b,d=b.style.backgroundColor;if(d&&(!c7(c)||c.width>0)&&(a.fillStyle=d,a.fillRect(0,0,f.width,f.height)),c7(c)&&c.width>0){let d=b.style.opacity||c.style.opacity;a.globalAlpha=""===d?1:Number(d);let e=c.style.transform;if(e)a.setTransform(...cj(e));else{let b=parseFloat(c.style.width)/c.width,d=parseFloat(c.style.height)/c.height;a.setTransform(b,0,0,d,0,0)}a.drawImage(c,0,0)}}a.globalAlpha=1,a.setTransform(1,0,0,1,0,0)}this.dispatchRenderEvent("postcompose",a),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(a)}declutter(a,b){if(a.declutter){for(let c=b.length-1;c>=0;--c){let d=b[c],e=d.layer;e.getDeclutter()&&e.renderDeclutter(a,d)}b.forEach(b=>b.layer.renderDeferred(a))}}},gg=class extends V{constructor(a){super(),a=a||{},this.on,this.once,this.un;const b=function(a){let b,c,d,e=null;void 0!==a.keyboardEventTarget&&(e="string"==typeof a.keyboardEventTarget?document.getElementById(a.keyboardEventTarget):a.keyboardEventTarget);let f={},g=a.layers&&"function"==typeof a.layers.getLayers?a.layers:new dY({layers:a.layers});return f[am]=g,f[ao]=a.target,f[ap]=a.view instanceof cV?a.view:new cV,void 0!==a.controls&&(Array.isArray(a.controls)?b=new Y(a.controls.slice()):(aq("function"==typeof a.controls.getArray,"Expected `controls` to be an array or an `ol/Collection.js`"),b=a.controls)),void 0!==a.interactions&&(Array.isArray(a.interactions)?c=new Y(a.interactions.slice()):(aq("function"==typeof a.interactions.getArray,"Expected `interactions` to be an array or an `ol/Collection.js`"),c=a.interactions)),void 0!==a.overlays?Array.isArray(a.overlays)?d=new Y(a.overlays.slice()):(aq("function"==typeof a.overlays.getArray,"Expected `overlays` to be an array or an `ol/Collection.js`"),d=a.overlays):d=new Y,{controls:b,interactions:c,keyboardEventTarget:e,overlays:d,values:f}}(a);this.renderComplete_=!1,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=void 0!==a.maxTilesLoading?a.maxTilesLoading:16,this.pixelRatio_=void 0!==a.pixelRatio?a.pixelRatio:ad,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=ce(),this.pixelToCoordinateTransform_=ce(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,ae||(this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_)),this.mapBrowserEventHandler_=null,this.moveTolerance_=a.moveTolerance,this.keyboardEventTarget_=b.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,ae||(this.resizeObserver_=new ResizeObserver(()=>this.updateSize())),this.controls=b.controls||(ae?new Y:function(a){a=a||{};let b=new Y;return(void 0===a.zoom||a.zoom)&&b.push(new db(a.zoomOptions)),(void 0===a.rotate||a.rotate)&&b.push(new da(a.rotateOptions)),(void 0===a.attribution||a.attribution)&&b.push(new c9(a.attributionOptions)),b}()),this.interactions=b.interactions||(ae?new Y:function(a){a=a||{};let b=new Y,c=new dc(-.005,.05,100);return(void 0===a.altShiftDragRotate||a.altShiftDragRotate)&&b.push(new dw),(void 0===a.doubleClickZoom||a.doubleClickZoom)&&b.push(new dg({delta:a.zoomDelta,duration:a.zoomDuration})),(void 0===a.dragPan||a.dragPan)&&b.push(new dv({onFocusOnly:a.onFocusOnly,kinetic:c})),(void 0===a.pinchRotate||a.pinchRotate)&&b.push(new dI),(void 0===a.pinchZoom||a.pinchZoom)&&b.push(new dJ({duration:a.zoomDuration})),(void 0===a.keyboard||a.keyboard)&&(b.push(new dF),b.push(new dG({delta:a.zoomDelta,duration:a.zoomDuration}))),(void 0===a.mouseWheelZoom||a.mouseWheelZoom)&&b.push(new dH({onFocusOnly:a.onFocusOnly,duration:a.zoomDuration})),(void 0===a.shiftDragZoom||a.shiftDragZoom)&&b.push(new dB({duration:a.zoomDuration})),b}({onFocusOnly:!0})),this.overlays_=b.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new at(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(am,this.handleLayerGroupChanged_),this.addChangeListener(ap,this.handleViewChanged_),this.addChangeListener(an,this.handleSizeChanged_),this.addChangeListener(ao,this.handleTargetChanged_),this.setProperties(b.values);const c=this;!a.view||a.view instanceof cV||a.view.then(function(a){c.setView(new cV(a))}),this.controls.addEventListener("add",a=>{a.element.setMap(this)}),this.controls.addEventListener(q,a=>{a.element.setMap(null)}),this.interactions.addEventListener("add",a=>{a.element.setMap(this)}),this.interactions.addEventListener(q,a=>{a.element.setMap(null)}),this.overlays_.addEventListener("add",a=>{this.addOverlayInternal_(a.element)}),this.overlays_.addEventListener(q,a=>{let b=a.element.getId();void 0!==b&&delete this.overlayIdIndex_[b.toString()],a.element.setMap(null)}),this.controls.forEach(a=>{a.setMap(this)}),this.interactions.forEach(a=>{a.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(a){this.getControls().push(a)}addInteraction(a){this.getInteractions().push(a)}addLayer(a){this.getLayerGroup().getLayers().push(a)}handleLayerAdd_(a){!function a(b,c){if(b instanceof d2)return void b.setMapInternal(c);if(b instanceof dY){let d=b.getLayers().getArray();for(let b=0,e=d.length;b<e;++b)a(d[b],c)}}(a.layer,this)}addOverlay(a){this.getOverlays().push(a)}addOverlayInternal_(a){let b=a.getId();void 0!==b&&(this.overlayIdIndex_[b.toString()]=a),a.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_?.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(a,b,c){if(!this.frameState_||!this.renderer_)return;let d=this.getCoordinateFromPixelInternal(a),e=void 0!==(c=void 0!==c?c:{}).hitTolerance?c.hitTolerance:0,f=void 0!==c.layerFilter?c.layerFilter:F,g=!1!==c.checkWrapped;return this.renderer_.forEachFeatureAtCoordinate(d,this.frameState_,e,g,b,null,f,null)}getFeaturesAtPixel(a,b){let c=[];return this.forEachFeatureAtPixel(a,function(a){c.push(a)},b),c}getAllLayers(){let a=[];return!function b(c){c.forEach(function(c){c instanceof dY?b(c.getLayers()):a.push(c)})}(this.getLayers()),a}hasFeatureAtPixel(a,b){if(!this.frameState_||!this.renderer_)return!1;let c=this.getCoordinateFromPixelInternal(a),d=void 0!==(b=void 0!==b?b:{}).layerFilter?b.layerFilter:F,e=void 0!==b.hitTolerance?b.hitTolerance:0,f=!1!==b.checkWrapped;return this.renderer_.hasFeatureAtCoordinate(c,this.frameState_,e,f,d,null)}getEventCoordinate(a){return this.getCoordinateFromPixel(this.getEventPixel(a))}getEventCoordinateInternal(a){return this.getCoordinateFromPixelInternal(this.getEventPixel(a))}getEventPixel(a){let b=this.viewport_.getBoundingClientRect(),c=this.getSize(),d=b.width/c[0],e=b.height/c[1],f="changedTouches"in a?a.changedTouches[0]:a;return[(f.clientX-b.left)/d,(f.clientY-b.top)/e]}getTarget(){return this.get(ao)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(a){var b,c;return b=this.getCoordinateFromPixelInternal(a),c=this.getView().getProjection(),b}getCoordinateFromPixelInternal(a){let b=this.frameState_;return b?cf(b.pixelToCoordinateTransform,a.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(a){let b=this.overlayIdIndex_[a.toString()];return void 0!==b?b:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(am)}setLayers(a){let b=this.getLayerGroup();if(a instanceof Y)return void b.setLayers(a);let c=b.getLayers();c.clear(),c.extend(a)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){let a=this.getLayerGroup().getLayerStatesArray();for(let b=0,c=a.length;b<c;++b){let c=a[b];if(!c.visible)continue;let d=c.layer.getRenderer();if(d&&!d.ready)return!0;let e=c.layer.getSource();if(e&&e.loading)return!0}return!1}getPixelFromCoordinate(a){let b=ca(a,this.getView().getProjection());return this.getPixelFromCoordinateInternal(b)}getPixelFromCoordinateInternal(a){let b=this.frameState_;return b?cf(b.coordinateToPixelTransform,a.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(an)}getView(){return this.get(ap)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){let a=this.getTargetElement();return a?a.ownerDocument:document}getTilePriority(a,b,c,d){return function(a,b,c,d,e){if(!a||!(c in a.wantedTiles)||!a.wantedTiles[c][b.getKey()])return ar;let f=a.viewState.center,g=d[0]-f[0],h=d[1]-f[1];return 65536*Math.log(e)+Math.sqrt(g*g+h*h)/e}(this.frameState_,a,b,c,d)}handleBrowserEvent(a,b){let c=new $(b=b||a.type,this,a);this.handleMapBrowserEvent(c)}handleMapBrowserEvent(a){if(!this.frameState_)return;let b=a.originalEvent,c=b.type;if(c===ah||c===y||c===v){let a=this.getOwnerDocument(),c=this.viewport_.getRootNode?this.viewport_.getRootNode():a,d=b.target,e=c instanceof ShadowRoot?c.host===d?c.host.ownerDocument:c:c===a?a.documentElement:c;if(this.overlayContainerStopEvent_.contains(d)||!e.contains(d))return}if(a.frameState=this.frameState_,!1!==this.dispatchEvent(a)){let b=this.getInteractions().getArray().slice();for(let c=b.length-1;c>=0;c--){let d=b[c];if(d.getMap()===this&&d.getActive()&&this.getTargetElement()&&(!d.handleEvent(a)||a.propagationStopped))break}}}handlePostRender(){let a=this.frameState_,b=this.tileQueue_;if(!b.isEmpty()){let c=this.maxTilesLoading_,d=c;if(a){let b=a.viewHints;if(b[0]||b[1]){let b=Date.now()-a.time>8;c=8*!b,d=2*!b}}b.getTilesLoading()<c&&(b.reprioritize(),b.loadMoreTiles(c,d))}a&&this.renderer_&&!a.animate&&(this.renderComplete_?(this.hasListener(d0)&&this.renderer_.dispatchRenderEvent(d0,a),!1===this.loaded_&&(this.loaded_=!0,this.dispatchEvent(new Z(al,this,a)))):!0===this.loaded_&&(this.loaded_=!1,this.dispatchEvent(new Z(ak,this,a))));let c=this.postRenderFunctions_;if(a)for(let b=0,d=c.length;b<d;++b)c[b](this,a);c.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let a=0,b=this.targetChangeHandlerKeys_.length;a<b;++a)O(this.targetChangeHandlerKeys_[a]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(t,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(y,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,this.viewport_.remove()}if(this.targetElement_&&!c7(this.targetElement_)){this.resizeObserver_?.unobserve(this.targetElement_);let a=this.targetElement_.getRootNode();a instanceof ShadowRoot&&this.resizeObserver_.unobserve(a.host),this.setSize(void 0)}let a=this.getTarget(),b="string"==typeof a?document.getElementById(a):a;if(this.targetElement_=b,b){if(c7(b)||b.appendChild(this.viewport_),this.renderer_||(this.renderer_=new gf(this)),!c7(b)){let a;for(let a in this.mapBrowserEventHandler_=new ai(this,this.moveTolerance_),_)this.mapBrowserEventHandler_.addEventListener(_[a],this.handleMapBrowserEvent.bind(this));if(this.viewport_.addEventListener(t,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(y,this.boundHandleBrowserEvent_,!!ag&&{passive:!1}),this.keyboardEventTarget_)a=this.keyboardEventTarget_;else{let c=b.getRootNode();a=c instanceof ShadowRoot?c.host:b}if(this.targetChangeHandlerKeys_=[N(a,v,this.handleBrowserEvent,this),N(a,w,this.handleBrowserEvent,this)],b instanceof HTMLElement){let a=b.getRootNode();a instanceof ShadowRoot&&this.resizeObserver_.observe(a.host),this.resizeObserver_?.observe(b)}}this.updateSize()}else this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0)}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(O(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(O(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);let a=this.getView();a&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=N(a,r,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=N(a,s,this.handleViewPropertyChanged_,this),a.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(O),this.layerGroupPropertyListenerKeys_=null);let a=this.getLayerGroup();a&&(this.handleLayerAdd_(new dW("addlayer",a)),this.layerGroupPropertyListenerKeys_=[N(a,r,this.render,this),N(a,s,this.render,this),N(a,"addlayer",this.handleLayerAdd_,this),N(a,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){if(!this.frameState_)return;let a=this.frameState_.layerStatesArray;for(let b=0,c=a.length;b<c;++b){let c=a[b].layer;c.hasRenderer()&&c.getRenderer().handleFontsChanged()}}render(){this.renderer_&&void 0===this.animationDelayKey_&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(a){return this.getControls().remove(a)}removeInteraction(a){return this.getInteractions().remove(a)}removeLayer(a){return this.getLayerGroup().getLayers().remove(a)}handleLayerRemove_(a){!function a(b){b instanceof d2?b.setMapInternal(null):b instanceof dY&&b.getLayers().forEach(a)}(a.layer)}removeOverlay(a){return this.getOverlays().remove(a)}renderFrame_(a){let b=this.getSize(),c=this.getView(),d=this.frameState_,e=null;if(void 0!==b&&ex(b)&&c&&c.isDef()){let d=c.getHints(this.frameState_?this.frameState_.viewHints:void 0),f=c.getState();if(e={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:a$(f.center,f.resolution,f.rotation,b),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:b,tileQueue:this.tileQueue_,time:a,usedTiles:{},viewState:f,viewHints:d,wantedTiles:{},mapId:T(this),renderTargets:{}},f.nextCenter&&f.nextResolution){let a=isNaN(f.nextRotation)?f.rotation:f.nextRotation;e.nextExtent=a$(f.nextCenter,f.nextResolution,a,b)}}this.frameState_=e,this.renderer_.renderFrame(e),e&&(e.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,e.postRenderFunctions),d&&(this.previousExtent_&&(a6(this.previousExtent_)||aS(e.extent,this.previousExtent_))||(this.dispatchEvent(new Z("movestart",this,d)),this.previousExtent_=aQ(this.previousExtent_))),!this.previousExtent_||e.viewHints[0]||e.viewHints[1]||aS(e.extent,this.previousExtent_)||(this.dispatchEvent(new Z("moveend",this,e)),aI(e.extent,this.previousExtent_))),this.dispatchEvent(new Z(aj,this,e)),this.renderComplete_=(this.hasListener(ak)||this.hasListener(al)||this.hasListener(d0))&&!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(a){let b=this.getLayerGroup();b&&this.handleLayerRemove_(new dW("removelayer",b)),this.set(am,a)}setSize(a){this.set(an,a)}setTarget(a){this.set(ao,a)}setView(a){if(!a||a instanceof cV)return void this.set(ap,a);this.set(ap,new cV);let b=this;a.then(function(a){b.setView(new cV(a))})}updateSize(){let a,b=this.getTargetElement();if(b){let c,d;if(c7(b))c=b.width,d=b.height;else{let a=getComputedStyle(b);c=b.offsetWidth-parseFloat(a.borderLeftWidth)-parseFloat(a.paddingLeft)-parseFloat(a.paddingRight)-parseFloat(a.borderRightWidth),d=b.offsetHeight-parseFloat(a.borderTopWidth)-parseFloat(a.paddingTop)-parseFloat(a.paddingBottom)-parseFloat(a.borderBottomWidth)}!isNaN(c)&&!isNaN(d)&&!ex(a=[Math.max(0,c),Math.max(0,d)])&&(b.offsetWidth||b.offsetHeight||b.getClientRects().length)&&bg("No map visible because the map container's width or height are 0.")}let c=this.getSize();!a||c&&E(a,c)||(this.setSize(a),this.updateViewportSize_(a))}updateViewportSize_(a){let b=this.getView();b&&b.setViewportSize(a)}};a.s(["default",0,gg],35039);let gh=class extends M{constructor(a,b,c){super(),c=c||{},this.tileCoord=a,this.state=b,this.key="",this.transition_=void 0===c.transition?250:c.transition,this.transitionStarts_={},this.interpolate=!!c.interpolate}changed(){this.dispatchEvent(s)}release(){this.setState(4)}getKey(){return this.key+"/"+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(a){if(4!==this.state){if(3!==this.state&&this.state>a)throw Error("Tile load sequence violation");this.state=a,this.changed()}}load(){R()}getAlpha(a,b){if(!this.transition_)return 1;let c=this.transitionStarts_[a];if(c){if(-1===c)return 1}else c=b,this.transitionStarts_[a]=c;let d=b-c+1e3/60;return d>=this.transition_?1:bc(d/this.transition_)}inTransition(a){return!!this.transition_&&-1!==this.transitionStarts_[a]}endTransition(a){this.transition_&&(this.transitionStarts_[a]=-1)}disposeInternal(){this.release(),super.disposeInternal()}};function gi(a){return a instanceof Image||a instanceof HTMLCanvasElement||a instanceof HTMLVideoElement||a instanceof ImageBitmap?a:null}let gj=Error("disposed"),gk=[256,256],gl=class extends gh{constructor(a){super(a.tileCoord,0,{transition:a.transition,interpolate:a.interpolate}),this.loader_=a.loader,this.data_=null,this.error_=null,this.size_=a.size||null,this.controller_=a.controller||null}getSize(){if(this.size_)return this.size_;let a=gi(this.data_);return a?[a.width,a.height]:gk}getData(){return this.data_}getError(){return this.error_}load(){if(0!==this.state&&3!==this.state)return;this.state=1,this.changed();let a=this;this.loader_().then(function(b){a.data_=b,a.state=2,a.changed()}).catch(function(b){a.error_=b,a.state=3,a.changed()})}disposeInternal(){this.controller_&&(this.controller_.abort(gj),this.controller_=null),super.disposeInternal()}},gm=class extends gh{constructor(a,b,c,d,e,f){super(a,b,f),this.crossOrigin_=d,this.src_=c,this.key=c,this.image_,ae?this.image_=new OffscreenCanvas(1,1):(this.image_=new Image,null!==d&&(this.image_.crossOrigin=d)),this.unlisten_=null,this.tileLoadFunction_=e}getImage(){return this.image_}setImage(a){this.image_=a,this.state=2,this.unlistenImage_(),this.changed()}getCrossOrigin(){return this.crossOrigin_}handleImageError_(){let a;this.state=3,this.unlistenImage_(),this.image_=((a=c2(1,1)).fillStyle="rgba(0,0,0,0)",a.fillRect(0,0,1,1),a.canvas),this.changed()}handleImageLoad_(){if(ae)this.state=2;else{let a=this.image_;a.naturalWidth&&a.naturalHeight?this.state=2:this.state=4}this.unlistenImage_(),this.changed()}load(){var a,b,c;let d,e,f,g;3==this.state&&(this.state=0,this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)),0==this.state&&(this.state=1,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=(a=this.image_,b=this.handleImageLoad_.bind(this),c=this.handleImageError_.bind(this),d=!0,e=!1,f=!1,g=[N(a,"load",function(){f=!0,e||b()},void 0,!0)],a.src&&af?(e=!0,a.decode().then(function(){d&&b()}).catch(function(a){d&&(f?b():c())})):g.push(N(a,"error",c,void 0,!0)),function(){d=!1,g.forEach(O)}))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}disposeInternal(){this.unlistenImage_(),this.image_=null,super.disposeInternal()}};class gn{constructor(a,b,c,d){this.minX=a,this.maxX=b,this.minY=c,this.maxY=d}contains(a){return this.containsXY(a[1],a[2])}containsTileRange(a){return this.minX<=a.minX&&a.maxX<=this.maxX&&this.minY<=a.minY&&a.maxY<=this.maxY}containsXY(a,b){return this.minX<=a&&a<=this.maxX&&this.minY<=b&&b<=this.maxY}equals(a){return this.minX==a.minX&&this.minY==a.minY&&this.maxX==a.maxX&&this.maxY==a.maxY}extend(a){a.minX<this.minX&&(this.minX=a.minX),a.maxX>this.maxX&&(this.maxX=a.maxX),a.minY<this.minY&&(this.minY=a.minY),a.maxY>this.maxY&&(this.maxY=a.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(a){return this.minX<=a.maxX&&this.maxX>=a.minX&&this.minY<=a.maxY&&this.maxY>=a.minY}}function go(a,b,c,d,e){return void 0!==e?(e.minX=a,e.maxX=b,e.minY=c,e.maxY=d,e):new gn(a,b,c,d)}let gp=[];function gq(a,b,c,d,e){a.beginPath(),a.moveTo(0,0),a.lineTo(b,c),a.lineTo(d,e),a.closePath(),a.save(),a.clip(),a.fillRect(0,0,Math.max(b,d)+1,Math.max(c,e)),a.restore()}function gr(a,b){return Math.abs(a[4*b]-210)>2||Math.abs(a[4*b+3]-191.25)>2}function gs(a,b,c,d){let e=b7(c,b,a),f=b$(b,d,c),g=b.getMetersPerUnit();void 0!==g&&(f*=g);let h=a.getMetersPerUnit();void 0!==h&&(f/=h);let i=a.getExtent();if(!i||aK(i,e)){let b=b$(a,f,e)/f;isFinite(b)&&b>0&&(f/=b)}return f}let gt=class{constructor(a,b,c,d,e,f,g){this.sourceProj_=a,this.targetProj_=b;let h={};const i=g?b1(a=>cf(g,b7(a,this.targetProj_,this.sourceProj_))):b6(this.targetProj_,this.sourceProj_);this.transformInv_=function(a){let b=a[0]+"/"+a[1];return h[b]||(h[b]=i(a)),h[b]},this.maxSourceExtent_=d,this.errorThresholdSquared_=e*e,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!d&&!!this.sourceProj_.getExtent()&&a4(d)>=a4(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?a4(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?a4(this.targetProj_.getExtent()):null;const j=a2(c),k=a3(c),l=aY(c),m=aX(c),n=this.transformInv_(j),o=this.transformInv_(k),p=this.transformInv_(l),q=this.transformInv_(m),r=10+(f?Math.max(0,Math.ceil(Math.log2(aW(c)/(f*f*65536)))):0);if(this.addQuad_(j,k,l,m,n,o,p,q,r),this.wrapsXInSource_){let a=1/0;this.triangles_.forEach(function(b,c,d){a=Math.min(a,b.source[0][0],b.source[1][0],b.source[2][0])}),this.triangles_.forEach(b=>{if(Math.max(b.source[0][0],b.source[1][0],b.source[2][0])-a>this.sourceWorldWidth_/2){let c=[[b.source[0][0],b.source[0][1]],[b.source[1][0],b.source[1][1]],[b.source[2][0],b.source[2][1]]];c[0][0]-a>this.sourceWorldWidth_/2&&(c[0][0]-=this.sourceWorldWidth_),c[1][0]-a>this.sourceWorldWidth_/2&&(c[1][0]-=this.sourceWorldWidth_),c[2][0]-a>this.sourceWorldWidth_/2&&(c[2][0]-=this.sourceWorldWidth_);let d=Math.min(c[0][0],c[1][0],c[2][0]);Math.max(c[0][0],c[1][0],c[2][0])-d<this.sourceWorldWidth_/2&&(b.source=c)}})}h={}}addTriangle_(a,b,c,d,e,f){this.triangles_.push({source:[d,e,f],target:[a,b,c]})}addQuad_(a,b,c,d,e,f,g,h,i){let j=aG([e,f,g,h]),k=this.sourceWorldWidth_?a4(j)/this.sourceWorldWidth_:null,l=this.sourceWorldWidth_,m=this.sourceProj_.canWrapX()&&k>.5&&k<1,n=!1;if(i>0&&(this.targetProj_.isGlobal()&&this.targetWorldWidth_&&(n=a4(aG([a,b,c,d]))/this.targetWorldWidth_>.25||n),!m&&this.sourceProj_.isGlobal()&&k&&(n=k>.25||n)),!n&&this.maxSourceExtent_&&isFinite(j[0])&&isFinite(j[1])&&isFinite(j[2])&&isFinite(j[3])&&!a5(j,this.maxSourceExtent_))return;let o=0;if(!n&&(!isFinite(e[0])||!isFinite(e[1])||!isFinite(f[0])||!isFinite(f[1])||!isFinite(g[0])||!isFinite(g[1])||!isFinite(h[0])||!isFinite(h[1]))){if(i>0)n=!0;else if(1!=(o=8*!(isFinite(e[0])&&isFinite(e[1]))+4*!(isFinite(f[0])&&isFinite(f[1]))+2*!(isFinite(g[0])&&isFinite(g[1]))+ +!(isFinite(h[0])&&isFinite(h[1])))&&2!=o&&4!=o&&8!=o)return}if(i>0){if(!n){let b,d=[(a[0]+c[0])/2,(a[1]+c[1])/2],f=this.transformInv_(d);b=m?(az(e[0],l)+az(g[0],l))/2-az(f[0],l):(e[0]+g[0])/2-f[0];let h=(e[1]+g[1])/2-f[1];n=b*b+h*h>this.errorThresholdSquared_}if(n){if(Math.abs(a[0]-c[0])<=Math.abs(a[1]-c[1])){let j=[(b[0]+c[0])/2,(b[1]+c[1])/2],k=this.transformInv_(j),l=[(d[0]+a[0])/2,(d[1]+a[1])/2],m=this.transformInv_(l);this.addQuad_(a,b,j,l,e,f,k,m,i-1),this.addQuad_(l,j,c,d,m,k,g,h,i-1)}else{let j=[(a[0]+b[0])/2,(a[1]+b[1])/2],k=this.transformInv_(j),l=[(c[0]+d[0])/2,(c[1]+d[1])/2],m=this.transformInv_(l);this.addQuad_(a,j,l,d,e,k,m,h,i-1),this.addQuad_(j,b,c,l,k,f,g,m,i-1)}return}}if(m){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}(11&o)==0&&this.addTriangle_(a,c,d,e,g,h),(14&o)==0&&this.addTriangle_(a,c,b,e,g,f),o&&((13&o)==0&&this.addTriangle_(b,d,a,f,h,e),(7&o)==0&&this.addTriangle_(b,d,c,f,h,g))}calculateSourceExtent(){let a=aO();return this.triangles_.forEach(function(b,c,d){let e=b.source;aT(a,e[0]),aT(a,e[1]),aT(a,e[2])}),a}getTriangles(){return this.triangles_}},gu=class extends gh{constructor(a,b,c,d,e,f,g,h,i,j,k,l){super(e,0,l),this.renderEdges_=void 0!==k&&k,this.pixelRatio_=g,this.gutter_=h,this.canvas_=null,this.sourceTileGrid_=b,this.targetTileGrid_=d,this.wrappedTileCoord_=f||e,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=a.canWrapX()?a.getExtent():void 0;const m=d.getTileCoordExtent(this.wrappedTileCoord_),n=this.targetTileGrid_.getExtent();let o=this.sourceTileGrid_.getExtent();const p=n?a1(m,n):m;if(0===aW(p)){this.state=4;return}const q=a.getExtent();q&&(o=o?a1(o,q):q);const r=d.getResolution(this.wrappedTileCoord_[0]),s=function(a,b,c,d){let e=gs(a,b,aZ(c),d);return(!isFinite(e)||e<=0)&&aV(c,function(c){return isFinite(e=gs(a,b,c,d))&&e>0}),e}(a,c,p,r);if(!isFinite(s)||s<=0||(this.triangulation_=new gt(a,c,p,o,s*(void 0!==j?j:.5),r),0===this.triangulation_.getTriangles().length)){this.state=4;return}this.sourceZ_=b.getZForResolution(s);let t=this.triangulation_.calculateSourceExtent();if(o&&(a.canWrapX()?(t[1]=av(t[1],o[1],o[3]),t[3]=av(t[3],o[1],o[3])):t=a1(t,o)),aW(t)){let c=0,d=0;a.canWrapX()&&(c=a4(q),d=Math.floor((t[0]-q[0])/c)),a8(t.slice(),a,!0).forEach(a=>{let e=b.getTileRangeForExtentAndZ(a,this.sourceZ_);for(let a=e.minX;a<=e.maxX;a++)for(let b=e.minY;b<=e.maxY;b++){let e=i(this.sourceZ_,a,b,g);if(e){let a=d*c;this.sourceTiles_.push({tile:e,offset:a})}}++d}),0===this.sourceTiles_.length&&(this.state=4)}else this.state=4}getImage(){return this.canvas_}reproject_(){let a=[];if(this.sourceTiles_.forEach(b=>{let c=b.tile;if(c&&2==c.getState()){let d=this.sourceTileGrid_.getTileCoordExtent(c.tileCoord);d[0]+=b.offset,d[2]+=b.offset;let e=this.clipExtent_?.slice();e&&(e[0]+=b.offset,e[2]+=b.offset),a.push({extent:d,clipExtent:e,image:c.getImage()})}}),this.sourceTiles_.length=0,0===a.length)this.state=3;else{let b=this.wrappedTileCoord_[0],c=this.targetTileGrid_.getTileSize(b),d="number"==typeof c?c:c[0],f="number"==typeof c?c:c[1],g=this.targetTileGrid_.getResolution(b),h=this.sourceTileGrid_.getResolution(this.sourceZ_),i=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=function(a,b,c,d,f,g,h,i,j,k,l,m,n,o){let p,q=c2(Math.round(c*a),Math.round(c*b),gp);if(m||(q.imageSmoothingEnabled=!1),0===j.length)return q.canvas;function r(a){return Math.round(a*c)/c}q.scale(c,c),q.globalCompositeOperation="lighter";let s=aO();j.forEach(function(a,b,c){var d;(d=a.extent)[0]<s[0]&&(s[0]=d[0]),d[2]>s[2]&&(s[2]=d[2]),d[1]<s[1]&&(s[1]=d[1]),d[3]>s[3]&&(s[3]=d[3])});let t=c/d,u=(m?1:1.0000000596046448)/t;p=c2(Math.round(a4(s)*t),Math.round(a0(s)*t),gp),m||(p.imageSmoothingEnabled=!1),j.forEach(function(a,b,c){if(a.image.width>0&&a.image.height>0){if(a.clipExtent){p.save();let b=(a.clipExtent[0]-s[0])*t,c=-(a.clipExtent[3]-s[3])*t,d=a4(a.clipExtent)*t,e=a0(a.clipExtent)*t;p.rect(m?b:Math.round(b),m?c:Math.round(c),m?d:Math.round(b+d)-Math.round(b),m?e:Math.round(c+e)-Math.round(c)),p.clip()}let b=(a.extent[0]-s[0])*t,c=-(a.extent[3]-s[3])*t,d=a4(a.extent)*t,e=a0(a.extent)*t;p.drawImage(a.image,k,k,a.image.width-2*k,a.image.height-2*k,m?b:Math.round(b),m?c:Math.round(c),m?d:Math.round(b+d)-Math.round(b),m?e:Math.round(c+e)-Math.round(c)),a.clipExtent&&p.restore()}});let v=a2(h);return i.getTriangles().forEach(function(a,b,c){let d,f=a.source,h=a.target,i=f[0][0],k=f[0][1],l=f[1][0],n=f[1][1],o=f[2][0],t=f[2][1],w=r((h[0][0]-v[0])/g),x=r(-(h[0][1]-v[1])/g),y=r((h[1][0]-v[0])/g),z=r(-(h[1][1]-v[1])/g),A=r((h[2][0]-v[0])/g),B=r(-(h[2][1]-v[1])/g),C=i,D=k;i=0,k=0;let E=function(a){let b=a.length;for(let c=0;c<b;c++){let d=c,e=Math.abs(a[c][c]);for(let f=c+1;f<b;f++){let b=Math.abs(a[f][c]);b>e&&(e=b,d=f)}if(0===e)return null;let f=a[d];a[d]=a[c],a[c]=f;for(let d=c+1;d<b;d++){let e=-a[d][c]/a[c][c];for(let f=c;f<b+1;f++)c==f?a[d][f]=0:a[d][f]+=e*a[c][f]}}let c=Array(b);for(let d=b-1;d>=0;d--){c[d]=a[d][b]/a[d][d];for(let e=d-1;e>=0;e--)a[e][b]-=a[e][d]*c[d]}return c}([[l-=C,n-=D,0,0,y-w],[o-=C,t-=D,0,0,A-w],[0,0,l,n,z-x],[0,0,o,t,B-x]]);if(E){if(q.save(),q.beginPath(),function(){if(void 0===e){let a=c2(6,6,gp);a.globalCompositeOperation="lighter",a.fillStyle="rgba(210, 0, 0, 0.75)",gq(a,4,5,4,0),gq(a,4,5,0,5);let b=a.getImageData(0,0,3,3).data;e=gr(b,0)||gr(b,4)||gr(b,8),c4(a),gp.push(a.canvas)}return e}()||!m){q.moveTo(y,z);let a=w-y,b=x-z;for(let c=0;c<4;c++)q.lineTo(y+r((c+1)*a/4),z+r(c*b/3)),3!=c&&q.lineTo(y+r((c+1)*a/4),z+r((c+1)*b/3));q.lineTo(A,B)}else q.moveTo(y,z),q.lineTo(w,x),q.lineTo(A,B);if(q.clip(),q.transform(E[0],E[2],E[1],E[3],w,x),q.translate(s[0]-C,s[3]-D),p)d=p.canvas,q.scale(u,-u);else{let a=j[0],b=a.extent;d=a.image,q.scale(a4(b)/d.width,-a0(b)/d.height)}q.drawImage(d,0,0),q.restore()}}),p&&(c4(p),gp.push(p.canvas)),l&&(q.save(),q.globalCompositeOperation="source-over",q.strokeStyle="black",q.lineWidth=1,i.getTriangles().forEach(function(a,b,c){let d=a.target,e=(d[0][0]-v[0])/g,f=-(d[0][1]-v[1])/g,h=(d[1][0]-v[0])/g,i=-(d[1][1]-v[1])/g,j=(d[2][0]-v[0])/g,k=-(d[2][1]-v[1])/g;q.beginPath(),q.moveTo(h,i),q.lineTo(e,f),q.lineTo(j,k),q.closePath(),q.stroke()}),q.restore()),q.canvas}(d,f,this.pixelRatio_,h,this.sourceTileGrid_.getExtent(),g,i,this.triangulation_,a,this.gutter_,this.renderEdges_,this.interpolate),this.state=2}this.changed()}load(){if(0==this.state){this.state=1,this.changed();let a=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:b})=>{let c=b.getState();if(0==c||1==c){a++;let c=N(b,s,d=>{let e=b.getState();(2==e||3==e||4==e)&&(O(c),0==--a&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(c)}}),0===a?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:a},b,c){0==a.getState()&&a.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(O),this.sourcesListenerKeys_=null}release(){this.canvas_&&(c4(this.canvas_.getContext("2d")),gp.push(this.canvas_),this.canvas_=null),super.release()}},gv=class{constructor(a){this.highWaterMark=void 0!==a?a:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}deleteOldest(){let a=this.pop();a instanceof z&&a.dispose()}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(a){for(;this.canExpireCache();)this.deleteOldest()}clear(){for(;this.oldest_;)this.deleteOldest()}containsKey(a){return this.entries_.hasOwnProperty(a)}forEach(a){let b=this.oldest_;for(;b;)a(b.value_,b.key_,this),b=b.newer}get(a,b){let c=this.entries_[a];return aq(void 0!==c,"Tried to get a value for a key that does not exist in the cache"),c===this.newest_||(c===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(c.newer.older=c.older,c.older.newer=c.newer),c.newer=null,c.older=this.newest_,this.newest_.newer=c,this.newest_=c),c.value_}remove(a){let b=this.entries_[a];return aq(void 0!==b,"Tried to get a value for a key that does not exist in the cache"),b===this.newest_?(this.newest_=b.older,this.newest_&&(this.newest_.newer=null)):b===this.oldest_?(this.oldest_=b.newer,this.oldest_&&(this.oldest_.older=null)):(b.newer.older=b.older,b.older.newer=b.newer),delete this.entries_[a],--this.count_,b.value_}getCount(){return this.count_}getKeys(){let a,b=Array(this.count_),c=0;for(a=this.newest_;a;a=a.older)b[c++]=a.key_;return b}getValues(){let a,b=Array(this.count_),c=0;for(a=this.newest_;a;a=a.older)b[c++]=a.value_;return b}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(a){return this.entries_[a]?.value_}pop(){let a=this.oldest_;return delete this.entries_[a.key_],a.newer&&(a.newer.older=null),this.oldest_=a.newer,this.oldest_||(this.newest_=null),--this.count_,a.value_}replace(a,b){this.get(a),this.entries_[a].value_=b}set(a,b){aq(!(a in this.entries_),"Tried to set a value for a key that is used already");let c={key_:a,newer:null,older:this.newest_,value_:b};this.newest_?this.newest_.newer=c:this.oldest_=c,this.newest_=c,this.entries_[a]=c,++this.count_}setSize(a){this.highWaterMark=a}};function gw(a,b,c,d){return void 0!==d?(d[0]=a,d[1]=b,d[2]=c,d):[a,b,c]}function gx(a,b,c,d,e){return`${T(a)},${b},${c+"/"+d+"/"+e}`}let gy=class{constructor(){this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(c3(),{get:(a,b)=>{if("function"==typeof c3()[b])return this.push_(b),this.pushMethodArgs_},set:(a,b,c)=>(this.push_(b,c),!0)})}push_(...a){let b=this.instructions_,c=this.zIndex+this.offset_;b[c]||(b[c]=[]),b[c].push(...a)}pushMethodArgs_=(...a)=>(this.push_(a),this);pushFunction(a){this.push_(a)}getContext(){return this.context_}draw(a){this.instructions_.forEach(b=>{for(let c=0,d=b.length;c<d;++c){let d=b[c];if("function"==typeof d){d(a);continue}let e=b[++c];if("function"==typeof a[d])a[d](...e);else{if("function"==typeof e){a[d]=e(a);continue}a[d]=e}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}},gz=class extends Q{constructor(a){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=a,this.staleKeys_=[],this.maxStaleKeys=5}getStaleKeys(){return this.staleKeys_}prependStaleKey(a){this.staleKeys_.unshift(a),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}getFeatures(a){return R()}getData(a){return null}prepareFrame(a){return R()}renderFrame(a,b){return R()}forEachFeatureAtCoordinate(a,b,c,d,e){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(a){let b=a.target;(2===b.getState()||3===b.getState())&&this.renderIfReadyAndVisible()}loadImage(a){let b=a.getState();return 2!=b&&3!=b&&a.addEventListener(s,this.boundHandleImageChange_),0==b&&(a.load(),b=a.getState()),2==b}renderIfReadyAndVisible(){let a=this.getLayer();a&&a.getVisible()&&"ready"===a.getSourceState()&&a.changed()}renderDeferred(a){}disposeInternal(){delete this.layer_,super.disposeInternal()}},gA=[],gB=null,gC=class extends gz{constructor(a){super(a),this.container=null,this.renderedResolution,this.tempTransform=ce(),this.pixelTransform=ce(),this.inversePixelTransform=ce(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.frameState=null}getImageData(a,b,c){let d;gB||(gB=c2(1,1,void 0,{willReadFrequently:!0})),gB.clearRect(0,0,1,1);try{gB.drawImage(a,b,c,1,1,0,0,1,1),d=gB.getImageData(0,0,1,1).data}catch{return gB=null,null}return d}getBackground(a){let b=this.getLayer().getBackground();return"function"==typeof b&&(b=b(a.viewState.resolution)),b||void 0}useContainer(a,b,c){let d,e,f=this.getLayer().getClassName();if(a&&a.className===f&&(!c||a&&a.style.backgroundColor&&E(ev(a.style.backgroundColor),ev(c)))){let b=a.firstElementChild;c7(b)&&(e=b.getContext("2d"))}if(e&&function(a,b){let c=cj(a),d=cj(b);for(let a=0;a<6;++a)if(0!==Math.round((c[a]-d[a])*ci[a]))return!1;return!0}(e.canvas.style.transform,b)?(this.container=a,this.context=e,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){(d=ae?c6():document.createElement("div")).className=f;let a=d.style;a.position="absolute",a.width="100%",a.height="100%";let b=(e=c2()).canvas;d.appendChild(b),(a=b.style).position="absolute",a.left="0",a.transformOrigin="top left",this.container=d,this.context=e}this.containerReused||!c||this.container.style.backgroundColor||(this.container.style.backgroundColor=c)}clipUnrotated(a,b,c){let d=a2(c),e=a3(c),f=aY(c),g=aX(c);cf(b.coordinateToPixelTransform,d),cf(b.coordinateToPixelTransform,e),cf(b.coordinateToPixelTransform,f),cf(b.coordinateToPixelTransform,g);let h=this.inversePixelTransform;cf(h,d),cf(h,e),cf(h,f),cf(h,g),a.save(),a.beginPath(),a.moveTo(Math.round(d[0]),Math.round(d[1])),a.lineTo(Math.round(e[0]),Math.round(e[1])),a.lineTo(Math.round(f[0]),Math.round(f[1])),a.lineTo(Math.round(g[0]),Math.round(g[1])),a.clip()}prepareContainer(a,b){let c=a.extent,d=a.viewState.resolution,e=a.viewState.rotation,f=a.pixelRatio,g=Math.round(a4(c)/d*f),h=Math.round(a0(c)/d*f);cg(this.pixelTransform,a.size[0]/2,a.size[1]/2,1/f,1/f,e,-g/2,-h/2),ch(this.inversePixelTransform,this.pixelTransform);let i="matrix("+this.pixelTransform.join(", ")+")";if(this.useContainer(b,i,this.getBackground(a)),!this.containerReused){let a=this.context.canvas;a.width!=g||a.height!=h?(a.width=g,a.height=h):this.context.clearRect(0,0,g,h),i!==a.style.transform&&(a.style.transform=i)}}dispatchRenderEvent_(a,b,c){let d=this.getLayer();if(d.hasListener(a)){let e=new gc(a,this.inversePixelTransform,c,b);d.dispatchEvent(e)}}preRender(a,b){this.frameState=b,b.declutter||this.dispatchRenderEvent_(dZ,a,b)}postRender(a,b){b.declutter||this.dispatchRenderEvent_(d$,a,b)}renderDeferredInternal(a){}getRenderContext(a){return a.declutter&&!this.deferredContext_&&(this.deferredContext_=new gy),a.declutter?this.deferredContext_.getContext():this.context}renderDeferred(a){a.declutter&&(this.dispatchRenderEvent_(dZ,this.context,a),a.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(a),this.dispatchRenderEvent_(d$,this.context,a))}getRenderTransform(a,b,c,d,e,f,g){let h=d/b,i=-a[0]+g,j=-a[1];return cg(this.tempTransform,e/2,f/2,h,-h,-c,i,j)}disposeInternal(){delete this.frameState,super.disposeInternal()}};function gD(a,b,c){if(!(c in a))return a[c]=new Set([b]),!0;let d=a[c],e=d.has(b);return e||d.add(b),!e}function gE(a,b){var c,d;let e=a.layerStatesArray[a.layerIndex];e.extent&&(b=a1(b,(c=e.extent,d=a.viewState.projection,c)));let f=e.layer.getRenderSource();if(!f.getWrapX()){let c=f.getTileGridForProjection(a.viewState.projection).getExtent();c&&(b=a1(b,c))}return b}let gF=class extends gC{constructor(a,b){super(a),b=b||{},this.extentChanged=!0,this.renderComplete=!1,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedTiles=[],this.renderedSourceKey_,this.renderedSourceRevision_,this.tempExtent=aO(),this.tempTileRange_=new gn(0,0,0,0),this.tempTileCoord_=gw(0,0,0);const c=void 0!==b.cacheSize?b.cacheSize:512;this.tileCache_=new gv(c),this.sourceTileCache_=null,this.maxStaleKeys=.5*c}getTileCache(){return this.tileCache_}getSourceTileCache(){return this.sourceTileCache_||(this.sourceTileCache_=new gv(512)),this.sourceTileCache_}getOrCreateTile(a,b,c,d){let e,f=this.tileCache_,g=this.getLayer().getSource(),h=gx(g,g.getKey(),a,b,c);if(f.containsKey(h))e=f.get(h);else{let i=d.viewState.projection,j=g.getProjection();if(!(e=g.getTile(a,b,c,d.pixelRatio,i,!j||b3(j,i)?void 0:this.getSourceTileCache())))return null;f.set(h,e)}return e}getTile(a,b,c,d){let e=this.getOrCreateTile(a,b,c,d);return e||null}getData(a){let b=this.frameState;if(!b)return null;let c=this.getLayer(),d=cf(b.pixelToCoordinateTransform,a.slice()),e=c.getExtent();if(e&&!aK(e,d))return null;let f=b.viewState,g=c.getRenderSource(),h=g.getTileGridForProjection(f.projection),i=g.getTilePixelRatio(b.pixelRatio);for(let a=h.getZForResolution(f.resolution);a>=h.getMinZoom();--a){let c,e=h.getTileCoordForCoordAndZ(d,a),j=this.getTile(a,e[1],e[2],b);if(!j||2!==j.getState())continue;let k=h.getOrigin(a),l=ey(h.getTileSize(a)),m=h.getResolution(a);if(j instanceof gm||j instanceof gu)c=j.getImage();else if(!(j instanceof gl))continue;else if(!(c=gi(j.getData())))continue;let n=Math.floor(i*((d[0]-k[0])/m-e[1]*l[0])),o=Math.floor(i*((k[1]-d[1])/m-e[2]*l[1])),p=Math.round(i*g.getGutterForProjection(f.projection));return this.getImageData(c,n+p,o+p)}return null}prepareFrame(a){this.renderedProjection?a.viewState.projection!==this.renderedProjection&&(this.tileCache_.clear(),this.renderedProjection=a.viewState.projection):this.renderedProjection=a.viewState.projection;let b=this.getLayer().getSource();if(!b)return!1;let c=b.getRevision();return this.renderedSourceRevision_?this.renderedSourceRevision_!==c&&(this.renderedSourceRevision_=c,this.renderedSourceKey_===b.getKey()&&(this.tileCache_.clear(),this.sourceTileCache_?.clear())):this.renderedSourceRevision_=c,!0}enqueueTilesForNextExtent(){return!0}enqueueTiles(a,b,c,d,e){let f=a.viewState,g=this.getLayer(),h=g.getRenderSource(),i=h.getTileGridForProjection(f.projection),j=T(h);j in a.wantedTiles||(a.wantedTiles[j]={});let k=a.wantedTiles[j],l=g.getMapInternal(),m=Math.max(c-e,i.getMinZoom(),i.getZForResolution(Math.min(g.getMaxResolution(),l?l.getView().getResolutionForZoom(Math.max(g.getMinZoom(),0)):i.getResolution(0)),h.zDirection)),n=f.rotation,o=n?a_(f.center,f.resolution,n,a.size):void 0;for(let e=c;e>=m;--e){let c=i.getTileRangeForExtentAndZ(b,e,this.tempTileRange_),f=i.getResolution(e);for(let b=c.minX;b<=c.maxX;++b)for(let g=c.minY;g<=c.maxY;++g){if(n&&!i.tileCoordIntersectsViewport([e,b,g],o))continue;let c=this.getTile(e,b,g,a);if(!c||!gD(d,c,e))continue;let h=c.getKey();if(k[h]=!0,0===c.getState()&&!a.tileQueue.isKeyQueued(h)){let d=gw(e,b,g,this.tempTileCoord_);a.tileQueue.enqueue([c,j,i.getTileCoordCenter(d),f])}}}}findStaleTile_(a,b){let c=this.tileCache_,d=a[0],e=a[1],f=a[2],g=this.getStaleKeys();for(let a=0;a<g.length;++a){let h=gx(this.getLayer().getSource(),g[a],d,e,f);if(c.containsKey(h)){let a=c.peek(h);if(2===a.getState())return a.endTransition(T(this)),gD(b,a,d),!0}}return!1}findAltTiles_(a,b,c,d){let e=a.getTileRangeForTileCoordAndZ(b,c,this.tempTileRange_);if(!e)return!1;let f=!0,g=this.tileCache_,h=this.getLayer().getRenderSource(),i=h.getKey();for(let a=e.minX;a<=e.maxX;++a)for(let b=e.minY;b<=e.maxY;++b){let e=gx(h,i,c,a,b),j=!1;if(g.containsKey(e)){let a=g.peek(e);2===a.getState()&&(gD(d,a,c),j=!0)}j||(f=!1)}return f}renderFrame(a,b){var c,d,e,f;let g;this.renderComplete=!0;let h=a.layerStatesArray[a.layerIndex],i=a.viewState,j=i.projection,k=i.resolution,l=i.center,m=a.pixelRatio,n=this.getLayer(),o=n.getSource(),p=o.getTileGridForProjection(j),q=p.getZForResolution(k,o.zDirection),r=p.getResolution(q),s=o.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==s&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=s):this.renderedSourceKey_=s;let t=a.extent,u=o.getTilePixelRatio(m);this.prepareContainer(a,b);let v=this.context.canvas.width,w=this.context.canvas.height,x=h.extent&&(c=h.extent,d=0,c);x&&(t=a1(t,(e=h.extent,f=0,e)));let y=r*v/2/u,z=r*w/2/u,B=[l[0]-y,l[1]-z,l[0]+y,l[1]+z],C={};this.renderedTiles.length=0;let D=n.getPreload();if(a.nextExtent&&this.enqueueTilesForNextExtent()){let b=p.getZForResolution(i.nextResolution,o.zDirection),c=gE(a,a.nextExtent);this.enqueueTiles(a,c,b,C,D)}let E=gE(a,t);if(this.enqueueTiles(a,E,q,C,0),D>0&&setTimeout(()=>{this.enqueueTiles(a,E,q-1,C,D-1)},0),!(q in C))return this.container;let F=T(this),G=a.time;for(let b of C[q]){let c=b.getState();if(4===c)continue;let d=b.tileCoord;if(2===c&&1===b.getAlpha(F,G)){b.endTransition(F);continue}if(3!==c&&(this.renderComplete=!1),this.findStaleTile_(d,C)){!function(a,b,c){let d=a[c];d&&d.delete(b)}(C,b,q),a.animate=!0;continue}if(this.findAltTiles_(p,d,q+1,C))continue;let e=p.getMinZoom();for(let a=q-1;a>=e&&!this.findAltTiles_(p,d,a,C);--a);}let H=r/k*m/u,I=this.getRenderContext(a);cg(this.tempTransform,v/2,w/2,H,H,0,-v/2,-w/2),h.extent&&this.clipUnrotated(I,a,x),o.getInterpolate()||(I.imageSmoothingEnabled=!1),this.preRender(I,a);let J=Object.keys(C).map(Number);J.sort(A);let K=[],L=[];for(let b=J.length-1;b>=0;--b){let c=J[b],d=o.getTilePixelSize(c,m,j),e=p.getResolution(c)/r,f=d[0]*e*H,h=d[1]*e*H,i=p.getTileCoordForCoordAndZ(a2(B),c),k=p.getTileCoordExtent(i),l=cf(this.tempTransform,[u*(k[0]-B[0])/r,u*(B[3]-k[3])/r]),n=u*o.getGutterForProjection(j);for(let b of C[c]){if(2!==b.getState())continue;let d=b.tileCoord,e=i[1]-d[1],j=Math.round(l[0]-(e-1)*f),k=i[2]-d[2],m=Math.round(l[1]-(k-1)*h),p=Math.round(l[0]-e*f),q=Math.round(l[1]-k*h),r=j-p,s=m-q,t=1===J.length,u=!1;g=[p,q,p+r,q,p+r,q+s,p,q+s];for(let a=0,b=K.length;a<b;++a)if(!t&&c<L[a]){let b=K[a];a5([p,q,p+r,q+s],[b[0],b[3],b[4],b[7]])&&(u||(I.save(),u=!0),I.beginPath(),I.moveTo(g[0],g[1]),I.lineTo(g[2],g[3]),I.lineTo(g[4],g[5]),I.lineTo(g[6],g[7]),I.moveTo(b[6],b[7]),I.lineTo(b[4],b[5]),I.lineTo(b[2],b[3]),I.lineTo(b[0],b[1]),I.clip())}K.push(g),L.push(c),this.drawTile(b,a,p,q,r,s,n,t),u&&I.restore(),this.renderedTiles.unshift(b),this.updateUsedTiles(a.usedTiles,o,b)}}if(this.renderedResolution=r,this.extentChanged=!this.renderedExtent_||!aS(this.renderedExtent_,B),this.renderedExtent_=B,this.renderedPixelRatio=m,this.postRender(this.context,a),h.extent&&I.restore(),I.imageSmoothingEnabled=!0,this.renderComplete){let b=(a,b)=>{let c=T(o),d=b.wantedTiles[c],e=d?Object.keys(d).length:0;this.updateCacheSize(e),this.tileCache_.expireCache(),this.sourceTileCache_?.expireCache()};a.postRenderFunctions.push(b)}return this.container}updateCacheSize(a){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,2*a)}drawTile(a,b,c,d,e,f,g,h){let i;if(a instanceof gl){if(!(i=gi(a.getData())))throw Error("Rendering array data is not yet supported")}else i=this.getTileImage(a);if(!i)return;let j=this.getRenderContext(b),k=T(this),l=b.layerStatesArray[b.layerIndex],m=l.opacity*(h?a.getAlpha(k,b.time):1),n=m!==j.globalAlpha;n&&(j.save(),j.globalAlpha=m),j.drawImage(i,g,g,i.width-2*g,i.height-2*g,c,d,e,f),n&&j.restore(),m!==l.opacity?b.animate=!0:h&&a.endTransition(k)}getImage(){let a=this.context;return a?a.canvas:null}getTileImage(a){return a.getImage()}updateUsedTiles(a,b,c){let d=T(b);d in a||(a[d]={}),a[d][c.getKey()]=!0}},gG="preload",gH="useInterimTilesOnError",gI=class extends d2{constructor(a){const b=Object.assign({},a=a||{}),c=a.cacheSize;delete a.cacheSize,delete b.preload,delete b.useInterimTilesOnError,super(b),this.on,this.once,this.un,this.cacheSize_=c,this.setPreload(void 0!==a.preload?a.preload:0),this.setUseInterimTilesOnError(void 0===a.useInterimTilesOnError||a.useInterimTilesOnError)}getCacheSize(){return this.cacheSize_}getPreload(){return this.get(gG)}setPreload(a){this.set(gG,a)}getUseInterimTilesOnError(){return this.get(gH)}setUseInterimTilesOnError(a){this.set(gH,a)}getData(a){return super.getData(a)}};a.s(["default",0,class extends gI{constructor(a){super(a)}createRenderer(){return new gF(this,{cacheSize:this.getCacheSize()})}}],99869);let gJ=[0,0,0],gK=class{constructor(a){let b;if(this.minZoom=void 0!==a.minZoom?a.minZoom:0,this.resolutions_=a.resolutions,aq(function(a,b,c){let d=b||A;return a.every(function(b,e){if(0===e)return!0;let f=d(a[e-1],b);return!(f>0||c&&0===f)})}(this.resolutions_,(a,b)=>b-a,!0),"`resolutions` must be sorted in descending order"),!a.origins)for(let a=0,c=this.resolutions_.length-1;a<c;++a)if(b){if(this.resolutions_[a]/this.resolutions_[a+1]!==b){b=void 0;break}}else b=this.resolutions_[a]/this.resolutions_[a+1];this.zoomFactor_=b,this.maxZoom=this.resolutions_.length-1,this.origin_=void 0!==a.origin?a.origin:null,this.origins_=null,void 0!==a.origins&&(this.origins_=a.origins,aq(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const c=a.extent;void 0===c||this.origin_||this.origins_||(this.origin_=a2(c)),aq(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,void 0!==a.tileSizes&&(this.tileSizes_=a.tileSizes,aq(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=void 0!==a.tileSize?a.tileSize:this.tileSizes_?null:256,aq(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=void 0!==c?c:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],void 0!==a.sizes?this.fullTileRanges_=a.sizes.map((a,b)=>{let d=new gn(Math.min(0,a[0]),Math.max(a[0]-1,-1),Math.min(0,a[1]),Math.max(a[1]-1,-1));if(c){let a=this.getTileRangeForExtentAndZ(c,b);d.minX=Math.max(a.minX,d.minX),d.maxX=Math.min(a.maxX,d.maxX),d.minY=Math.max(a.minY,d.minY),d.maxY=Math.min(a.maxY,d.maxY)}return d}):c&&this.calculateTileRanges_(c)}forEachTileCoord(a,b,c){let d=this.getTileRangeForExtentAndZ(a,b);for(let a=d.minX,e=d.maxX;a<=e;++a)for(let e=d.minY,f=d.maxY;e<=f;++e)c([b,a,e])}forEachTileCoordParentTileRange(a,b,c,d){let e,f,g,h=null,i=a[0]-1;for(2===this.zoomFactor_?(f=a[1],g=a[2]):h=this.getTileCoordExtent(a,d);i>=this.minZoom;){if(e=void 0!==f&&void 0!==g?go(f=Math.floor(f/2),f,g=Math.floor(g/2),g,c):this.getTileRangeForExtentAndZ(h,i,c),b(i,e))return!0;--i}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(a){return this.origin_?this.origin_:this.origins_[a]}getResolution(a){return this.resolutions_[a]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(a,b,c){if(a[0]<this.maxZoom){if(2===this.zoomFactor_){let c=2*a[1],d=2*a[2];return go(c,c+1,d,d+1,b)}let d=this.getTileCoordExtent(a,c||this.tmpExtent_);return this.getTileRangeForExtentAndZ(d,a[0]+1,b)}return null}getTileRangeForTileCoordAndZ(a,b,c){if(b>this.maxZoom||b<this.minZoom)return null;let d=a[0],e=a[1],f=a[2];if(b===d)return go(e,f,e,f,c);if(this.zoomFactor_){let a=Math.pow(this.zoomFactor_,b-d),g=Math.floor(e*a),h=Math.floor(f*a);return b<d?go(g,g,h,h,c):go(g,Math.floor(a*(e+1))-1,h,Math.floor(a*(f+1))-1,c)}let g=this.getTileCoordExtent(a,this.tmpExtent_);return this.getTileRangeForExtentAndZ(g,b,c)}getTileRangeForExtentAndZ(a,b,c){this.getTileCoordForXYAndZ_(a[0],a[3],b,!1,gJ);let d=gJ[1],e=gJ[2];return this.getTileCoordForXYAndZ_(a[2],a[1],b,!0,gJ),go(d,gJ[1],e,gJ[2],c)}getTileCoordCenter(a){let b=this.getOrigin(a[0]),c=this.getResolution(a[0]),d=ey(this.getTileSize(a[0]),this.tmpSize_);return[b[0]+(a[1]+.5)*d[0]*c,b[1]-(a[2]+.5)*d[1]*c]}getTileCoordExtent(a,b){let c=this.getOrigin(a[0]),d=this.getResolution(a[0]),e=ey(this.getTileSize(a[0]),this.tmpSize_),f=c[0]+a[1]*e[0]*d,g=c[1]-(a[2]+1)*e[1]*d,h=f+e[0]*d,i=g+e[1]*d;return aP(f,g,h,i,b)}getTileCoordForCoordAndResolution(a,b,c){return this.getTileCoordForXYAndResolution_(a[0],a[1],b,!1,c)}getTileCoordForXYAndResolution_(a,b,c,d,e){let f=this.getZForResolution(c),g=c/this.getResolution(f),h=this.getOrigin(f),i=ey(this.getTileSize(f),this.tmpSize_),j=g*(a-h[0])/c/i[0],k=g*(h[1]-b)/c/i[1];return d?(j=aC(j,5)-1,k=aC(k,5)-1):(j=aB(j,5),k=aB(k,5)),gw(f,j,k,e)}getTileCoordForXYAndZ_(a,b,c,d,e){let f=this.getOrigin(c),g=this.getResolution(c),h=ey(this.getTileSize(c),this.tmpSize_),i=(a-f[0])/g/h[0],j=(f[1]-b)/g/h[1];return d?(i=aC(i,5)-1,j=aC(j,5)-1):(i=aB(i,5),j=aB(j,5)),gw(c,i,j,e)}getTileCoordForCoordAndZ(a,b,c){return this.getTileCoordForXYAndZ_(a[0],a[1],b,!1,c)}getTileCoordResolution(a){return this.resolutions_[a[0]]}getTileSize(a){return this.tileSize_?this.tileSize_:this.tileSizes_[a]}getFullTileRange(a){return this.fullTileRanges_?this.fullTileRanges_[a]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,a):null}getZForResolution(a,b){return av(C(this.resolutions_,a,b||0),this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(a,b){return cJ(b,0,b.length,2,this.getTileCoordExtent(a))}calculateTileRanges_(a){let b=this.resolutions_.length,c=Array(b);for(let d=this.minZoom;d<b;++d)c[d]=this.getTileRangeForExtentAndZ(a,d);this.fullTileRanges_=c}};function gL(a){let b=a.getDefaultTileGrid();return b||(b=function(a,b,c,d){var e,f;let g;return e=gN(a),f=(f=void 0,"top-left"),g=gM(e,void 0,void 0),new gK({extent:e,origin:function(a,b){let c;if("bottom-left"===b)c=aX(a);else if("bottom-right"===b)c=aY(a);else if("top-left"===b)c=a2(a);else if("top-right"===b)c=a3(a);else throw Error("Invalid corner");return c}(e,f),resolutions:g,tileSize:void 0})}(a),a.setDefaultTileGrid(b)),b}function gM(a,b,c,d){b=void 0!==b?b:42,c=ey(void 0!==c?c:256);let e=a0(a),f=a4(a);d=d>0?d:Math.max(f/c[0],e/c[1]);let g=b+1,h=Array(g);for(let a=0;a<g;++a)h[a]=d/Math.pow(2,a);return h}function gN(a){let b=(a=bZ(a)).getExtent();if(!b){let c=180*bh.degrees/a.getMetersPerUnit();b=aP(-c,-c,c,c)}return b}let gO=/\{z\}/g,gP=/\{x\}/g,gQ=/\{y\}/g,gR=/\{-y\}/g;function gS(a){return a?"function"==typeof a?a:(Array.isArray(a)||(a=[a]),b=>a):null}let gT=class extends V{constructor(a){super(),this.projection=bZ(a.projection),this.attributions_=gS(a.attributions),this.attributionsCollapsible_=a.attributionsCollapsible??!0,this.loading=!1,this.state_=void 0!==a.state?a.state:"ready",this.wrapX_=void 0!==a.wrapX&&a.wrapX,this.interpolate_=!!a.interpolate,this.viewResolver=null,this.viewRejector=null;const b=this;this.viewPromise_=new Promise(function(a,c){b.viewResolver=a,b.viewRejector=c})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(a){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(a){this.attributions_=gS(a),this.changed()}setState(a){this.state_=a,this.changed()}};class gU extends L{constructor(a,b){super(a),this.tile=b}}let gV=class extends gT{constructor(a){super({attributions:a.attributions,attributionsCollapsible:a.attributionsCollapsible,projection:a.projection,state:a.state,wrapX:a.wrapX,interpolate:a.interpolate}),this.on,this.once,this.un,this.tilePixelRatio_=void 0!==a.tilePixelRatio?a.tilePixelRatio:1,this.tileGrid=void 0!==a.tileGrid?a.tileGrid:null,this.tileGrid&&ey(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),[256,256]),this.tmpSize=[0,0],this.key_=a.key||T(this),this.tileOptions={transition:a.transition,interpolate:a.interpolate},this.zDirection=a.zDirection?a.zDirection:0}getGutterForProjection(a){return 0}getKey(){return this.key_}setKey(a){this.key_!==a&&(this.key_=a,this.changed())}getResolutions(a){let b=a?this.getTileGridForProjection(a):this.tileGrid;return b?b.getResolutions():null}getTile(a,b,c,d,e,f){return R()}getTileGrid(){return this.tileGrid}getTileGridForProjection(a){return this.tileGrid?this.tileGrid:gL(a)}getTilePixelRatio(a){return this.tilePixelRatio_}getTilePixelSize(a,b,c){var d;let e=this.getTileGridForProjection(c),f=this.getTilePixelRatio(b),g=ey(e.getTileSize(a),this.tmpSize);return 1==f?g:(void 0===(d=this.tmpSize)&&(d=[0,0]),d[0]=g[0]*f+.5|0,d[1]=g[1]*f+.5|0,d)}getTileCoordForTileUrlFunction(a,b){let c=void 0!==b?b:this.getProjection(),d=void 0!==b?this.getTileGridForProjection(c):this.tileGrid||this.getTileGridForProjection(c);return this.getWrapX()&&c.isGlobal()&&(a=function(a,b,c){let d=b[0],e=a.getTileCoordCenter(b),f=gN(c);if(!aK(f,e)){let b=a4(f),c=Math.ceil((f[0]-e[0])/b);return e[0]+=b*c,a.getTileCoordForCoordAndZ(e,d)}return b}(d,a,c)),!function(a,b){let c=a[0],d=a[1],e=a[2];if(b.getMinZoom()>c||c>b.getMaxZoom())return!1;let f=b.getFullTileRange(c);return!f||f.containsXY(d,e)}(a,d)?null:a}clear(){}refresh(){this.clear(),super.refresh()}};class gW extends gV{constructor(a){super({attributions:a.attributions,cacheSize:a.cacheSize,projection:a.projection,state:a.state,tileGrid:a.tileGrid,tilePixelRatio:a.tilePixelRatio,wrapX:a.wrapX,transition:a.transition,interpolate:a.interpolate,key:a.key,attributionsCollapsible:a.attributionsCollapsible,zDirection:a.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===gW.prototype.tileUrlFunction,this.tileLoadFunction=a.tileLoadFunction,a.tileUrlFunction&&(this.tileUrlFunction=a.tileUrlFunction),this.urls=null,a.urls?this.setUrls(a.urls):a.url&&this.setUrl(a.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(a){let b,c=a.target,d=T(c),e=c.getState();1==e?(this.tileLoadingKeys_[d]=!0,b="tileloadstart"):d in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[d],b=3==e?"tileloaderror":2==e?"tileloadend":void 0),void 0!=b&&this.dispatchEvent(new gU(b,c))}setTileLoadFunction(a){this.tileLoadFunction=a,this.changed()}setTileUrlFunction(a,b){this.tileUrlFunction=a,void 0!==b?this.setKey(b):this.changed()}setUrl(a){let b=function(a){let b=[],c=/\{([a-z])-([a-z])\}/.exec(a);if(c){let d,e=c[1].charCodeAt(0),f=c[2].charCodeAt(0);for(d=e;d<=f;++d)b.push(a.replace(c[0],String.fromCharCode(d)));return b}if(c=/\{(\d+)-(\d+)\}/.exec(a)){let d=parseInt(c[2],10);for(let e=parseInt(c[1],10);e<=d;e++)b.push(a.replace(c[0],e.toString()));return b}return b.push(a),b}(a);this.urls=b,this.setUrls(b)}setUrls(a){this.urls=a;let b=a.join("\n");this.generateTileUrlFunction_?this.setTileUrlFunction(function(a,b){var c;let d=a.length,e=Array(d);for(let c=0;c<d;++c)e[c]=function(a,b){return function(c,d,e){var f,g,h;let i;if(!c)return;let j=c[0];if(b){let a=b.getFullTileRange(j);a&&(i=a.getHeight()-1)}return f=c[1],g=c[2],h=i,a.replace(gO,j.toString()).replace(gP,f.toString()).replace(gQ,g.toString()).replace(gR,function(){if(void 0===h)throw Error("If the URL template has a {-y} placeholder, the grid extent must be known");return(h-g).toString()})}}(a[c],b);return 1===(c=e).length?c[0]:function(a,b,d){var e,f;if(!a)return;let g=az((e=a[0],f=a[1],(f<<e)+a[2]),c.length);return c[g](a,b,d)}}(a,this.tileGrid),b):this.setKey(b)}tileUrlFunction(a,b,c){}}let gX=gW;function gY(a,b){if(ae){let c=a.getCrossOrigin(),d="same-origin",e="same-origin";"anonymous"===c||""===c?(d="cors",e="omit"):"use-credentials"===c&&(d="cors",e="include"),fetch(b,{mode:d,credentials:e}).then(a=>{if(!a.ok)throw Error(`HTTP ${a.status}`);return a.blob()}).then(a=>createImageBitmap(a)).then(b=>{let c=a.getImage();c.width=b.width,c.height=b.height,c.getContext("2d").drawImage(b,0,0),b.close?.(),c.dispatchEvent(new Event("load"))}).catch(()=>{a.getImage().dispatchEvent(new Event("error"))});return}a.getImage().src=b}let gZ=class extends gX{constructor(a){super({attributions:a.attributions,cacheSize:a.cacheSize,projection:a.projection,state:a.state,tileGrid:a.tileGrid,tileLoadFunction:a.tileLoadFunction?a.tileLoadFunction:gY,tilePixelRatio:a.tilePixelRatio,tileUrlFunction:a.tileUrlFunction,url:a.url,urls:a.urls,wrapX:a.wrapX,transition:a.transition,interpolate:void 0===a.interpolate||a.interpolate,key:a.key,attributionsCollapsible:a.attributionsCollapsible,zDirection:a.zDirection}),this.crossOrigin=void 0!==a.crossOrigin?a.crossOrigin:null,this.tileClass=void 0!==a.tileClass?a.tileClass:gm,this.tileGridForProjection={},this.reprojectionErrorThreshold_=a.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}getGutterForProjection(a){return this.getProjection()&&a&&!b3(this.getProjection(),a)?0:this.getGutter()}getGutter(){return 0}getKey(){let a=super.getKey();return this.getInterpolate()||(a+=":disable-interpolation"),a}getTileGridForProjection(a){let b=this.getProjection();if(this.tileGrid&&(!b||b3(b,a)))return this.tileGrid;let c=T(a);return c in this.tileGridForProjection||(this.tileGridForProjection[c]=gL(a)),this.tileGridForProjection[c]}createTile_(a,b,c,d,e,f){let g=[a,b,c],h=this.getTileCoordForTileUrlFunction(g,e),i=h?this.tileUrlFunction(h,d,e):void 0,j=new this.tileClass(g,4*(void 0===i),void 0!==i?i:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return j.key=f,j.addEventListener(s,this.handleTileChange.bind(this)),j}getTile(a,b,c,d,e,f){let g=this.getProjection();if(!g||!e||b3(g,e))return this.getTileInternal(a,b,c,d,g||e);let h=[a,b,c],i=this.getKey(),j=this.getTileGridForProjection(g),k=this.getTileGridForProjection(e),l=this.getTileCoordForTileUrlFunction(h,e),m=new gu(g,j,e,k,h,l,this.getTilePixelRatio(d),this.getGutter(),(a,b,c,d)=>this.getTileInternal(a,b,c,d,g,f),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return m.key=i,m}getTileInternal(a,b,c,d,e,f){let g=this.getKey(),h=gx(this,g,a,b,c);if(f&&f.containsKey(h))return f.get(h);let i=this.createTile_(a,b,c,d,e,g);return f?.set(h,i),i}setRenderReprojectionEdges(a){this.renderReprojectionEdges_!=a&&(this.renderReprojectionEdges_=a,this.changed())}setTileGridForProjection(a,b){let c=bZ(a);if(c){let a=T(c);a in this.tileGridForProjection||(this.tileGridForProjection[a]=b)}}},g$=class extends gZ{constructor(a){const b=void 0!==(a=a||{}).projection?a.projection:"EPSG:3857",c=void 0!==a.tileGrid?a.tileGrid:function(a){let b=a||{},c=b.extent||bZ("EPSG:3857").getExtent();return new gK({extent:c,minZoom:b.minZoom,tileSize:b.tileSize,resolutions:gM(c,b.maxZoom,b.tileSize,b.maxResolution)})}({extent:gN(b),maxResolution:a.maxResolution,maxZoom:a.maxZoom,minZoom:a.minZoom,tileSize:a.tileSize});super({attributions:a.attributions,cacheSize:a.cacheSize,crossOrigin:a.crossOrigin,interpolate:a.interpolate,projection:b,reprojectionErrorThreshold:a.reprojectionErrorThreshold,tileGrid:c,tileLoadFunction:a.tileLoadFunction,tilePixelRatio:a.tilePixelRatio,tileUrlFunction:a.tileUrlFunction,url:a.url,urls:a.urls,wrapX:void 0===a.wrapX||a.wrapX,transition:a.transition,attributionsCollapsible:a.attributionsCollapsible,zDirection:a.zDirection}),this.gutter_=void 0!==a.gutter?a.gutter:0}getGutter(){return this.gutter_}},g_=class extends g${constructor(a){let b;b=void 0!==(a=a||{}).attributions?a.attributions:['&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.'];const c=void 0!==a.crossOrigin?a.crossOrigin:"anonymous",d=void 0!==a.url?a.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";super({attributions:b,attributionsCollapsible:!1,cacheSize:a.cacheSize,crossOrigin:c,interpolate:a.interpolate,maxZoom:void 0!==a.maxZoom?a.maxZoom:19,reprojectionErrorThreshold:a.reprojectionErrorThreshold,tileLoadFunction:(b,c)=>{let d=b.getImage();!ae&&d instanceof HTMLImageElement&&(d.referrerPolicy="origin-when-cross-origin"),(a.tileLoadFunction||gY)(b,c)},transition:a.transition,url:d,wrapX:a.wrapX,zDirection:a.zDirection})}};a.s(["default",0,g_],19510);let g0=class{drawCustom(a,b,c,d,e){}drawGeometry(a){}setStyle(a){}drawCircle(a,b,c){}drawFeature(a,b,c){}drawGeometryCollection(a,b,c){}drawLineString(a,b,c){}drawMultiLineString(a,b,c){}drawMultiPoint(a,b,c){}drawMultiPolygon(a,b,c){}drawPoint(a,b,c){}drawPolygon(a,b,c){}drawText(a,b,c){}setFillStrokeStyle(a,b){}setImageStyle(a,b){}setTextStyle(a,b){}},g1=0,g2=1,g3=2,g4=3,g5=4,g6=5,g7=6,g8=7,g9=8,ha=9,hb=10,hc=11,hd=12,he=[g9],hf=[hd],hg=[g2],hh=[g4],hi=class extends g0{constructor(a,b,c,d){super(),this.tolerance=a,this.maxExtent=b,this.pixelRatio=d,this.maxLineWidth=0,this.resolution=c,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(a){let b=this.pixelRatio;return 1==b?a:a.map(function(a){return a*b})}appendFlatPointCoordinates(a,b){let c=this.getBufferedMaxExtent(),d=this.tmpCoordinate_,e=this.coordinates,f=e.length;for(let g=0,h=a.length;g<h;g+=b)d[0]=a[g],d[1]=a[g+1],aK(c,d)&&(e[f++]=d[0],e[f++]=d[1]);return f}appendFlatLineCoordinates(a,b,c,d,e,f){let g,h,i,j=this.coordinates,k=j.length,l=this.getBufferedMaxExtent();f&&(b+=d);let m=a[b],n=a[b+1],o=this.tmpCoordinate_,p=!0;for(g=b+d;g<c;g+=d)o[0]=a[g],o[1]=a[g+1],(i=aN(l,o))!==h?(p&&(j[k++]=m,j[k++]=n,p=!1),j[k++]=o[0],j[k++]=o[1]):1===i?(j[k++]=o[0],j[k++]=o[1],p=!1):p=!0,m=o[0],n=o[1],h=i;return(e&&p||g===b+d)&&(j[k++]=m,j[k++]=n),k}drawCustomCoordinates_(a,b,c,d,e){for(let f=0,g=c.length;f<g;++f){let g=c[f],h=this.appendFlatLineCoordinates(a,b,g,d,!1,!1);e.push(h),b=g}return b}drawCustom(a,b,c,d,e){let f,g,h,i,j;this.beginGeometry(a,b,e);let k=a.getType(),l=a.getStride(),m=this.coordinates.length;switch(k){case"MultiPolygon":f=a.getOrientedFlatCoordinates(),i=[];let n=a.getEndss();j=0;for(let a=0,b=n.length;a<b;++a){let b=[];j=this.drawCustomCoordinates_(f,j,n[a],l,b),i.push(b)}this.instructions.push([g5,m,i,a,c,cy,e]),this.hitDetectionInstructions.push([g5,m,i,a,d||c,cy,e]);break;case"Polygon":case"MultiLineString":h=[],f="Polygon"==k?a.getOrientedFlatCoordinates():a.getFlatCoordinates(),j=this.drawCustomCoordinates_(f,0,a.getEnds(),l,h),this.instructions.push([g5,m,h,a,c,cx,e]),this.hitDetectionInstructions.push([g5,m,h,a,d||c,cx,e]);break;case"LineString":case"Circle":f=a.getFlatCoordinates(),g=this.appendFlatLineCoordinates(f,0,f.length,l,!1,!1),this.instructions.push([g5,m,g,a,c,cw,e]),this.hitDetectionInstructions.push([g5,m,g,a,d||c,cw,e]);break;case"MultiPoint":f=a.getFlatCoordinates(),(g=this.appendFlatPointCoordinates(f,l))>m&&(this.instructions.push([g5,m,g,a,c,cw,e]),this.hitDetectionInstructions.push([g5,m,g,a,d||c,cw,e]));break;case"Point":f=a.getFlatCoordinates(),this.coordinates.push(f[0],f[1]),g=this.coordinates.length,this.instructions.push([g5,m,g,a,c,void 0,e]),this.hitDetectionInstructions.push([g5,m,g,a,d||c,void 0,e])}this.endGeometry(b)}beginGeometry(a,b,c){this.beginGeometryInstruction1_=[g1,b,0,a,c],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[g1,b,0,a,c],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){let a,b,c,d=this.hitDetectionInstructions;d.reverse();let e=d.length,f=-1;for(a=0;a<e;++a)if((c=(b=d[a])[0])==g8)f=a;else if(c==g1){b[2]=a;for(var g=this.hitDetectionInstructions,h=f,i=a;h<i;){let a=g[h];g[h]=g[i],g[i]=a,++h,--i}f=-1}}fillStyleToState(a,b={}){if(a){let c=a.getColor();b.fillPatternScale=c&&"object"==typeof c&&"src"in c?this.pixelRatio:1,b.fillStyle=fk(c||fm)}else b.fillStyle=void 0;return b}strokeStyleToState(a,b={}){if(a){b.strokeStyle=fk(a.getColor()||fq);let c=a.getLineCap();b.lineCap=void 0!==c?c:fn;let d=a.getLineDash();b.lineDash=d?d.slice():fo,b.lineDashOffset=a.getLineDashOffset()||0;let e=a.getLineJoin();b.lineJoin=void 0!==e?e:fp;let f=a.getWidth();b.lineWidth=void 0!==f?f:1;let g=a.getMiterLimit();b.miterLimit=void 0!==g?g:10,b.lineWidth>this.maxLineWidth&&(this.maxLineWidth=b.lineWidth,this.bufferedMaxExtent_=null)}else b.strokeStyle=void 0,b.lineCap=void 0,b.lineDash=null,b.lineDashOffset=void 0,b.lineJoin=void 0,b.lineWidth=void 0,b.miterLimit=void 0;return b}setFillStrokeStyle(a,b){let c=this.state;this.fillStyleToState(a,c),this.strokeStyleToState(b,c)}createFill(a){let b=a.fillStyle,c=[hb,b];return"string"!=typeof b&&c.push(a.fillPatternScale),c}applyStroke(a){this.instructions.push(this.createStroke(a))}createStroke(a){return[hc,a.strokeStyle,a.lineWidth*this.pixelRatio,a.lineCap,a.lineJoin,a.miterLimit,a.lineDash?this.applyPixelRatio(a.lineDash):null,a.lineDashOffset*this.pixelRatio]}updateFillStyle(a,b){let c=a.fillStyle;("string"!=typeof c||a.currentFillStyle!=c)&&(this.instructions.push(b.call(this,a)),a.currentFillStyle=c)}updateStrokeStyle(a,b){let c=a.strokeStyle,d=a.lineCap,e=a.lineDash,f=a.lineDashOffset,g=a.lineJoin,h=a.lineWidth,i=a.miterLimit;a.currentStrokeStyle==c&&a.currentLineCap==d&&(e==a.currentLineDash||E(a.currentLineDash,e))&&a.currentLineDashOffset==f&&a.currentLineJoin==g&&a.currentLineWidth==h&&a.currentMiterLimit==i||(b.call(this,a),a.currentStrokeStyle=c,a.currentLineCap=d,a.currentLineDash=e,a.currentLineDashOffset=f,a.currentLineJoin=g,a.currentLineWidth=h,a.currentMiterLimit=i)}endGeometry(a){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;let b=[g8,a];this.instructions.push(b),this.hitDetectionInstructions.push(b)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=aI(this.maxExtent),this.maxLineWidth>0)){let a=this.resolution*(this.maxLineWidth+1)/2;aH(this.bufferedMaxExtent_,a,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}},hj=class extends hi{constructor(a,b,c,d){super(a,b,c,d),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(a,b,c){if(!this.image_||this.maxExtent&&!aK(this.maxExtent,a.getFlatCoordinates()))return;this.beginGeometry(a,b,c);let d=a.getFlatCoordinates(),e=a.getStride(),f=this.coordinates.length,g=this.appendFlatPointCoordinates(d,e);this.instructions.push([g7,f,g,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([g7,f,g,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(b)}drawMultiPoint(a,b,c){if(!this.image_)return;this.beginGeometry(a,b,c);let d=a.getFlatCoordinates(),e=[];for(let b=0,c=d.length;b<c;b+=a.getStride())(!this.maxExtent||aK(this.maxExtent,d.slice(b,b+2)))&&e.push(d[b],d[b+1]);let f=this.coordinates.length,g=this.appendFlatPointCoordinates(e,2);this.instructions.push([g7,f,g,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([g7,f,g,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(b)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(a,b){let c=a.getAnchor(),d=a.getSize(),e=a.getOrigin();this.imagePixelRatio_=a.getPixelRatio(this.pixelRatio),this.anchorX_=c[0],this.anchorY_=c[1],this.hitDetectionImage_=a.getHitDetectionImage(),this.image_=a.getImage(this.pixelRatio),this.height_=d[1],this.opacity_=a.getOpacity(),this.originX_=e[0],this.originY_=e[1],this.rotateWithView_=a.getRotateWithView(),this.rotation_=a.getRotation(),this.scale_=a.getScaleArray(),this.width_=d[0],this.declutterMode_=a.getDeclutterMode(),this.declutterImageWithText_=b}},hk=class extends hi{constructor(a,b,c,d){super(a,b,c,d)}drawFlatCoordinates_(a,b,c,d){let e=this.coordinates.length,f=this.appendFlatLineCoordinates(a,b,c,d,!1,!1),g=[ha,e,f];return this.instructions.push(g),this.hitDetectionInstructions.push(g),c}drawLineString(a,b,c){let d=this.state,e=d.strokeStyle,f=d.lineWidth;if(void 0===e||void 0===f)return;this.updateStrokeStyle(d,this.applyStroke),this.beginGeometry(a,b,c),this.hitDetectionInstructions.push([hc,d.strokeStyle,d.lineWidth,d.lineCap,d.lineJoin,d.miterLimit,fo,0],hg);let g=a.getFlatCoordinates(),h=a.getStride();this.drawFlatCoordinates_(g,0,g.length,h),this.hitDetectionInstructions.push(hf),this.endGeometry(b)}drawMultiLineString(a,b,c){let d=this.state,e=d.strokeStyle,f=d.lineWidth;if(void 0===e||void 0===f)return;this.updateStrokeStyle(d,this.applyStroke),this.beginGeometry(a,b,c),this.hitDetectionInstructions.push([hc,d.strokeStyle,d.lineWidth,d.lineCap,d.lineJoin,d.miterLimit,fo,0],hg);let g=a.getEnds(),h=a.getFlatCoordinates(),i=a.getStride(),j=0;for(let a=0,b=g.length;a<b;++a)j=this.drawFlatCoordinates_(h,j,g[a],i);this.hitDetectionInstructions.push(hf),this.endGeometry(b)}finish(){let a=this.state;return void 0!=a.lastStroke&&a.lastStroke!=this.coordinates.length&&this.instructions.push(hf),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(a){void 0!=a.lastStroke&&a.lastStroke!=this.coordinates.length&&(this.instructions.push(hf),a.lastStroke=this.coordinates.length),a.lastStroke=0,super.applyStroke(a),this.instructions.push(hg)}},hl=class extends hi{constructor(a,b,c,d){super(a,b,c,d)}drawFlatCoordinatess_(a,b,c,d){let e=this.state,f=void 0!==e.fillStyle,g=void 0!==e.strokeStyle,h=c.length;this.instructions.push(hg),this.hitDetectionInstructions.push(hg);for(let e=0;e<h;++e){let f=c[e],h=this.coordinates.length,i=this.appendFlatLineCoordinates(a,b,f,d,!0,!g),j=[ha,h,i];this.instructions.push(j),this.hitDetectionInstructions.push(j),g&&(this.instructions.push(hh),this.hitDetectionInstructions.push(hh)),b=f}return f&&(this.instructions.push(he),this.hitDetectionInstructions.push(he)),g&&(this.instructions.push(hf),this.hitDetectionInstructions.push(hf)),b}drawCircle(a,b,c){let d=this.state,e=d.fillStyle,f=d.strokeStyle;if(void 0===e&&void 0===f)return;this.setFillStrokeStyles_(),this.beginGeometry(a,b,c),void 0!==d.fillStyle&&this.hitDetectionInstructions.push([hb,fm]),void 0!==d.strokeStyle&&this.hitDetectionInstructions.push([hc,d.strokeStyle,d.lineWidth,d.lineCap,d.lineJoin,d.miterLimit,fo,0]);let g=a.getFlatCoordinates(),h=a.getStride(),i=this.coordinates.length;this.appendFlatLineCoordinates(g,0,g.length,h,!1,!1);let j=[g3,i];this.instructions.push(hg,j),this.hitDetectionInstructions.push(hg,j),void 0!==d.fillStyle&&(this.instructions.push(he),this.hitDetectionInstructions.push(he)),void 0!==d.strokeStyle&&(this.instructions.push(hf),this.hitDetectionInstructions.push(hf)),this.endGeometry(b)}drawPolygon(a,b,c){let d=this.state,e=d.fillStyle,f=d.strokeStyle;if(void 0===e&&void 0===f)return;this.setFillStrokeStyles_(),this.beginGeometry(a,b,c),void 0!==d.fillStyle&&this.hitDetectionInstructions.push([hb,fm]),void 0!==d.strokeStyle&&this.hitDetectionInstructions.push([hc,d.strokeStyle,d.lineWidth,d.lineCap,d.lineJoin,d.miterLimit,fo,0]);let g=a.getEnds(),h=a.getOrientedFlatCoordinates(),i=a.getStride();this.drawFlatCoordinatess_(h,0,g,i),this.endGeometry(b)}drawMultiPolygon(a,b,c){let d=this.state,e=d.fillStyle,f=d.strokeStyle;if(void 0===e&&void 0===f)return;this.setFillStrokeStyles_(),this.beginGeometry(a,b,c),void 0!==d.fillStyle&&this.hitDetectionInstructions.push([hb,fm]),void 0!==d.strokeStyle&&this.hitDetectionInstructions.push([hc,d.strokeStyle,d.lineWidth,d.lineCap,d.lineJoin,d.miterLimit,fo,0]);let g=a.getEndss(),h=a.getOrientedFlatCoordinates(),i=a.getStride(),j=0;for(let a=0,b=g.length;a<b;++a)j=this.drawFlatCoordinatess_(h,j,g[a],i);this.endGeometry(b)}finish(){this.reverseHitDetectionInstructions(),this.state=null;let a=this.tolerance;if(0!==a){let b=this.coordinates;for(let c=0,d=b.length;c<d;++c)b[c]=cA(b[c],a)}return super.finish()}setFillStrokeStyles_(){let a=this.state;this.updateFillStyle(a,this.createFill),this.updateStrokeStyle(a,this.applyStroke)}},hm={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1},hn=class extends hi{constructor(a,b,c,d){super(a,b,c,d),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textKeepUpright_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[fm]={fillStyle:fm},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){let a=super.finish();return a.textStates=this.textStates,a.fillStates=this.fillStates,a.strokeStates=this.strokeStates,a}drawText(a,b,c){let d=this.textFillState_,e=this.textStrokeState_,f=this.textState_;if(""===this.text_||!f||!d&&!e)return;let g=this.coordinates,h=g.length,i=a.getType(),j=null,k=a.getStride();if("line"===f.placement&&("LineString"==i||"MultiLineString"==i||"Polygon"==i||"MultiPolygon"==i)){let d;if(!a5(this.maxExtent,a.getExtent()))return;if(j=a.getFlatCoordinates(),"LineString"==i)d=[j.length];else if("MultiLineString"==i)d=a.getEnds();else if("Polygon"==i)d=a.getEnds().slice(0,1);else if("MultiPolygon"==i){let b=a.getEndss();d=[];for(let a=0,c=b.length;a<c;++a)d.push(b[a][0])}this.beginGeometry(a,b,c);let e=f.repeat,l=e?void 0:f.textAlign,m=0;for(let a=0,b=d.length;a<b;++a){let b;b=e?function(a,b,c,d,e){let f=[],g=c,h=0,i=b.slice(c,2);for(;h<a&&g+e<d;){let[c,d]=i.slice(-2),j=b[g+e],k=b[g+e+1],l=Math.sqrt((j-c)*(j-c)+(k-d)*(k-d));if((h+=l)>=a){let b=(a-h+l)/l,m=c+b*(j-c),n=d+b*(k-d);i.push(m,n),f.push(i),i=[m,n],h==a&&(g+=e),h=0}else if(h<a)i.push(b[g+e],b[g+e+1]),g+=e;else{let a=l-h,b=c+a/l*(j-c),m=d+a/l*(k-d);i.push(b,m),f.push(i),i=[b,m],h=0,g+=e}}return h>0&&f.push(i),f}(e*this.resolution,j,m,d[a],k):[j.slice(m,d[a])];for(let c=0,e=b.length;c<e;++c){let e=b[c],i=0,j=e.length;if(void 0==l){let a=function(a,b,c,d,e){let f,g,h,i,j,k,l,m,n,o=0,p=0,q=0,r=0,s=0;for(f=0;f<d;f+=2){let c=b[f],d=b[f+1];void 0!==i&&(h=Math.sqrt((m=c-i)*m+(n=d-j)*n),void 0!==k&&(r+=g,Math.acos((k*m+l*n)/(g*h))>a&&(r>q&&(q=r,o=s,p=f),r=0,s=f-2)),g=h,k=m,l=n),i=c,j=d}return(r+=h)>q?[s,f]:[o,p]}(f.maxAngle,e,0,e.length,0);i=a[0],j=a[1]}for(let a=i;a<j;a+=k)g.push(e[a],e[a+1]);let n=g.length;m=d[a],this.drawChars_(h,n),h=n}}this.endGeometry(b)}else{let d=f.overflow?null:[];switch(i){case"Point":case"MultiPoint":j=a.getFlatCoordinates();break;case"LineString":j=a.getFlatMidpoint();break;case"Circle":j=a.getCenter();break;case"MultiLineString":j=a.getFlatMidpoints(),k=2;break;case"Polygon":j=a.getFlatInteriorPoint(),f.overflow||d.push(j[2]/this.resolution),k=3;break;case"MultiPolygon":let e=a.getFlatInteriorPoints();j=[];for(let a=0,b=e.length;a<b;a+=3)f.overflow||d.push(e[a+2]/this.resolution),j.push(e[a],e[a+1]);if(0===j.length)return;k=2}let l=this.appendFlatPointCoordinates(j,k);if(l===h)return;if(d&&(l-h)/2!=j.length/k){let a=h/2;d=d.filter((b,c)=>{let d=g[(a+c)*2]===j[c*k]&&g[(a+c)*2+1]===j[c*k+1];return!d&&--a,d})}this.saveTextStates_();let m=f.backgroundFill?this.createFill(this.fillStyleToState(f.backgroundFill)):null,n=f.backgroundStroke?this.createStroke(this.strokeStyleToState(f.backgroundStroke)):null;this.beginGeometry(a,b,c);let o=f.padding;if(o!=ft&&(f.scale[0]<0||f.scale[1]<0)){let a=f.padding[0],b=f.padding[1],c=f.padding[2],d=f.padding[3];f.scale[0]<0&&(b=-b,d=-d),f.scale[1]<0&&(a=-a,c=-c),o=[a,b,c,d]}let p=this.pixelRatio;this.instructions.push([g7,h,l,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,o==ft?ft:o.map(function(a){return a*p}),m,n,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,d]);let q=1/p,r=m?m.slice(0):null;r&&(r[1]=fm),this.hitDetectionInstructions.push([g7,h,l,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[q,q],NaN,this.declutterMode_,this.declutterImageWithText_,o,r,n,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?fm:this.fillKey_,this.textOffsetX_,this.textOffsetY_,d]),this.endGeometry(b)}}saveTextStates_(){let a=this.textStrokeState_,b=this.textState_,c=this.textFillState_,d=this.strokeKey_;!a||d in this.strokeStates||(this.strokeStates[d]={strokeStyle:a.strokeStyle,lineCap:a.lineCap,lineDashOffset:a.lineDashOffset,lineWidth:a.lineWidth,lineJoin:a.lineJoin,miterLimit:a.miterLimit,lineDash:a.lineDash});let e=this.textKey_;e in this.textStates||(this.textStates[e]={font:b.font,textAlign:b.textAlign||fr,justify:b.justify,textBaseline:b.textBaseline||fs,scale:b.scale});let f=this.fillKey_;!c||f in this.fillStates||(this.fillStates[f]={fillStyle:c.fillStyle})}drawChars_(a,b){let c=this.textStrokeState_,d=this.textState_,e=this.strokeKey_,f=this.textKey_,g=this.fillKey_;this.saveTextStates_();let h=this.pixelRatio,i=hm[d.textBaseline],j=this.textOffsetY_*h,k=this.text_,l=c?c.lineWidth*Math.abs(d.scale[0])/2:0;this.instructions.push([g6,a,b,i,d.overflow,g,d.maxAngle,h,j,e,l*h,k,f,1,this.declutterMode_,this.textKeepUpright_]),this.hitDetectionInstructions.push([g6,a,b,i,d.overflow,g?fm:g,d.maxAngle,h,j,e,l*h,k,f,1/h,this.declutterMode_,this.textKeepUpright_])}setTextStyle(a,b){let c,d,e;if(a){let b=a.getFill();b?((d=this.textFillState_)||(d={},this.textFillState_=d),d.fillStyle=fk(b.getColor()||fm)):(d=null,this.textFillState_=d);let f=a.getStroke();if(f){(e=this.textStrokeState_)||(e={},this.textStrokeState_=e);let a=f.getLineDash(),b=f.getLineDashOffset(),c=f.getWidth(),d=f.getMiterLimit();e.lineCap=f.getLineCap()||fn,e.lineDash=a?a.slice():fo,e.lineDashOffset=void 0===b?0:b,e.lineJoin=f.getLineJoin()||fp,e.lineWidth=void 0===c?1:c,e.miterLimit=void 0===d?10:d,e.strokeStyle=fk(f.getColor()||fq)}else e=null,this.textStrokeState_=e;c=this.textState_;let g=a.getFont()||fl;fy(g);let h=a.getScaleArray();c.overflow=a.getOverflow(),c.font=g,c.maxAngle=a.getMaxAngle(),c.placement=a.getPlacement(),c.textAlign=a.getTextAlign(),c.repeat=a.getRepeat(),c.justify=a.getJustify(),c.textBaseline=a.getTextBaseline()||fs,c.backgroundFill=a.getBackgroundFill(),c.backgroundStroke=a.getBackgroundStroke(),c.padding=a.getPadding()||ft,c.scale=void 0===h?[1,1]:h;let i=a.getOffsetX(),j=a.getOffsetY(),k=a.getRotateWithView(),l=a.getKeepUpright(),m=a.getRotation();this.text_=a.getText()||"",this.textOffsetX_=void 0===i?0:i,this.textOffsetY_=void 0===j?0:j,this.textRotateWithView_=void 0!==k&&k,this.textKeepUpright_=void 0===l||l,this.textRotation_=void 0===m?0:m,this.strokeKey_=e?("string"==typeof e.strokeStyle?e.strokeStyle:T(e.strokeStyle))+e.lineCap+e.lineDashOffset+"|"+e.lineWidth+e.lineJoin+e.miterLimit+"["+e.lineDash.join()+"]":"",this.textKey_=c.font+c.scale+(c.textAlign||"?")+(c.repeat||"?")+(c.justify||"?")+(c.textBaseline||"?"),this.fillKey_=d&&d.fillStyle?"string"==typeof d.fillStyle?d.fillStyle:"|"+T(d.fillStyle):""}else this.text_="";this.declutterMode_=a.getDeclutterMode(),this.declutterImageWithText_=b}},ho={Circle:hl,Default:hi,Image:hj,LineString:hk,Polygon:hl,Text:hn},hp=class{constructor(a,b,c,d){this.tolerance_=a,this.maxExtent_=b,this.pixelRatio_=d,this.resolution_=c,this.buildersByZIndex_={}}finish(){let a={};for(let b in this.buildersByZIndex_){a[b]=a[b]||{};let c=this.buildersByZIndex_[b];for(let d in c){let e=c[d].finish();a[b][d]=e}}return a}getBuilder(a,b){let c=void 0!==a?a.toString():"0",d=this.buildersByZIndex_[c];void 0===d&&(d={},this.buildersByZIndex_[c]=d);let e=d[b];return void 0===e&&(e=new ho[b](this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),d[b]=e),e}};function hq(a,b,c,d){let e=a[b],f=a[b+1],g=0;for(let h=b+d;h<c;h+=d){let b=a[h],c=a[h+1];g+=Math.sqrt((b-e)*(b-e)+(c-f)*(c-f)),e=b,f=c}return g}let hr=aO(),hs=[],ht=[],hu=[],hv=[];function hw(a){return a[3].declutterBox}let hx=RegExp("["+String.fromCharCode(1425)+"-"+String.fromCharCode(2303)+String.fromCharCode(64285)+"-"+String.fromCharCode(65023)+String.fromCharCode(65136)+"-"+String.fromCharCode(65276)+String.fromCharCode(67584)+"-"+String.fromCharCode(69631)+String.fromCharCode(124928)+"-"+String.fromCharCode(126975)+"]");function hy(a,b){return"start"===b?b=hx.test(a)?"right":"left":"end"===b&&(b=hx.test(a)?"left":"right"),hm[b]}function hz(a,b,c){return c>0&&a.push("\n",""),a.push(b,""),a}function hA(a,b,c){return c%2==0&&(a+=b),a}let hB=class{constructor(a,b,c,d,e){this.overlaps=c,this.pixelRatio=b,this.resolution=a,this.alignAndScaleFill_,this.instructions=d.instructions,this.coordinates=d.coordinates,this.coordinateCache_={},this.renderedTransform_=ce(),this.hitDetectionInstructions=d.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=d.fillStates||{},this.strokeStates=d.strokeStates||{},this.textStates=d.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=e?new gy:null}getZIndexContext(){return this.zIndexContext_}createLabel(a,b,c,d){let e,f=a+b+c+d;if(this.labels_[f])return this.labels_[f];let g=d?this.strokeStates[d]:null,h=c?this.fillStates[c]:null,i=this.textStates[b],j=this.pixelRatio,k=[i.scale[0]*j,i.scale[1]*j],l=i.justify?hm[i.justify]:hy(Array.isArray(a)?a[0]:a,i.textAlign||fr),m=d&&g.lineWidth?g.lineWidth:0,n=Array.isArray(a)?a:String(a).split("\n").reduce(hz,[]),{width:o,height:p,widths:q,heights:r,lineWidths:s}=function(a,b){let c=[],d=[],e=[],f=0,g=0,h=0,i=0;for(let j=0,k=b.length;j<=k;j+=2){let l=b[j];if("\n"===l||j===k){f=Math.max(f,g),e.push(g),g=0,h+=i,i=0;continue}let m=b[j+1]||a.font,n=fA(m,l).width;c.push(n),g+=n;let o=fz(m);d.push(o),i=Math.max(i,o)}return{width:f,height:h,widths:c,heights:d,lineWidths:e}}(i,n),t=o+m,u=[],v=(t+2)*k[0],w=(p+m)*k[1],x={width:v<0?Math.floor(v):Math.ceil(v),height:w<0?Math.floor(w):Math.ceil(w),contextInstructions:u};(1!=k[0]||1!=k[1])&&u.push("scale",k),d&&(u.push("strokeStyle",g.strokeStyle),u.push("lineWidth",m),u.push("lineCap",g.lineCap),u.push("lineJoin",g.lineJoin),u.push("miterLimit",g.miterLimit),u.push("setLineDash",[g.lineDash]),u.push("lineDashOffset",g.lineDashOffset)),c&&u.push("fillStyle",h.fillStyle),u.push("textBaseline","middle"),u.push("textAlign","center");let y=.5-l,z=l*t+y*m,A=[],B=[],C=0,D=0,E=0,F=0;for(let a=0,b=n.length;a<b;a+=2){let b=n[a];if("\n"===b){D+=C,C=0,z=l*t+y*m,++F;continue}let f=n[a+1]||i.font;f!==e&&(d&&A.push("font",f),c&&B.push("font",f),e=f),C=Math.max(C,r[E]);let g=[b,z+y*q[E]+l*(q[E]-s[F]),.5*(m+C)+D];z+=q[E],d&&A.push("strokeText",g),c&&B.push("fillText",g),++E}return Array.prototype.push.apply(u,A),Array.prototype.push.apply(u,B),this.labels_[f]=x,x}replayTextBackground_(a,b,c,d,e,f,g){a.beginPath(),a.moveTo.apply(a,b),a.lineTo.apply(a,c),a.lineTo.apply(a,d),a.lineTo.apply(a,e),a.lineTo.apply(a,b),f&&(this.alignAndScaleFill_=f[2],a.fillStyle=f[1],this.fill_(a)),g&&(this.setStrokeStyle_(a,g),a.stroke())}calculateImageOrLabelDimensions_(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){let q;g*=l[0],h*=l[1];let r=c-g,s=d-h,t=e+i>a?a-i:e,u=f+j>b?b-j:f,v=n[3]+t*l[0]+n[1],w=n[0]+u*l[1]+n[2],x=r-n[3],y=s-n[0];return(o||0!==k)&&(hs[0]=x,hv[0]=x,hs[1]=y,ht[1]=y,ht[0]=x+v,hu[0]=ht[0],hu[1]=y+w,hv[1]=hu[1]),0!==k?(cf(q=cg(ce(),c,d,1,1,k,-c,-d),hs),cf(q,ht),cf(q,hu),cf(q,hv),aP(Math.min(hs[0],ht[0],hu[0],hv[0]),Math.min(hs[1],ht[1],hu[1],hv[1]),Math.max(hs[0],ht[0],hu[0],hv[0]),Math.max(hs[1],ht[1],hu[1],hv[1]),hr)):aP(Math.min(x,x+v),Math.min(y,y+w),Math.max(x,x+v),Math.max(y,y+w),hr),m&&(r=Math.round(r),s=Math.round(s)),{drawImageX:r,drawImageY:s,drawImageW:t,drawImageH:u,originX:i,originY:j,declutterBox:{minX:hr[0],minY:hr[1],maxX:hr[2],maxY:hr[3],value:p},canvasTransform:q,scale:l}}replayImageOrLabel_(a,b,c,d,e,f,g){let h=!!(f||g),i=d.declutterBox,j=g?g[2]*d.scale[0]/2:0;if(i.minX-j<=b[0]&&i.maxX+j>=0&&i.minY-j<=b[1]&&i.maxY+j>=0){var k,l,m,n,o,p,q,r;h&&this.replayTextBackground_(a,hs,ht,hu,hv,f,g),k=d.canvasTransform,l=d.originX,m=d.originY,n=d.drawImageW,o=d.drawImageH,p=d.drawImageX,q=d.drawImageY,r=d.scale,a.save(),1!==e&&(void 0===a.globalAlpha?a.globalAlpha=a=>a.globalAlpha*=e:a.globalAlpha*=e),k&&a.transform.apply(a,k),c.contextInstructions?(a.translate(p,q),a.scale(r[0],r[1]),function(a,b){let c=a.contextInstructions;for(let a=0,d=c.length;a<d;a+=2)Array.isArray(c[a+1])?b[c[a]].apply(b,c[a+1]):b[c[a]]=c[a+1]}(c,a)):r[0]<0||r[1]<0?(a.translate(p,q),a.scale(r[0],r[1]),a.drawImage(c,l,m,n,o,0,0,n,o)):a.drawImage(c,l,m,n,o,p,q,n*r[0],o*r[1]),a.restore()}return!0}fill_(a){let b=this.alignAndScaleFill_;if(b){let c=cf(this.renderedTransform_,[0,0]),d=512*this.pixelRatio;a.save(),a.translate(c[0]%d,c[1]%d),1!==b&&a.scale(b,b),a.rotate(this.viewRotation_)}a.fill(),b&&a.restore()}setStrokeStyle_(a,b){a.strokeStyle=b[1],b[1]&&(a.lineWidth=b[2],a.lineCap=b[3],a.lineJoin=b[4],a.miterLimit=b[5],a.lineDashOffset=b[7],a.setLineDash(b[6]))}drawLabelWithPointPlacement_(a,b,c,d){let e=this.textStates[b],f=this.createLabel(a,b,d,c),g=this.strokeStates[c],h=this.pixelRatio,i=hy(Array.isArray(a)?a[0]:a,e.textAlign||fr),j=hm[e.textBaseline||fs],k=g&&g.lineWidth?g.lineWidth:0,l=f.width/h-2*e.scale[0],m=j*f.height/h+2*(.5-j)*k;return{label:f,anchorX:i*l+2*(.5-i)*k,anchorY:m}}execute_(a,b,c,d,e,f,g,h){let i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A=this.zIndexContext_;if(this.pixelCoordinates_&&E(c,this.renderedTransform_))i=this.pixelCoordinates_;else{var B;this.pixelCoordinates_||(this.pixelCoordinates_=[]),i=ck(this.coordinates,0,this.coordinates.length,2,c,this.pixelCoordinates_),B=this.renderedTransform_,B[0]=c[0],B[1]=c[1],B[2]=c[2],B[3]=c[3],B[4]=c[4],B[5]=c[5]}let C=0,D=d.length,F=0,G=0,H=0,I=this.coordinateCache_,J=this.viewRotation_,K=Math.round(1e12*Math.atan2(-c[1],c[0]))/1e12,L={context:a,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:J},M=this.instructions!=d||this.overlaps?0:200;for(;C<D;){let c=d[C];switch(c[0]){case g1:w=c[1],z=c[3],w.getGeometry()?void 0===g||a5(g,z.getExtent())?++C:C=c[2]+1:C=c[2],A&&(A.zIndex=c[4]);break;case g2:G>M&&(this.fill_(a),G=0),H>M&&(a.stroke(),H=0),G||H||(a.beginPath(),n=NaN,o=NaN),++C;break;case g3:let B=i[F=c[1]],D=i[F+1],E=i[F+2],N=i[F+3],O=E-B,P=N-D,Q=Math.sqrt(O*O+P*P);a.moveTo(B+Q,D),a.arc(B,D,Q,0,2*Math.PI,!0),++C;break;case g4:a.closePath(),++C;break;case g5:F=c[1],j=c[2];let R=c[3],S=c[4],T=c[5];L.geometry=R,L.feature=w,C in I||(I[C]=[]);let U=I[C];T?T(i,F,j,2,U):(U[0]=i[F],U[1]=i[F+1],U.length=2),A&&(A.zIndex=c[6]),S(U,L),++C;break;case g7:let V,W,X,Y;F=c[1],j=c[2],r=c[3],k=c[4],l=c[5];let Z=c[6],$=c[7],_=c[8],aa=c[9],ab=c[10],ac=c[11],ad=c[12],ae=c[13];m=c[14]||"declutter";let af=c[15];if(!r&&c.length>=20){s=c[19],t=c[20],u=c[21],v=c[22];let a=this.drawLabelWithPointPlacement_(s,t,u,v);r=a.label,c[3]=r;let b=c[23];k=(a.anchorX-b)*this.pixelRatio,c[4]=k;let d=c[24];l=(a.anchorY-d)*this.pixelRatio,c[5]=l,Z=r.height,c[6]=Z,ae=r.width,c[13]=ae}c.length>25&&(V=c[25]),c.length>17?(W=c[16],X=c[17],Y=c[18]):(W=ft,X=null,Y=null),ab&&K?ac+=J:ab||K||(ac-=J);let ag=0;for(;F<j;F+=2){if(V&&V[ag++]<ae/this.pixelRatio)continue;let c=this.calculateImageOrLabelDimensions_(r.width,r.height,i[F],i[F+1],ae,Z,k,l,_,aa,ac,ad,e,W,!!X||!!Y,w),d=[a,b,r,c,$,X,Y];if(h){let a,b,e,f,g;if(af){let c=j-F;if(!af[c]){af[c]={args:d,declutterMode:m};continue}let f=af[c];a=f.args,b=f.declutterMode,delete af[c],e=hw(a)}if(a&&("declutter"!==b||!h.collides(e))&&(f=!0),"declutter"===m&&h.collides(c.declutterBox)||(g=!0),"declutter"===b&&"declutter"===m){let a=f&&g;f=a,g=a}f&&("none"!==b&&h.insert(e),this.replayImageOrLabel_.apply(this,a)),g&&("none"!==m&&h.insert(c.declutterBox),this.replayImageOrLabel_.apply(this,d))}else this.replayImageOrLabel_.apply(this,d)}++C;break;case g6:let ah,ai=c[1],aj=c[2],ak=c[3],al=c[4];v=c[5];let am=c[6],an=c[7],ao=c[8];u=c[9];let ap=c[10];Array.isArray(s=c[11])&&(s=s.reduce(hA,"")),t=c[12];let aq=[c[13],c[13]];m=c[14]||"declutter";let ar=c[15],as=this.textStates[t],at=as.font,au=[as.scale[0]*an,as.scale[1]*an];at in this.widths_?ah=this.widths_[at]:(ah={},this.widths_[at]=ah);let av=hq(i,ai,aj,2),aw=Math.abs(au[0])*fB(at,s,ah);if(al||aw<=av){let c=(av-aw)*hy(s,this.textStates[t].textAlign),d=function(a,b,c,d,e,f,g,h,i,j,k,l,m=!0){var n,o,p,q,r,s;let t,u=a[b],v=a[b+1],w=0,x=0,y=0,z=0;function A(){w=u,x=v,b+=2,u=a[b],v=a[b+1],z+=y,y=Math.sqrt((u-w)*(u-w)+(v-x)*(v-x))}do A();while(b<c-2&&z+y<f)let B=0===y?0:(f-z)/y,C=(n=w)+B*(u-n),D=(o=x)+B*(v-o),E=b-2,F=z,G=f+h*i(j,e,k);for(;b<c-2&&z+y<G;)A();B=0===y?0:(G-z)/y;let H=(p=w)+B*(u-p),I=(q=x)+B*(v-q),J=!1;if(m)if(l){let a=[C,D,H,I];cl(a,0,4,2,l,a,a),J=a[0]>a[2]}else J=C>H;let K=Math.PI,L=[],M=E+2===b;if(b=E,y=0,z=F,u=a[b],v=a[b+1],M){A(),t=Math.atan2(v-x,u-w),J&&(t+=t>0?-K:K);let a=(H+C)/2,b=(I+D)/2;return L[0]=[a,b,(G-f)/2,t,e],L}e=e.replace(/\n/g," ");for(let a=0,d=e.length;a<d;){A();let l=Math.atan2(v-x,u-w);if(J&&(l+=l>0?-K:K),void 0!==t){let a=l-t;if(Math.abs(a+=a>K?-2*K:a<-K?2*K:0)>g)return null}t=l;let m=a,n=0;for(;a<d;++a){let g=h*i(j,e[J?d-a-1:a],k);if(b+2<c&&z+y<f+n+g/2)break;n+=g}if(a===m)continue;let o=J?e.substring(d-m,d-a):e.substring(m,a);B=0===y?0:(f+n/2-z)/y;let p=(r=w)+B*(u-r),q=(s=x)+B*(v-s);L.push([p,q,n/2,l,o]),f+=n}return L}(i,ai,aj,0,s,c,am,Math.abs(au[0]),fB,at,ah,K?0:this.viewRotation_,ar);a:if(d){let c,e,f,g,i,j=[];if(u)for(c=0,e=d.length;c<e;++c){f=(i=d[c])[4],g=this.createLabel(f,t,"",u),k=i[2]+(au[0]<0?-ap:ap),l=ak*g.height+(.5-ak)*2*ap*au[1]/au[0]-ao;let e=this.calculateImageOrLabelDimensions_(g.width,g.height,i[0],i[1],g.width,g.height,k,l,0,0,i[3],aq,!1,ft,!1,w);if(h&&"declutter"===m&&h.collides(e.declutterBox))break a;j.push([a,b,g,e,1,null,null])}if(v)for(c=0,e=d.length;c<e;++c){f=(i=d[c])[4],g=this.createLabel(f,t,v,""),k=i[2],l=ak*g.height-ao;let e=this.calculateImageOrLabelDimensions_(g.width,g.height,i[0],i[1],g.width,g.height,k,l,0,0,i[3],aq,!1,ft,!1,w);if(h&&"declutter"===m&&h.collides(e.declutterBox))break a;j.push([a,b,g,e,1,null,null])}h&&"none"!==m&&h.load(j.map(hw));for(let a=0,b=j.length;a<b;++a)this.replayImageOrLabel_.apply(this,j[a])}}++C;break;case g8:if(void 0!==f){let a=f(w=c[1],z,m);if(a)return a}++C;break;case g9:M?G++:this.fill_(a),++C;break;case ha:for(F=c[1],j=c[2],x=i[F],y=i[F+1],a.moveTo(x,y),n=x+.5|0,o=y+.5|0,F+=2;F<j;F+=2)x=i[F],y=i[F+1],p=x+.5|0,q=y+.5|0,(F==j-2||p!==n||q!==o)&&(a.lineTo(x,y),n=p,o=q);++C;break;case hb:this.alignAndScaleFill_=c[2],G&&(this.fill_(a),G=0,H&&(a.stroke(),H=0)),a.fillStyle=c[1],++C;break;case hc:H&&(a.stroke(),H=0),this.setStrokeStyle_(a,c),++C;break;case hd:M?H++:a.stroke(),++C;break;default:++C}}G&&this.fill_(a),H&&a.stroke()}execute(a,b,c,d,e,f){this.viewRotation_=d,this.execute_(a,b,c,this.instructions,e,void 0,void 0,f)}executeHitDetection(a,b,c,d,e){return this.viewRotation_=c,this.execute_(a,[a.canvas.width,a.canvas.height],b,this.hitDetectionInstructions,!0,d,e)}},hC=["Polygon","Circle","LineString","Image","Text","Default"],hD=["Image","Text"],hE=hC.filter(a=>!hD.includes(a)),hF={},hG=class{constructor(a,b,c,d,e,f,g){this.maxExtent_=a,this.overlaps_=d,this.pixelRatio_=c,this.resolution_=b,this.renderBuffer_=f,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=ce(),this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(e,g)}clip(a,b){let c=this.getClipCoords(b);a.beginPath(),a.moveTo(c[0],c[1]),a.lineTo(c[2],c[3]),a.lineTo(c[4],c[5]),a.lineTo(c[6],c[7]),a.clip()}createExecutors_(a,b){for(let c in a){let d=this.executorsByZIndex_[c];void 0===d&&(d={},this.executorsByZIndex_[c]=d);let e=a[c];for(let a in e){let c=e[a];d[a]=new hB(this.resolution_,this.pixelRatio_,this.overlaps_,c,b)}}}hasExecutors(a){for(let b in this.executorsByZIndex_){let c=this.executorsByZIndex_[b];for(let b=0,d=a.length;b<d;++b)if(a[b]in c)return!0}return!1}forEachFeatureAtCoordinate(a,b,c,d,e,f){let g,h,i,j,k,l,m,n=2*(d=Math.round(d))+1,o=cg(this.hitDetectionTransform_,d+.5,d+.5,1/b,-1/b,-c,-a[0],-a[1]),p=!this.hitDetectionContext_;p&&(this.hitDetectionContext_=c2(n,n));let q=this.hitDetectionContext_;q.canvas.width!==n||q.canvas.height!==n?(q.canvas.width=n,q.canvas.height=n):p||q.clearRect(0,0,n,n),void 0!==this.renderBuffer_&&(aT(g=aO(),a),aH(g,b*(this.renderBuffer_+d),g));let r=function(a){if(void 0!==hF[a])return hF[a];let b=2*a+1,c=a*a,d=Array(c+1);for(let e=0;e<=a;++e)for(let f=0;f<=a;++f){let g=e*e+f*f;if(g>c)break;let h=d[g];h||(h=[],d[g]=h),h.push(((a+e)*b+(a+f))*4+3),e>0&&h.push(((a-e)*b+(a+f))*4+3),f>0&&(h.push(((a+e)*b+(a-f))*4+3),e>0&&h.push(((a-e)*b+(a-f))*4+3))}let e=[];for(let a=0,b=d.length;a<b;++a)d[a]&&e.push(...d[a]);return hF[a]=e,e}(d);function s(a,b,c){let g=q.getImageData(0,0,n,n).data;for(let i=0,j=r.length;i<j;i++)if(g[r[i]]>0){if(!f||"none"===c||"Image"!==h&&"Text"!==h||f.includes(a)){let c=(r[i]-3)/4,f=d-c%n,g=d-(c/n|0),h=e(a,b,f*f+g*g);if(h)return h}q.clearRect(0,0,n,n);break}}let t=Object.keys(this.executorsByZIndex_).map(Number);for(t.sort(A),i=t.length-1;i>=0;--i){let a=t[i].toString();for(k=this.executorsByZIndex_[a],j=hC.length-1;j>=0;--j)if(void 0!==(l=k[h=hC[j]])&&(m=l.executeHitDetection(q,o,c,s,g)))return m}}getClipCoords(a){let b=this.maxExtent_;if(!b)return null;let c=b[0],d=b[1],e=b[2],f=b[3],g=[c,d,c,f,e,f,e,d];return ck(g,0,8,2,a,g),g}isEmpty(){return K(this.executorsByZIndex_)}execute(a,b,c,d,e,f,g){let h=Object.keys(this.executorsByZIndex_).map(Number);h.sort(g?B:A),f=f||hC;let i=hC.length;for(let j=0,k=h.length;j<k;++j){let k=h[j].toString(),l=this.executorsByZIndex_[k];for(let k=0,m=f.length;k<m;++k){let m=f[k],n=l[m];if(void 0!==n){let f=null===g?void 0:n.getZIndexContext(),k=f?f.getContext():a,l=this.maxExtent_&&"Image"!==m&&"Text"!==m;if(l&&(k.save(),this.clip(k,c)),f&&"Text"!==m&&"Image"!==m?f.pushFunction(a=>n.execute(a,b,c,d,e,g)):n.execute(k,b,c,d,e,g),l&&k.restore(),f){f.offset();let a=h[j]*i+hC.indexOf(m);this.deferredZIndexContexts_[a]||(this.deferredZIndexContexts_[a]=[]),this.deferredZIndexContexts_[a].push(f)}}}}this.renderedContext_=a}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){let a=this.deferredZIndexContexts_,b=Object.keys(a).map(Number).sort(A);for(let c=0,d=b.length;c<d;++c)a[b[c]].forEach(a=>{a.draw(this.renderedContext_),a.clear()}),a[b[c]].length=0}};a.s(["Icon",0,fJ],28681);let hH=class extends g0{constructor(a,b,c,d,e,f,g){super(),this.context_=a,this.pixelRatio_=b,this.extent_=c,this.transform_=d,this.transformRotation_=d?aA(Math.atan2(d[1],d[0]),10):0,this.viewRotation_=e,this.squaredTolerance_=f,this.userTransform_=g,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=ce()}drawImages_(a,b,c,d){if(!this.image_)return;let e=ck(a,b,c,d,this.transform_,this.pixelCoordinates_),f=this.context_,g=this.tmpLocalTransform_,h=f.globalAlpha;1!=this.imageOpacity_&&(f.globalAlpha=h*this.imageOpacity_);let i=this.imageRotation_;0===this.transformRotation_&&(i-=this.viewRotation_),this.imageRotateWithView_&&(i+=this.viewRotation_);for(let a=0,b=e.length;a<b;a+=2){let b=e[a]-this.imageAnchorX_,c=e[a+1]-this.imageAnchorY_;if(0!==i||1!=this.imageScale_[0]||1!=this.imageScale_[1]){let a=b+this.imageAnchorX_,d=c+this.imageAnchorY_;cg(g,a,d,1,1,i,-a,-d),f.save(),f.transform.apply(f,g),f.translate(a,d),f.scale(this.imageScale_[0],this.imageScale_[1]),f.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),f.restore()}else f.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,b,c,this.imageWidth_,this.imageHeight_)}1!=this.imageOpacity_&&(f.globalAlpha=h)}drawText_(a,b,c,d){if(!this.textState_||""===this.text_)return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);let e=ck(a,b,c,d,this.transform_,this.pixelCoordinates_),f=this.context_,g=this.textRotation_;for(0===this.transformRotation_&&(g-=this.viewRotation_),this.textRotateWithView_&&(g+=this.viewRotation_);b<c;b+=d){let a=e[b]+this.textOffsetX_,c=e[b+1]+this.textOffsetY_;0!==g||1!=this.textScale_[0]||1!=this.textScale_[1]?(f.save(),f.translate(a-this.textOffsetX_,c-this.textOffsetY_),f.rotate(g),f.translate(this.textOffsetX_,this.textOffsetY_),f.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&f.strokeText(this.text_,0,0),this.textFillState_&&f.fillText(this.text_,0,0),f.restore()):(this.textStrokeState_&&f.strokeText(this.text_,a,c),this.textFillState_&&f.fillText(this.text_,a,c))}}moveToLineTo_(a,b,c,d,e){let f=this.context_,g=ck(a,b,c,d,this.transform_,this.pixelCoordinates_);f.moveTo(g[0],g[1]);let h=g.length;e&&(h-=2);for(let a=2;a<h;a+=2)f.lineTo(g[a],g[a+1]);return e&&f.closePath(),c}drawRings_(a,b,c,d){for(let e=0,f=c.length;e<f;++e)b=this.moveToLineTo_(a,b,c[e],d,!0);return b}drawCircle(a){if(this.squaredTolerance_&&(a=a.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),a5(this.extent_,a.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);let b=function(a,b,c){let d=a.getFlatCoordinates();if(!d)return null;let e=a.getStride();return ck(d,0,d.length,e,b,c)}(a,this.transform_,this.pixelCoordinates_),c=b[2]-b[0],d=b[3]-b[1],e=Math.sqrt(c*c+d*d),f=this.context_;f.beginPath(),f.arc(b[0],b[1],e,0,2*Math.PI),this.fillState_&&f.fill(),this.strokeState_&&f.stroke()}""!==this.text_&&this.drawText_(a.getCenter(),0,2,2)}}setStyle(a){this.setFillStrokeStyle(a.getFill(),a.getStroke()),this.setImageStyle(a.getImage()),this.setTextStyle(a.getText())}setTransform(a){this.transform_=a}drawGeometry(a){switch(a.getType()){case"Point":this.drawPoint(a);break;case"LineString":this.drawLineString(a);break;case"Polygon":this.drawPolygon(a);break;case"MultiPoint":this.drawMultiPoint(a);break;case"MultiLineString":this.drawMultiLineString(a);break;case"MultiPolygon":this.drawMultiPolygon(a);break;case"GeometryCollection":this.drawGeometryCollection(a);break;case"Circle":this.drawCircle(a)}}drawFeature(a,b){let c=b.getGeometryFunction()(a);c&&(this.setStyle(b),this.drawGeometry(c))}drawGeometryCollection(a){let b=a.getGeometriesArray();for(let a=0,c=b.length;a<c;++a)this.drawGeometry(b[a])}drawPoint(a){this.squaredTolerance_&&(a=a.simplifyTransformed(this.squaredTolerance_,this.userTransform_));let b=a.getFlatCoordinates(),c=a.getStride();this.image_&&this.drawImages_(b,0,b.length,c),""!==this.text_&&this.drawText_(b,0,b.length,c)}drawMultiPoint(a){this.squaredTolerance_&&(a=a.simplifyTransformed(this.squaredTolerance_,this.userTransform_));let b=a.getFlatCoordinates(),c=a.getStride();this.image_&&this.drawImages_(b,0,b.length,c),""!==this.text_&&this.drawText_(b,0,b.length,c)}drawLineString(a){if(this.squaredTolerance_&&(a=a.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),a5(this.extent_,a.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);let b=this.context_,c=a.getFlatCoordinates();b.beginPath(),this.moveToLineTo_(c,0,c.length,a.getStride(),!1),b.stroke()}if(""!==this.text_){let b=a.getFlatMidpoint();this.drawText_(b,0,2,2)}}}drawMultiLineString(a){this.squaredTolerance_&&(a=a.simplifyTransformed(this.squaredTolerance_,this.userTransform_));let b=a.getExtent();if(a5(this.extent_,b)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);let b=this.context_,c=a.getFlatCoordinates(),d=0,e=a.getEnds(),f=a.getStride();b.beginPath();for(let a=0,b=e.length;a<b;++a)d=this.moveToLineTo_(c,d,e[a],f,!1);b.stroke()}if(""!==this.text_){let b=a.getFlatMidpoints();this.drawText_(b,0,b.length,2)}}}drawPolygon(a){if(this.squaredTolerance_&&(a=a.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),a5(this.extent_,a.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);let b=this.context_;b.beginPath(),this.drawRings_(a.getOrientedFlatCoordinates(),0,a.getEnds(),a.getStride()),this.fillState_&&b.fill(),this.strokeState_&&b.stroke()}if(""!==this.text_){let b=a.getFlatInteriorPoint();this.drawText_(b,0,2,2)}}}drawMultiPolygon(a){if(this.squaredTolerance_&&(a=a.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),a5(this.extent_,a.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);let b=this.context_,c=a.getOrientedFlatCoordinates(),d=0,e=a.getEndss(),f=a.getStride();b.beginPath();for(let a=0,b=e.length;a<b;++a){let b=e[a];d=this.drawRings_(c,d,b,f)}this.fillState_&&b.fill(),this.strokeState_&&b.stroke()}if(""!==this.text_){let b=a.getFlatInteriorPoints();this.drawText_(b,0,b.length,2)}}}setContextFillState_(a){let b=this.context_,c=this.contextFillState_;c?c.fillStyle!=a.fillStyle&&(c.fillStyle=a.fillStyle,b.fillStyle=a.fillStyle):(b.fillStyle=a.fillStyle,this.contextFillState_={fillStyle:a.fillStyle})}setContextStrokeState_(a){let b=this.context_,c=this.contextStrokeState_;c?(c.lineCap!=a.lineCap&&(c.lineCap=a.lineCap,b.lineCap=a.lineCap),E(c.lineDash,a.lineDash)||b.setLineDash(c.lineDash=a.lineDash),c.lineDashOffset!=a.lineDashOffset&&(c.lineDashOffset=a.lineDashOffset,b.lineDashOffset=a.lineDashOffset),c.lineJoin!=a.lineJoin&&(c.lineJoin=a.lineJoin,b.lineJoin=a.lineJoin),c.lineWidth!=a.lineWidth&&(c.lineWidth=a.lineWidth,b.lineWidth=a.lineWidth),c.miterLimit!=a.miterLimit&&(c.miterLimit=a.miterLimit,b.miterLimit=a.miterLimit),c.strokeStyle!=a.strokeStyle&&(c.strokeStyle=a.strokeStyle,b.strokeStyle=a.strokeStyle)):(b.lineCap=a.lineCap,b.setLineDash(a.lineDash),b.lineDashOffset=a.lineDashOffset,b.lineJoin=a.lineJoin,b.lineWidth=a.lineWidth,b.miterLimit=a.miterLimit,b.strokeStyle=a.strokeStyle,this.contextStrokeState_={lineCap:a.lineCap,lineDash:a.lineDash,lineDashOffset:a.lineDashOffset,lineJoin:a.lineJoin,lineWidth:a.lineWidth,miterLimit:a.miterLimit,strokeStyle:a.strokeStyle})}setContextTextState_(a){let b=this.context_,c=this.contextTextState_,d=a.textAlign?a.textAlign:fr;c?(c.font!=a.font&&(c.font=a.font,b.font=a.font),c.textAlign!=d&&(c.textAlign=d,b.textAlign=d),c.textBaseline!=a.textBaseline&&(c.textBaseline=a.textBaseline,b.textBaseline=a.textBaseline)):(b.font=a.font,b.textAlign=d,b.textBaseline=a.textBaseline,this.contextTextState_={font:a.font,textAlign:d,textBaseline:a.textBaseline})}setFillStrokeStyle(a,b){if(a){let b=a.getColor();this.fillState_={fillStyle:fk(b||fm)}}else this.fillState_=null;if(b){let a=b.getColor(),c=b.getLineCap(),d=b.getLineDash(),e=b.getLineDashOffset(),f=b.getLineJoin(),g=b.getWidth(),h=b.getMiterLimit(),i=d||fo;this.strokeState_={lineCap:void 0!==c?c:fn,lineDash:1===this.pixelRatio_?i:i.map(a=>a*this.pixelRatio_),lineDashOffset:(e||0)*this.pixelRatio_,lineJoin:void 0!==f?f:fp,lineWidth:(void 0!==g?g:1)*this.pixelRatio_,miterLimit:void 0!==h?h:10,strokeStyle:fk(a||fq)}}else this.strokeState_=null}setImageStyle(a){let b;if(!a||!(b=a.getSize())){this.image_=null;return}let c=a.getPixelRatio(this.pixelRatio_),d=a.getAnchor(),e=a.getOrigin();this.image_=a.getImage(this.pixelRatio_),this.imageAnchorX_=d[0]*c,this.imageAnchorY_=d[1]*c,this.imageHeight_=b[1]*c,this.imageOpacity_=a.getOpacity(),this.imageOriginX_=e[0],this.imageOriginY_=e[1],this.imageRotateWithView_=a.getRotateWithView(),this.imageRotation_=a.getRotation();let f=a.getScaleArray();this.imageScale_=[f[0]*this.pixelRatio_/c,f[1]*this.pixelRatio_/c],this.imageWidth_=b[0]*c}setTextStyle(a){if(a){let b=a.getFill();if(b){let a=b.getColor();this.textFillState_={fillStyle:fk(a||fm)}}else this.textFillState_=null;let c=a.getStroke();if(c){let a=c.getColor(),b=c.getLineCap(),d=c.getLineDash(),e=c.getLineDashOffset(),f=c.getLineJoin(),g=c.getWidth(),h=c.getMiterLimit();this.textStrokeState_={lineCap:void 0!==b?b:fn,lineDash:d||fo,lineDashOffset:e||0,lineJoin:void 0!==f?f:fp,lineWidth:void 0!==g?g:1,miterLimit:void 0!==h?h:10,strokeStyle:fk(a||fq)}}else this.textStrokeState_=null;let d=a.getFont(),e=a.getOffsetX(),f=a.getOffsetY(),g=a.getRotateWithView(),h=a.getRotation(),i=a.getScaleArray(),j=a.getText(),k=a.getTextAlign(),l=a.getTextBaseline();this.textState_={font:void 0!==d?d:fl,textAlign:void 0!==k?k:fr,textBaseline:void 0!==l?l:fs},this.text_=void 0!==j?Array.isArray(j)?j.reduce((a,b,c)=>a+=c%2?" ":b,""):j:"",this.textOffsetX_=void 0!==e?this.pixelRatio_*e:0,this.textOffsetY_=void 0!==f?this.pixelRatio_*f:0,this.textRotateWithView_=void 0!==g&&g,this.textRotation_=void 0!==h?h:0,this.textScale_=[this.pixelRatio_*i[0],this.pixelRatio_*i[1]]}else this.text_=""}},hI={Point:function(a,b,c,d,e,f){let g=c.getImage(),h=c.getText(),i=h&&h.getText(),j=f&&g&&i?{}:void 0;if(g){if(2!=g.getImageState())return;let f=a.getBuilder(c.getZIndex(),"Image");f.setImageStyle(g,j),f.drawPoint(b,d,e)}if(i){let f=a.getBuilder(c.getZIndex(),"Text");f.setTextStyle(h,j),f.drawText(b,d,e)}},LineString:function(a,b,c,d,e){let f=c.getStroke();if(f){let g=a.getBuilder(c.getZIndex(),"LineString");g.setFillStrokeStyle(null,f),g.drawLineString(b,d,e)}let g=c.getText();if(g&&g.getText()){let f=a.getBuilder(c.getZIndex(),"Text");f.setTextStyle(g),f.drawText(b,d,e)}},Polygon:function(a,b,c,d,e){let f=c.getFill(),g=c.getStroke();if(f||g){let h=a.getBuilder(c.getZIndex(),"Polygon");h.setFillStrokeStyle(f,g),h.drawPolygon(b,d,e)}let h=c.getText();if(h&&h.getText()){let f=a.getBuilder(c.getZIndex(),"Text");f.setTextStyle(h),f.drawText(b,d,e)}},MultiPoint:function(a,b,c,d,e,f){let g=c.getImage(),h=g&&0!==g.getOpacity(),i=c.getText(),j=i&&i.getText(),k=f&&h&&j?{}:void 0;if(h){if(2!=g.getImageState())return;let f=a.getBuilder(c.getZIndex(),"Image");f.setImageStyle(g,k),f.drawMultiPoint(b,d,e)}if(j){let f=a.getBuilder(c.getZIndex(),"Text");f.setTextStyle(i,k),f.drawText(b,d,e)}},MultiLineString:function(a,b,c,d,e){let f=c.getStroke();if(f){let g=a.getBuilder(c.getZIndex(),"LineString");g.setFillStrokeStyle(null,f),g.drawMultiLineString(b,d,e)}let g=c.getText();if(g&&g.getText()){let f=a.getBuilder(c.getZIndex(),"Text");f.setTextStyle(g),f.drawText(b,d,e)}},MultiPolygon:function(a,b,c,d,e){let f=c.getFill(),g=c.getStroke();if(g||f){let h=a.getBuilder(c.getZIndex(),"Polygon");h.setFillStrokeStyle(f,g),h.drawMultiPolygon(b,d,e)}let h=c.getText();if(h&&h.getText()){let f=a.getBuilder(c.getZIndex(),"Text");f.setTextStyle(h),f.drawText(b,d,e)}},GeometryCollection:function(a,b,c,d,e,f){let g,h,i=b.getGeometriesArray();for(g=0,h=i.length;g<h;++g)(0,hI[i[g].getType()])(a,i[g],c,d,e,f)},Circle:function(a,b,c,d,e){let f=c.getFill(),g=c.getStroke();if(f||g){let h=a.getBuilder(c.getZIndex(),"Circle");h.setFillStrokeStyle(f,g),h.drawCircle(b,d,e)}let h=c.getText();if(h&&h.getText()){let e=a.getBuilder(c.getZIndex(),"Text");e.setTextStyle(h),e.drawText(b,d)}}};function hJ(a,b){return parseInt(T(a),10)-parseInt(T(b),10)}function hK(a,b){let c=.5*a/b;return c*c}function hL(a,b,c,d,e,f,g,h){let i=[],j=c.getImage();if(j){let a=!0,b=j.getImageState();2==b||3==b?a=!1:0==b&&j.load(),a&&i.push(j.ready())}let k=c.getFill();k&&k.loading()&&i.push(k.ready());let l=i.length>0;return l&&Promise.all(i).then(()=>e(null)),function(a,b,c,d,e,f,g){let h=c.getGeometryFunction()(b);if(!h)return;let i=h.simplifyTransformed(d,e);c.getRenderer()?function a(b,c,d,e,f){if("GeometryCollection"==c.getType()){let g=c.getGeometries();for(let c=0,h=g.length;c<h;++c)a(b,g[c],d,e,f);return}b.getBuilder(d.getZIndex(),"Default").drawCustom(c,e,d.getRenderer(),d.getHitDetectionRenderer(),f)}(a,i,c,b,g):(0,hI[i.getType()])(a,i,c,b,g,f)}(a,b,c,d,f,g,h),l}let hM=class extends gC{constructor(a){super(a),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.clipped_=!1,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=aO(),this.wrappedRenderedExtent_=aO(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.renderedFrameDeclutter_,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(a,b,c){let d=b.extent,e=b.viewState,f=e.center,g=e.resolution,h=e.projection,i=e.rotation,j=h.getExtent(),k=this.getLayer().getSource(),l=this.getLayer().getDeclutter(),m=b.pixelRatio,n=b.viewHints,o=!(n[0]||n[1]),p=this.context,q=Math.round(a4(d)/g*m),r=Math.round(a0(d)/g*m),s=k.getWrapX()&&h.canWrapX(),t=s?a4(j):null,u=s?Math.ceil((d[2]-j[2])/t)+1:1,v=s?Math.floor((d[0]-j[0])/t):0;do{let d=this.getRenderTransform(f,g,0,m,q,r,v*t);b.declutter&&(d=d.slice(0)),a.execute(p,[p.canvas.width,p.canvas.height],d,i,o,void 0===c?hC:c?hD:hE,c?l&&b.declutter[l]:void 0)}while(++v<u)}setDrawContext_(){1!==this.opacity_&&(this.targetContext_=this.context,this.context=c2(this.context.canvas.width,this.context.canvas.height,gA))}resetDrawContext_(){if(1!==this.opacity_&&this.targetContext_){let a=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=a,c4(this.context),gA.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(a){this.replayGroup_&&this.getLayer().getDeclutter()&&this.renderWorlds(this.replayGroup_,a,!0)}renderDeferredInternal(a){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.clipped_&&this.context.restore(),this.resetDrawContext_())}renderFrame(a,b){let c=a.layerStatesArray[a.layerIndex];this.opacity_=c.opacity;let d=a.viewState;this.prepareContainer(a,b);let e=this.context,f=this.replayGroup_,g=f&&!f.isEmpty();if(!g&&!(this.getLayer().hasListener(dZ)||this.getLayer().hasListener(d$)))return this.container;this.setDrawContext_(),this.preRender(e,a);d.projection;if(this.clipped_=!1,g&&c.extent&&this.clipping){var h,i;let b=(h=c.extent,i=0,h);g=a5(b,a.extent),this.clipped_=g&&!aL(b,a.extent),this.clipped_&&this.clipUnrotated(e,a,b)}return g&&this.renderWorlds(f,a,!this.getLayer().getDeclutter()&&void 0),!a.declutter&&this.clipped_&&e.restore(),this.postRender(e,a),this.renderedRotation_!==d.rotation&&(this.renderedRotation_=d.rotation,this.hitDetectionImageData_=null),a.declutter||this.resetDrawContext_(),this.container}getFeatures(a){return new Promise(b=>{if(this.frameState&&!this.hitDetectionImageData_&&!this.animatingOrInteracting_){let a=this.frameState.size.slice(),b=this.renderedCenter_,c=this.renderedResolution_,d=this.renderedRotation_,e=this.renderedProjection_,f=this.wrappedRenderedExtent_,g=this.getLayer(),h=[],i=.5*a[0],j=.5*a[1];h.push(this.getRenderTransform(b,c,d,.5,i,j,0).slice());let k=g.getSource(),l=e.getExtent();if(k.getWrapX()&&e.canWrapX()&&!aL(l,f)){let a,e=f[0],g=a4(l),k=0;for(;e<l[0];)a=g*--k,h.push(this.getRenderTransform(b,c,d,.5,i,j,a).slice()),e+=g;for(k=0,e=f[2];e>l[2];)a=g*++k,h.push(this.getRenderTransform(b,c,d,.5,i,j,a).slice()),e-=g}let m=b8();this.hitDetectionImageData_=function(a,b,c,d,e,f,g,h,i){var j;let k=(i&&(j=0),e),l=c2(.5*a[0],.5*a[1]);l.imageSmoothingEnabled=!1;let m=l.canvas,n=new hH(l,.5,e,null,g,h,i?b4(b8(),i):null),o=c.length,p=Math.floor(0xffffff/o),q={};for(let a=1;a<=o;++a){let b=c[a-1],e=b.getStyleFunction()||d;if(!e)continue;let g=e(b,f);if(!g)continue;Array.isArray(g)||(g=[g]);let h=(a*p).toString(16).padStart(7,"#00000");for(let a=0,c=g.length;a<c;++a){let c=g[a],d=c.getGeometryFunction()(b);if(!d||!a5(k,d.getExtent()))continue;let e=c.clone(),f=e.getFill();f&&f.setColor(h);let i=e.getStroke();i&&(i.setColor(h),i.setLineDash(null)),e.setText(void 0);let j=c.getImage();if(j){let a=j.getImageSize();if(!a)continue;let b=c2(a[0],a[1],void 0,{alpha:!1}),c=b.canvas;b.fillStyle=h,b.fillRect(0,0,c.width,c.height),e.setImage(new fJ({img:c,anchor:j.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:j.getOrigin(),opacity:1,size:j.getSize(),scale:j.getScale(),rotation:j.getRotation(),rotateWithView:j.getRotateWithView()}))}let l=e.getZIndex()||0,m=q[l];m||(m={},q[l]=m,m.Polygon=[],m.Circle=[],m.LineString=[],m.Point=[]);let n=d.getType();if("GeometryCollection"===n){let a=d.getGeometriesArrayRecursive();for(let b=0,c=a.length;b<c;++b){let c=a[b];m[c.getType().replace("Multi","")].push(c,e)}}else m[n.replace("Multi","")].push(d,e)}}let r=Object.keys(q).map(Number).sort(A);for(let a=0,c=r.length;a<c;++a){let c=q[r[a]];for(let a in c){let d=c[a];for(let a=0,c=d.length;a<c;a+=2){n.setStyle(d[a+1]);for(let c=0,e=b.length;c<e;++c)n.setTransform(b[c]),n.drawGeometry(d[a])}}}return l.getImageData(0,0,m.width,m.height)}(a,h,this.renderedFeatures_,g.getStyleFunction(),f,c,d,hK(c,this.renderedPixelRatio_),m?e:null)}b(function(a,b,c){let d=[];if(c){let e=Math.floor(.5*Math.round(a[0])),f=Math.floor(.5*Math.round(a[1])),g=(av(e,0,c.width-1)+av(f,0,c.height-1)*c.width)*4,h=c.data[g],i=c.data[g+1],j=c.data[g+2]+256*(i+256*h),k=Math.floor(0xffffff/b.length);j&&j%k==0&&d.push(b[j/k-1])}return d}(a,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(a,b,c,d,e){if(!this.replayGroup_)return;let f=b.viewState.resolution,g=b.viewState.rotation,h=this.getLayer(),i={},j=this.getLayer().getDeclutter();return this.replayGroup_.forEachFeatureAtCoordinate(a,f,g,c,function(a,b,c){let f=T(a),g=i[f];if(g){if(!0!==g&&c<g.distanceSq){if(0===c)return i[f]=!0,e.splice(e.lastIndexOf(g),1),d(a,h,b);g.geometry=b,g.distanceSq=c}}else{if(0===c)return i[f]=!0,d(a,h,b);e.push(i[f]={feature:a,layer:h,geometry:b,distanceSq:c,callback:d})}},j?b.declutter?.[j]?.all().map(a=>a.value):null)}handleFontsChanged(){let a=this.getLayer();a.getVisible()&&this.replayGroup_&&a.changed()}handleStyleImageChange_(a){this.renderIfReadyAndVisible()}prepareFrame(a){var b,c,d,e;let f,g=this.getLayer(),h=g.getSource();if(!h)return!1;let i=a.viewHints[0],j=a.viewHints[1],k=g.getUpdateWhileAnimating(),l=g.getUpdateWhileInteracting();if(this.ready&&!k&&i||!l&&j)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;let m=a.extent,n=a.viewState,o=n.projection,p=n.resolution,q=a.pixelRatio,r=g.getRevision(),s=g.getRenderBuffer(),t=g.getRenderOrder();void 0===t&&(t=hJ);let u=n.center.slice(),v=aH(m,s*p),w=v.slice(),x=[v.slice()],y=o.getExtent();if(h.getWrapX()&&o.canWrapX()&&!aL(y,a.extent)){let a=a4(y),b=Math.max(a4(v)/2,a);v[0]=y[0]-b,v[2]=y[2]+b,bb(u,o);let c=a7(x[0],o);c[0]<y[0]&&c[2]<y[2]?x.push([c[0]+a,c[1],c[2]+a,c[3]]):c[0]>y[0]&&c[2]>y[2]&&x.push([c[0]-a,c[1],c[2]-a,c[3]])}if(this.ready&&this.renderedResolution_==p&&this.renderedRevision_==r&&this.renderedRenderOrder_==t&&!!a.declutter===this.renderedFrameDeclutter_&&aL(this.wrappedRenderedExtent_,v))return E(this.renderedExtent_,w)||(this.hitDetectionImageData_=null,this.renderedExtent_=w),this.renderedCenter_=u,this.replayGroupChanged=!1,!0;this.replayGroup_=null;let z=new hp(.5*p/q,v,p,q),A=b8();if(A){for(let a=0,e=x.length;a<e;++a){let e=(b=x[a],c=0,b);h.loadFeatures(e,(d=0,p),A)}f=b4(A,o)}else for(let a=0,b=x.length;a<b;++a)h.loadFeatures(x[a],p,o);let B=hK(p,q),C=!0,D=(a,b)=>{let c,d=a.getStyleFunction()||g.getStyleFunction();if(d&&(c=d(a,p)),c){let d=this.renderFeature(a,B,c,z,f,this.getLayer().getDeclutter(),b);C=C&&!d}},F=(e=0,v),G=h.getFeaturesInExtent(F);t&&G.sort(t);for(let a=0,b=G.length;a<b;++a)D(G[a],a);this.renderedFeatures_=G,this.ready=C;let H=z.finish(),I=new hG(v,p,q,h.getOverlaps(),H,g.getRenderBuffer(),!!a.declutter);return this.renderedResolution_=p,this.renderedRevision_=r,this.renderedRenderOrder_=t,this.renderedFrameDeclutter_=!!a.declutter,this.renderedExtent_=w,this.wrappedRenderedExtent_=v,this.renderedCenter_=u,this.renderedProjection_=o,this.renderedPixelRatio_=q,this.replayGroup_=I,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(a,b,c,d,e,f,g){if(!c)return!1;let h=!1;if(Array.isArray(c))for(let i=0,j=c.length;i<j;++i)h=hL(d,a,c[i],b,this.boundHandleStyleImageChange_,e,f,g)||h;else h=hL(d,a,c,b,this.boundHandleStyleImageChange_,e,f,g);return h}};function hN(a,b){return function(c,d,e,f,g){var h,i;let j;h=(a,b)=>{this.addFeatures(a),void 0!==f&&f(a)},i=()=>{this.changed(),void 0!==g&&g()},(j=new XMLHttpRequest).open("GET","function"==typeof a?a(c,d,e):a,!0),"arraybuffer"==b.getType()&&(j.responseType="arraybuffer"),j.withCredentials=!1,j.onload=function(a){if(!j.status||j.status>=200&&j.status<300){let a=b.getType();try{let d;"text"==a||"json"==a?d=j.responseText:"xml"==a?d=j.responseXML||j.responseText:"arraybuffer"==a&&(d=j.response),d?h(b.readFeatures(d,{extent:c,featureProjection:e}),b.readProjection(d)):i()}catch{i()}}else i()},j.onerror=i,j.send()}}function hO(a,b){return[[-1/0,-1/0,1/0,1/0]]}function hP(a,b,c,d,e,f,g){let h,i,j=(c-b)/d;if(1===j)h=b;else if(2===j)h=b,i=e;else if(0!==j){let f=a[b],g=a[b+1],j=0,k=[0];for(let e=b+d;e<c;e+=d){let b=a[e],c=a[e+1];j+=Math.sqrt((b-f)*(b-f)+(c-g)*(c-g)),k.push(j),f=b,g=c}let l=e*j,m=function(a,b,c){let d,e;c=c||A;let f=0,g=a.length,h=!1;for(;f<g;)(e=+c(a[d=f+(g-f>>1)],b))<0?f=d+1:(g=d,h=!e);return h?f:~f}(k,l);m<0?(i=(l-k[-m-2])/(k[-m-1]-k[-m-2]),h=b+(-m-2)*d):h=b+m*d}g=g>1?g:2,f=f||Array(g);for(let b=0;b<g;++b){var k;f[b]=void 0===h?NaN:void 0===i?a[h+b]:(k=a[h+b],k+i*(a[h+d+b]-k))}return f}a.s(["default",0,class extends gb{constructor(a){super(a)}createRenderer(){return new hM(this)}}],35270);let hQ=ce();class hR{constructor(a,b,c,d,e,f){this.styleFunction,this.extent_,this.id_=f,this.type_=a,this.flatCoordinates_=b,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=c||null,this.properties_=e,this.squaredTolerance_,this.stride_=d,this.simplifiedGeometry_}get(a){return this.properties_[a]}getExtent(){var a,b;return this.extent_||(this.extent_="Point"===this.type_?aR(this.flatCoordinates_):(a=this.flatCoordinates_,b=this.flatCoordinates_.length,aU(aQ(void 0),a,0,b,2))),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){let a=aZ(this.getExtent());this.flatInteriorPoints_=cG(this.flatCoordinates_,0,this.ends_,2,a,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){let a=function(a,b){let c,d=[],e=0,f=0;for(let g=0,h=b.length;g<h;++g){let h=b[g],i=cK(a,e,h,2);if(void 0===c&&(c=i),i===c)d.push(b.slice(f,g+1));else{if(0===d.length)continue;d[d.length-1].push(b[f])}f=g+1,e=h}return d}(this.flatCoordinates_,this.ends_),b=function(a,b,c,d){let e=[],f=aO();for(let d=0,i=c.length;d<i;++d){var g,h;let i=c[d];g=b,h=i[0],f=aU(aQ(void 0),a,g,h,2),e.push((f[0]+f[2])/2,(f[1]+f[3])/2),b=i[i.length-1]}return e}(this.flatCoordinates_,0,a,0);this.flatInteriorPoints_=function(a,b,c,d,e){let f=[];for(let d=0,g=c.length;d<g;++d){let g=c[d];f=cG(a,b,g,2,e,2*d,f),b=g[g.length-1]}return f}(this.flatCoordinates_,0,a,0,b)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=hP(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];let a=this.flatCoordinates_,b=0,c=this.ends_;for(let d=0,e=c.length;d<e;++d){let e=c[d],f=hP(a,b,e,2,.5);D(this.flatMidpoints_,f),b=e}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(a){return this}simplifyTransformed(a,b){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(a){let b=(a=bZ(a)).getExtent(),c=a.getWorldExtent();if(b&&c){let a=a0(c)/a0(b);cg(hQ,c[0],c[3],a,-a,0,0,0),ck(this.flatCoordinates_,0,this.flatCoordinates_.length,2,hQ,this.flatCoordinates_)}}applyTransform(a){a(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){return new hR(this.type_,this.flatCoordinates_.slice(),this.ends_?.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=I((a,b)=>{let c;if(a===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),b&&this.simplifiedGeometry_.applyTransform(b);let d=this.simplifiedGeometry_.getFlatCoordinates();switch(this.type_){case"LineString":d.length=cz(d,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,a,d,0),c=[d.length];break;case"MultiLineString":c=[],d.length=function(a,b,c,d,e,f,g,h){for(let i=0,j=c.length;i<j;++i){let j=c[i];g=cz(a,b,j,d,e,f,g),h.push(g),b=j}return g}(d,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,a,d,0,c);break;case"Polygon":c=[],d.length=cB(d,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(a),d,0,c)}return c&&(this.simplifiedGeometry_=new hR(this.type_,d,c,2,this.properties_,this.id_)),this.squaredTolerance_=a,this.simplifiedGeometry_}),this}}hR.prototype.getFlatCoordinates=hR.prototype.getOrientedFlatCoordinates;let hS=class{constructor(a){this.rbush_=new d4(a),this.items_={}}insert(a,b){let c={minX:a[0],minY:a[1],maxX:a[2],maxY:a[3],value:b};this.rbush_.insert(c),this.items_[T(b)]=c}load(a,b){let c=Array(b.length);for(let d=0,e=b.length;d<e;d++){let e=a[d],f=b[d],g={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3],value:f};c[d]=g,this.items_[T(f)]=g}this.rbush_.load(c)}remove(a){let b=T(a),c=this.items_[b];return delete this.items_[b],null!==this.rbush_.remove(c)}update(a,b){let c=this.items_[T(b)];aS([c.minX,c.minY,c.maxX,c.maxY],a)||(this.remove(b),this.insert(a,b))}getAll(){return this.rbush_.all().map(function(a){return a.value})}getInExtent(a){let b={minX:a[0],minY:a[1],maxX:a[2],maxY:a[3]};return this.rbush_.search(b).map(function(a){return a.value})}forEach(a){return this.forEach_(this.getAll(),a)}forEachInExtent(a,b){return this.forEach_(this.getInExtent(a),b)}forEach_(a,b){let c;for(let d=0,e=a.length;d<e&&!(c=b(a[d]));d++);return c}isEmpty(){return K(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(a){let b=this.rbush_.toJSON();return aP(b.minX,b.minY,b.maxX,b.maxY,a)}concat(a){for(let b in this.rbush_.load(a.rbush_.all()),a.items_)this.items_[b]=a.items_[b]}},hT="addfeature",hU="removefeature";class hV extends L{constructor(a,b,c){super(a),this.feature=b,this.features=c}}let hW=class extends gT{constructor(a){let b,c;super({attributions:(a=a||{}).attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:void 0===a.wrapX||a.wrapX}),this.on,this.once,this.un,this.loader_=H,this.format_=a.format||null,this.overlaps_=void 0===a.overlaps||a.overlaps,this.url_=a.url,void 0!==a.loader?this.loader_=a.loader:void 0!==this.url_&&(aq(this.format_,"`format` must be set when `url` is set"),this.loader_=hN(this.url_,this.format_)),this.strategy_=void 0!==a.strategy?a.strategy:hO;const d=void 0===a.useSpatialIndex||a.useSpatialIndex;this.featuresRtree_=d?new hS:null,this.loadedExtentsRtree_=new hS,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null,Array.isArray(a.features)?c=a.features:a.features&&(c=(b=a.features).getArray()),d||void 0!==b||(b=new Y(c)),void 0!==c&&this.addFeaturesInternal(c),void 0!==b&&this.bindFeaturesCollection_(b)}addFeature(a){this.addFeatureInternal(a),this.changed()}addFeatureInternal(a){let b=T(a);if(!this.addToIndex_(b,a)){this.featuresCollection_&&this.featuresCollection_.remove(a);return}this.setupChangeEvents_(b,a);let c=a.getGeometry();if(c){let b=c.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(b,a)}else this.nullGeometryFeatures_[b]=a;this.dispatchEvent(new hV(hT,a))}setupChangeEvents_(a,b){b instanceof hR||(this.featureChangeKeys_[a]=[N(b,s,this.handleFeatureChange_,this),N(b,r,this.handleFeatureChange_,this)])}addToIndex_(a,b){let c=!0;if(void 0!==b.getId()){let a=String(b.getId());if(a in this.idIndex_)if(b instanceof hR){let d=this.idIndex_[a];d instanceof hR?Array.isArray(d)?d.push(b):this.idIndex_[a]=[d,b]:c=!1}else c=!1;else this.idIndex_[a]=b}return c&&(aq(!(a in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[a]=b),c}addFeatures(a){this.addFeaturesInternal(a),this.changed()}addFeaturesInternal(a){let b=[],c=[],d=[];for(let b=0,d=a.length;b<d;b++){let d=a[b],e=T(d);this.addToIndex_(e,d)&&c.push(d)}for(let a=0,e=c.length;a<e;a++){let e=c[a],f=T(e);this.setupChangeEvents_(f,e);let g=e.getGeometry();if(g){let a=g.getExtent();b.push(a),d.push(e)}else this.nullGeometryFeatures_[f]=e}if(this.featuresRtree_&&this.featuresRtree_.load(b,d),this.hasListener(hT))for(let a=0,b=c.length;a<b;a++)this.dispatchEvent(new hV(hT,c[a]))}bindFeaturesCollection_(a){let b=!1;this.addEventListener(hT,function(c){b||(b=!0,a.push(c.feature),b=!1)}),this.addEventListener(hU,function(c){b||(b=!0,a.remove(c.feature),b=!1)}),a.addEventListener("add",a=>{b||(b=!0,this.addFeature(a.element),b=!1)}),a.addEventListener(q,a=>{b||(b=!0,this.removeFeature(a.element),b=!1)}),this.featuresCollection_=a}clear(a){if(a){for(let a in this.featureChangeKeys_)this.featureChangeKeys_[a].forEach(O);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_)for(let a in this.featuresRtree_.forEach(a=>{this.removeFeatureInternal(a)}),this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[a]);this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};let b=new hV("clear");this.dispatchEvent(b),this.changed()}forEachFeature(a){if(this.featuresRtree_)return this.featuresRtree_.forEach(a);this.featuresCollection_&&this.featuresCollection_.forEach(a)}forEachFeatureAtCoordinateDirect(a,b){let c=[a[0],a[1],a[0],a[1]];return this.forEachFeatureInExtent(c,function(c){let d=c.getGeometry();if(d instanceof hR||d.intersectsCoordinate(a))return b(c)})}forEachFeatureInExtent(a,b){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(a,b);this.featuresCollection_&&this.featuresCollection_.forEach(b)}forEachFeatureIntersectingExtent(a,b){return this.forEachFeatureInExtent(a,function(c){let d=c.getGeometry();if(d instanceof hR||d.intersectsExtent(a)){let a=b(c);if(a)return a}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let a;return this.featuresCollection_?a=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(a=this.featuresRtree_.getAll(),K(this.nullGeometryFeatures_)||D(a,Object.values(this.nullGeometryFeatures_))),a}getFeaturesAtCoordinate(a){let b=[];return this.forEachFeatureAtCoordinateDirect(a,function(a){b.push(a)}),b}getFeaturesInExtent(a,b){return this.featuresRtree_?b&&b.canWrapX()&&this.getWrapX()?[].concat(...a8(a,b).map(a=>this.featuresRtree_.getInExtent(a))):this.featuresRtree_.getInExtent(a):this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(a,b){let c=a[0],d=a[1],e=null,f=[NaN,NaN],g=1/0,h=[-1/0,-1/0,1/0,1/0];return b=b||F,this.featuresRtree_.forEachInExtent(h,function(a){if(b(a)){let b=a.getGeometry(),i=g;if((g=b instanceof hR?0:b.closestPointXY(c,d,f,g))<i){e=a;let b=Math.sqrt(g);h[0]=c-b,h[1]=d-b,h[2]=c+b,h[3]=d+b}}}),e}getExtent(a){return this.featuresRtree_.getExtent(a)}getFeatureById(a){let b=this.idIndex_[a.toString()];return void 0!==b?b:null}getFeatureByUid(a){let b=this.uidIndex_[a];return void 0!==b?b:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(a){let b=a.target,c=T(b),d=b.getGeometry();if(d){let a=d.getExtent();c in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[c],this.featuresRtree_&&this.featuresRtree_.insert(a,b)):this.featuresRtree_&&this.featuresRtree_.update(a,b)}else c in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(b),this.nullGeometryFeatures_[c]=b);let e=b.getId();if(void 0!==e){let a=e.toString();this.idIndex_[a]!==b&&(this.removeFromIdIndex_(b),this.idIndex_[a]=b)}else this.removeFromIdIndex_(b),this.uidIndex_[c]=b;this.changed(),this.dispatchEvent(new hV("changefeature",b))}hasFeature(a){let b=a.getId();return void 0!==b?b in this.idIndex_:T(a)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&K(this.nullGeometryFeatures_):!this.featuresCollection_||0===this.featuresCollection_.getLength()}loadFeatures(a,b,c){let d=this.loadedExtentsRtree_,e=this.strategy_(a,b,c);for(let a=0,f=e.length;a<f;++a){let f=e[a];d.forEachInExtent(f,function(a){return aL(a.extent,f)})||(++this.loadingExtentsCount_,this.dispatchEvent(new hV("featuresloadstart")),this.loader_.call(this,f,b,c,a=>{--this.loadingExtentsCount_,this.dispatchEvent(new hV("featuresloadend",void 0,a))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new hV("featuresloaderror"))}),d.insert(f,{extent:f.slice()}))}this.loading=!(this.loader_.length<4)&&this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(a){let b=this.loadedExtentsRtree_,c=b.forEachInExtent(a,function(b){if(aS(b.extent,a))return b});c&&b.remove(c)}removeFeatures(a){let b=!1;for(let c=0,d=a.length;c<d;++c)b=this.removeFeatureInternal(a[c])||b;b&&this.changed()}removeFeature(a){!a||this.removeFeatureInternal(a)&&this.changed()}removeFeatureInternal(a){let b=T(a);if(!(b in this.uidIndex_))return!1;b in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[b]:this.featuresRtree_&&this.featuresRtree_.remove(a);let c=this.featureChangeKeys_[b];c?.forEach(O),delete this.featureChangeKeys_[b];let d=a.getId();if(void 0!==d){let b=d.toString(),c=this.idIndex_[b];c===a?delete this.idIndex_[b]:Array.isArray(c)&&(c.splice(c.indexOf(a),1),1===c.length&&(this.idIndex_[b]=c[0]))}return delete this.uidIndex_[b],this.hasListener(hU)&&this.dispatchEvent(new hV(hU,a)),!0}removeFromIdIndex_(a){for(let b in this.idIndex_)if(this.idIndex_[b]===a){delete this.idIndex_[b];break}}setLoader(a){this.loader_=a}setUrl(a){aq(this.format_,"`format` must be set when `url` is set"),this.url_=a,this.setLoader(hN(a,this.format_))}setOverlaps(a){this.overlaps_=a,this.changed()}};a.s(["default",0,hW],86760);class hX extends V{constructor(a){super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),a&&("function"==typeof a.getSimplifiedGeometry?this.setGeometry(a):this.setProperties(a))}clone(){let a=new hX(this.hasProperties()?this.getProperties():null);a.setGeometryName(this.getGeometryName());let b=this.getGeometry();b&&a.setGeometry(b.clone());let c=this.getStyle();return c&&a.setStyle(c),a}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(O(this.geometryChangeKey_),this.geometryChangeKey_=null);let a=this.getGeometry();a&&(this.geometryChangeKey_=N(a,s,this.handleGeometryChange_,this)),this.changed()}setGeometry(a){this.set(this.geometryName_,a)}setStyle(a){var b;let c;this.style_=a,this.styleFunction_=a?"function"==typeof(b=a)?b:(Array.isArray(b)?c=b:(aq("function"==typeof b.getZIndex,"Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),c=[b]),function(){return c}):void 0,this.changed()}setId(a){this.id_=a,this.changed()}setGeometryName(a){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=a,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}a.s(["default",0,hX],2953);class hY extends cq{constructor(a,b){super(),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,void 0===b||Array.isArray(a[0])?this.setCoordinates(a,b):this.setFlatCoordinates(b,a)}appendCoordinate(a){D(this.flatCoordinates,a),this.changed()}clone(){let a=new hY(this.flatCoordinates.slice(),this.layout);return a.applyProperties(this),a}closestPointXY(a,b,c,d){return d<aJ(this.getExtent(),a,b)?d:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(ct(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),cu(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,a,b,c,d))}forEachSegment(a){return cH(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,a)}getCoordinateAtM(a,b){return"XYM"!=this.layout&&"XYZM"!=this.layout?null:(b=void 0!==b&&b,function(a,b,c,d,e,f){let g;if(0==c)return null;if(e<a[0+d-1])return f?((g=a.slice(0,0+d))[d-1]=e,g):null;if(a[c-1]<e)return f?((g=a.slice(c-d,c))[d-1]=e,g):null;if(e==a[0+d-1])return a.slice(0,0+d);let h=0/d,i=c/d;for(;h<i;){let b=h+i>>1;e<a[(b+1)*d-1]?i=b:h=b+1}let j=a[h*d-1];if(e==j)return a.slice((h-1)*d,(h-1)*d+d);let k=(e-j)/(a[(h+1)*d-1]-j);g=[];for(let b=0;b<d-1;++b){var l;g.push((l=a[(h-1)*d+b],l+k*(a[h*d+b]-l)))}return g.push(e),g}(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,a,b))}getCoordinates(){return cw(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinateAt(a,b){return hP(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,a,b,this.stride)}getLength(){return hq(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getFlatMidpoint(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_??void 0),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}getSimplifiedGeometryInternal(a){let b=[];return b.length=cz(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,a,b,0),new hY(b,"XY")}getType(){return"LineString"}intersectsExtent(a){return cI(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,a,this.getExtent())}setCoordinates(a,b){this.setLayout(b,a,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=cv(this.flatCoordinates,0,a,this.stride),this.changed()}}a.s(["default",0,hY],71313),a.s(["Style",0,fL],10867),a.s(["Stroke",0,fK],83394),a.s(["Circle",0,fG],38176),a.s(["Fill",0,fH],84802)}];

//# sourceMappingURL=Downloads_RecycleYuk-revision_RecycleYuk_RecycleYuk_6575f662._.js.map